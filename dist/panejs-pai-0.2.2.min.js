!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.panejs=t():e.panejs=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/dist/",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionHandler=t.SelectionHandler=t.Handler=t.VectorView=t.PortalView=t.NodeView=t.LinkView=t.CellView=t.Terminal=t.Portal=t.Node=t.Link=t.Cell=t.Paper=t.Model=t.Events=t.VElement=t.vector=t.detector=t.utils=void 0;var o=n(1);Object.keys(o).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(46);Object.keys(a).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(59);Object.keys(s).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var l=n(68);Object.keys(l).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var u=n(3),c=r(u),h=n(24),f=i(h),d=n(13),p=i(d),v=n(41),y=i(v),g=n(70),m=i(g),b=n(75),k=i(b),w=n(21),P=i(w),x=n(44),O=i(x),C=n(17),M=i(C),_=n(16),S=i(_),E=n(22),j=i(E),T=n(29),B=i(T),N=n(76),L=i(N),V=n(26),R=i(V),A=n(23),z=i(A),F=n(27),I=i(F),D=n(40),G=i(D),U=n(77),W=i(U),H=n(80),X=i(H),q=n(81),Y=i(q),K=n(82),$=i(K),Z=n(83),J=i(Z),Q=n(84),ee=i(Q),te=n(85),ne=i(te),ie=n(86),re=i(ie),oe=n(87),ae=i(oe),se=n(88),le=i(se);k["default"].registConnector("sharp",Y["default"]).registConnector("smooth",$["default"]).registConnector("rounded",J["default"]),k["default"].registMarker("classic",ee["default"]).registMarker("diamond",ne["default"]).registMarker("cloven",ae["default"]).registMarker("block",re["default"]).registMarker("oval",le["default"]),t.utils=c,t.detector=p["default"],t.vector=f["default"],t.VElement=h.VElement,t.Events=y["default"],t.Model=m["default"],t.Paper=k["default"],t.Cell=P["default"],t.Link=O["default"],t.Node=M["default"],t.Portal=S["default"],t.Terminal=j["default"],t.CellView=B["default"],t.LinkView=L["default"],t.NodeView=R["default"],t.PortalView=z["default"],t.VectorView=I["default"],t.Handler=G["default"],t.SelectionHandler=W["default"],t.ConnectionHandler=X["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.pai=void 0;var r=n(2),o=i(r),a=n(30),s=i(a),l=n(31),u=i(l),c=n(32),h=i(c),f=n(33),d=i(f),p=n(34),v=i(p),y=n(35),g=i(y),m=n(36),b=i(m),k=n(37),w=i(k),P=n(38),x=i(P),O=n(39),C=i(O),M=n(42),_=i(M),S=n(43),E=i(S),j=n(45),T=i(j),B={Node:o["default"],NodeView:s["default"],LinkView:u["default"],Group:h["default"],GroupView:d["default"],Remark:v["default"],RemarkView:g["default"],Navigator:b["default"],Snaplines:w["default"],PaperScroll:x["default"],Handler:C["default"],SelectionHandler:_["default"],ConnectionHandler:E["default"],quadratic:T["default"]};t.pai=B},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(16),f=i(h),d=n(30),p=i(d),v=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"isPortVisible",value:function(e){return"hide"!==e.displayType}},{key:"getVisiblePorts",value:function(e){var t=e?this.getInPorts():this.getOutPorts();return c.filter(t,function(e){return this.isPortVisible(e)},this)}}]),t}(f["default"]);v.setDefaults({tagName:"g",pane:"drawPane",view:p["default"],size:{width:180,height:30}}),t["default"]=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4);Object.keys(i).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var r=n(5);Object.keys(r).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(6);Object.keys(o).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var a=n(8);Object.keys(a).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(7);Object.keys(s).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var l=n(9);Object.keys(l).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var u=n(10);Object.keys(u).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var c=n(11);Object.keys(c).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var h=n(12);Object.keys(h).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return h[e]}})});var f=n(14);Object.keys(f).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})});var d=n(15);Object.keys(d).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})}),t["default"]={}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=Object.prototype.toString,r=t.isNull=function(e){return null===e},o=(t.isString=function(e){return"string"==typeof e},t.isBoolean=function(e){return"boolean"==typeof e},t.isUndefined=function(e){return"undefined"==typeof e}),a=(t.isNil=function(e){return o(e)||r(e)},t.isObject=function(e){return e?"function"==typeof e||"object"===("undefined"==typeof e?"undefined":n(e)):!1},t.isType=function(e,t){return i.call(e)==="[object "+t+"]"}),s=t.isArray=function(e){return Array.isArray(e)},l=t.isWindow=function(e){return e&&e===e.window},u=(t.isNumeric=function(e){return!s(e)&&e-parseFloat(e)+1>=0},t.isFunction=function(e){return a(e,"Function")});t.isArrayLike=function(e){if(s(e))return!0;if(u(e)||l(e))return!1;var t=!!e&&"length"in e&&e.length;return 0===t||"number"==typeof t&&t>0&&t-1 in e}},function(e,t,n){"use strict";function i(e){return(0,v.isArrayLike)(e)?y.slice.call(e):[e]}function r(e,t,n){return e?y.slice.call(e,t,n):[]}function o(e,t){return e?y.indexOf.call(e,t):-1}function a(e,t){return e?o(e,t)>=0:!1}function s(e,t){return e?y.lastIndexOf.call(e,t):-1}function l(e,t,n){return e?y.map.call(e,t,n):[]}function u(e,t,n){return e?y.some.call(e,t,n):!1}function c(e,t,n){return e?y.every.call(e,t,n):!1}function h(e,t,n){return e?y.filter.call(e,t,n):[]}function f(e,t,n){e&&y.forEach.call(e,t,n)}function d(e,t,n){return e?y.reduce.call(e,t,n):n}function p(e,t,n){return e?y.reduceRight.call(e,t,n):n}Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=i,t.slice=r,t.indexOf=o,t.contains=a,t.lastIndexOf=s,t.map=l,t.some=u,t.every=c,t.filter=h,t.forEach=f,t.reduce=d,t.reduceRight=p;var v=n(4),y=Array.prototype},function(e,t,n){"use strict";function i(e){return e?v.trim.call(y(e)):""}function r(e){var t=arguments.length<=1||void 0===arguments[1]?/\s+/:arguments[1];return y(e).split(t)}function o(e,t){return 0===y(e).indexOf(t)}function a(e,t){return-1!==y(e).indexOf(t,y(e).length-t.length)}function s(e,t,n,i){if((0,d.isNil)(e)||(0,d.isNil)(t))return e;var r=String(e),o="number"==typeof t?t:parseInt(t,10);if(isNaN(o)||!isFinite(o))return r;var a=r.length;if(a>=o)return r;var s=(0,d.isNil)(n)?"":String(n);""===s&&(s=" ");for(var l=o-a;s.length<l;)s+=s;var u=s.length>l?s.substr(0,l):s;return i?u+r:r+u}function l(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function u(e){var t=0,n=e.length;if(0===n)return t;for(var i=0;n>i;i+=1){var r=e.charCodeAt(i);t=(t<<5)-t+r,t&=t}return t}function c(e,t){return e&&t?y(e).replace(/\$\{(.*?)\}/g,function(e,n){var i=(0,p.getByPath)(t,n);return(0,d.isNil)(i)?e:i}):e}function h(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/[&<>"'`]/g,i=/[&<>"'`]/;return i.test(e)?e.replace(n,function(e){return t[e]}):e}function f(e){return y(e).replace(/ /g,"\xa0")}Object.defineProperty(t,"__esModule",{value:!0}),t.padEnd=t.padStart=t.lcFirst=t.ucFirst=t.toLower=t.toUpper=t.toString=void 0,t.trim=i,t.split=r,t.startWith=o,t.endWith=a,t.uuid=l,t.hashCode=u,t.format=c,t.escape=h,t.sanitizeText=f;var d=n(4),p=n(7),v=String.prototype,y=t.toString=function(e){return String(e)};t.toUpper=function(e){return y(e).toUpperCase()},t.toLower=function(e){return y(e).toLowerCase()},t.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)},t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.padStart=function(e,t,n){return s(e,t,n,!0)},t.padEnd=function(e,t,n){return s(e,t,n,!1)}},function(e,t,n){"use strict";function i(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function r(e){return e?Object.keys(e):[]}function o(e,t,n){(0,d.forEach)(r(e),function(i){t.call(n,e[i],i)})}function a(){for(var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return(0,d.forEach)(n,function(t){if(t)for(var n in t)e[n]=t[n]}),e}function s(){for(var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return(0,d.forEach)(n,function(t){if(t)for(var n in t){var i=e[n],r=t[n],o=(0,p.isArray)(r);if(o||h(r)){var a=void 0;a=o?i&&(0,p.isArray)(i)?i:[]:i&&h(i)?i:{},e[n]=s(a,r)}else e[n]=r}}),e}function l(e,t){for(var n=arguments.length<=2||void 0===arguments[2]?".":arguments[2],i=(0,f.split)(t,n);i.length;){var r=i.shift();if(!(Object(e)===e&&r in e))return;e=e[r]}return e}function u(e){if(e){for(var t in e)i(e,t)&&delete e[t];e&&(e.prototype=e.__proto__=null),e.destroyed=!0}}function c(e){for(var t in e)return!1;return!0}function h(e){return!(0,p.isObject)(e)||e.nodeType||(0,p.isWindow)(e)?!1:!e.constructor||i(e.constructor.prototype,"isPrototypeOf")}Object.defineProperty(t,"__esModule",{value:!0}),t.hasOwn=i,t.keys=r,t.forIn=o,t.extend=a,t.merge=s,t.getByPath=l,t.destroy=u,t.isEmptyObject=c,t.isPlainObject=h;var f=n(6),d=n(5),p=n(4)},function(e,t,n){"use strict";function i(e){return window.isFinite(e)&&!window.isNaN(parseFloat(e))}function r(e){return(0,d.isString)(e)&&"%"===e.slice(-1)}function o(e){return parseInt(e,10)}function a(e,t){var n=parseFloat(e);return t?n/100:n}function s(e){var t=arguments.length<=1||void 0===arguments[1]?2:arguments[1];return l(100*e,t)+"%"}function l(e){var t=arguments.length<=1||void 0===arguments[1]?2:arguments[1],n=Math.pow(10,t);return a((Math.round(e*n)/n).toFixed(t))}function u(e,t,n){var i=a(e,t);return isNaN(i)?n:i}function c(e,t){if((0,d.isNil)(e))return t;for(;0>e;)e+=t;return Math.min(e,t)}function h(e,t,n){return n>t?t>e?t:e>n?n:e:n>e?n:e>t?t:e}function f(e,t,n){return n>t?e>=t&&n>=e:e>=n&&t>=e}Object.defineProperty(t,"__esModule",{value:!0}),t.isFinite=i,t.isPercentage=r,t.toInt=o,t.toFloat=a,t.toPercentage=s,t.toFixed=l,t.fixNumber=u,t.fixIndex=c,t.clamp=h,t.isWithin=f;var d=n(4)},function(e,t,n){"use strict";function i(e,t,n){var i=void 0;if((0,l.isFunction)(e)){var r=t.length,o=s(t,3),a=o[0],u=o[1],c=o[2];i=0===r?e.call(n):1===r?e.call(n,a):2===r?e.call(n,a,u):3===r?e.call(n,a,u,c):e.apply(n,t)}return i}function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return(0,l.isFunction)(e)?i(Function.prototype.bind,n,e):e}function o(e){u.push(e)}function a(){for(var e=u.pop();e;)e(),e=u.pop()}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(l){r=!0,o=l}finally{try{!i&&s["return"]&&s["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.invoke=i,t.bind=r,t.defer=o,t.flush=a;var l=n(4),u=[]},function(e,t,n){"use strict";function i(e){return e.getAttribute?e.getAttribute("class"):""}function r(e,t){if((0,A.isNil)(e)||(0,A.isNil)(t))return!1;var n=W(i(e)),r=W(t);return 1===e.nodeType?n.replace(D," ").indexOf(r)>-1:!1}function o(e,t){if(!(0,A.isNil)(e)&&!(0,A.isNil)(t)){if((0,A.isFunction)(t))return void o(e,t.call(e,i(e)));if((0,A.isString)(t)&&1===e.nodeType){var n=t.match(G)||[],r=W(i(e)).replace(D," "),a=(0,z.reduce)(n,function(e,t){return e.indexOf(W(t))<0&&(e+=t+" "),e},r);a=(0,F.trim)(a),r!==a&&e.setAttribute("class",a)}}}function a(e,t){if(!(0,A.isNil)(e)){if((0,A.isFunction)(t))return void a(e,t.call(e,i(e)));if((!t||(0,A.isString)(t))&&1===e.nodeType){var n=(t||"").match(G)||[],r=W(i(e)).replace(D," "),o=(0,z.reduce)(n,function(e,t){var n=W(t);return e.indexOf(n)>-1&&(e=e.replace(n," ")),e},r);o=t?(0,F.trim)(o):"",r!==o&&e.setAttribute("class",o)}}}function s(e,t,n){return(0,A.isNil)(e)||(0,A.isNil)(t)?void 0:(0,A.isBoolean)(n)&&(0,A.isString)(t)?void(n?o(e,t):a(e,t)):(0,A.isFunction)(t)?void s(e,t.call(e,i(e),n),n):void((0,A.isString)(t)&&(0,z.forEach)(t.match(G)||[],function(t){r(e,t)?a(e,t):o(e,t)}))}function l(e){return(0,z.reduce)((0,F.split)(e,";"),function(e,t){if(t){var n=(0,F.split)(t,"="),i=R(n,2),r=i[0],o=i[1];e[r]=(0,F.trim)(o)}return e},{})}function u(e,t,n){if(e){var i={};(0,A.isObject)(t)?i=t:(0,A.isString)(t)&&(0,A.isUndefined)(n)?i=l(t):i[t]=n,(0,I.forIn)(i,function(t,n){e.style["transform"===n?U:n]=t})}}function c(e,t){var n=e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}function h(e){return Object(e)!==e?(e=(0,A.isNil)(e)?0:e,{top:e,right:e,bottom:e,left:e}):{top:(0,A.isNil)(e.top)?0:e.top,right:(0,A.isNil)(e.right)?0:e.right,bottom:(0,A.isNil)(e.bottom)?0:e.bottom,left:(0,A.isNil)(e.left)?0:e.left}}function f(e,t){return(t||document).createElement(e)}function d(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function p(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function v(e){return e.nodeName?e.nodeName.toLowerCase():""}function y(e,t,n,i){var r=e&&!isNaN(e.nodeType);return r&&(r=(0,A.isNil)(t)||v(e)===t.toLowerCase()),r&&(r=(0,A.isNil)(n)||e.getAttribute(n)===i),r}function g(e){return(0,A.isWindow)(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}function m(e,t){if(e&&e.style){var n=e.style.display;t&&"none"===n?((0,A.isUndefined)(e.__display)?n="":(n=e.__display,delete e.__display),e.style.display=n||""):t||"none"===n||(n&&(e.__display=n),e.style.display="none")}}function b(e){return e&&("none"===e.style.display||!X(e.ownerDocument,e))}function k(e){var t={top:0,left:0},n=e&&e.ownerDocument;if(!n)return t;var i=n.documentElement;if(!X(i,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var r=g(n),o=t,a=o.top,s=o.left;return a+=(r.pageYOffset||i.scrollTop)-(i.clientTop||0),s+=(r.pageXOffset||i.scrollLeft)-(i.clientLeft||0),{top:a,left:s}}function w(e,t){for(var n=e,i=0,r=0;n&&n!==t&&n!==document.documentElement;)i+=n.offsetLeft,r+=n.offsetTop,n=n.offsetParent;return{left:i,top:r}}function P(e,t){var n=void 0;try{var i=new DOMParser;(0,A.isUndefined)(t)||(i.async=t),n=i.parseFromString(e,"text/xml")}catch(r){n=null}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+e);return n}function x(e){var t='<svg xmlns="'+q.xmlns+'" xmlns:xlink="'+q.xlink+'" version="'+Y+'">'+(e||"")+"</svg>",n=P(t,!1);return n.documentElement}function O(e,t){return(t||document).createElementNS(q.xmlns,e)}function C(e){if(-1!==e.indexOf(":")){var t=e.split(":");return{ns:q[t[0]],local:t[1]}}return{ns:null,local:e}}function M(e,t,n){if((0,A.isNil)(n))_(e,t);else if("id"===t)e.id=n;else{var i=C(t);i.ns?e.setAttributeNS(i.ns,t,n):e.setAttribute(t,n)}}function _(e,t){var n=C(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function S(e,t,n){e&&(e.style[U]="scale("+t+", "+n+")")}function E(e,t,n,i){e&&(e.style[U]="rotate("+t+", "+n+", "+i+")")}function j(e,t,n){if(e){var i="translateX("+t+"px) translateY("+n+"px)";e.style[U]=i}}function T(e,t){if(e.getTransformToElement)return e.getTransformToElement(t);var n=void 0;try{n=t.getScreenCTM().inverse()}catch(i){throw new Error("Can not inverse source element's ctm.")}return n.multiply(e.getScreenCTM())}function B(e){var t=e.getBoundingClientRect(),n={};for(var i in t)n[i]=t[i];if(e.ownerDocument!==document){var r=e.ownerDocument.defaultView.frameElement;if(r){var o=B(r);n.top+=o.top,n.bottom+=o.top,n.left+=o.left,n.right+=o.left}}return n}function N(e){var t=void 0;e===document?(t=document,e=document.documentElement):t=e.ownerDocument;var n=t.documentElement,i=B(e);return(0,A.isUndefined)(i.width)&&(i.width=document.body.scrollWidth-i.left-i.right),(0,A.isUndefined)(i.height)&&(i.height=document.body.scrollHeight-i.top-i.bottom),i.top=i.top-n.clientTop,i.left=i.left-n.clientLeft,i.right=t.body.clientWidth-i.width-i.left,i.bottom=t.body.clientHeight-i.height-i.top,i}function L(e){var t=c(e)||{},n=t.position;if("fixed"===n)return e;for(var i=e;i=i.parentNode;){var r=void 0;try{r=c(i)}catch(o){}if("undefined"==typeof r||null===r)return i;var a=r.overflow,s=r.overflowX,l=r.overflowY;if(/(auto|scroll)/.test(a+l+s)&&("absolute"!==n||["relative","absolute","fixed"].indexOf(r.position)>=0))return i}return document.body}function V(){var e=f("p"),t=f("div");u(e,{width:"100%",height:"200px"}),u(t,{overflow:"hidden",visibility:"hidden",position:"absolute",left:0,top:0,width:"200px",height:"100px"}),t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;return n===i&&(i=t.clientWidth),document.body.removeChild(t),n-i}Object.defineProperty(t,"__esModule",{value:!0}),t.containsElement=void 0;var R=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(l){r=!0,o=l}finally{try{!i&&s["return"]&&s["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getClassName=i,t.hasClass=r,t.addClass=o,t.removeClass=a,t.toggleClass=s,t.styleStrToObject=l,t.setStyle=u,t.getComputedStyle=c,t.normalizeSides=h,t.createElement=f,t.removeElement=d,t.emptyElement=p,t.getNodeName=v,t.isNode=y,t.getWindow=g,t.showHide=m,t.isHidden=b,t.getOffset=k,t.getOffsetUntil=w,t.createSvgDocument=x,t.createSvgElement=O,t.setAttribute=M,t.removeAttribute=_,t.setScale=S,t.setRotation=E,t.setTranslate=j,t.getTransformToElement=T,t.getBounds=N,t.getScrollParent=L,t.getScrollBarWidth=V;var A=n(4),z=n(5),F=n(6),I=n(7),D=/[\t\r\n\f]/g,G=/\S+/g,U=function(){if((0,A.isUndefined)(document))return"";for(var e=f("div"),t=["transform","webkitTransform","OTransform","MozTransform","msTransform"],n=0,i=t.length;i>n;n+=1){var r=t[n];if(void 0!==e.style[r])return r}return t[0]}(),W=function(e){return" "+e+" "},H=document.documentElement,X=t.containsElement=H.compareDocumentPosition||H.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},Y="1.1"},function(e,t){"use strict";function n(e){return 180*e/Math.PI%360}function i(e,t){return e=t?e:e%360,e*Math.PI/180}function r(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?"round":arguments[2];return Math[n](e/t)*t}function o(e){return e%360+(0>e?360:0)}Object.defineProperty(t,"__esModule",{value:!0}),t.toDeg=n,t.toRad=i,t.snapToGrid=r,t.normalizeAngle=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){var n=this;return function(i){o(i.delegateTarget||e,i)||t.call(n,i)}}function o(e,t){var n="mouseover"===t.type?t.relatedTarget||t.fromElement:t.relatedTarget||t.toElement;return(0,m.containsElement)(e,n)||e===n}function a(e){return e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e}function s(e){var t=!0,n=this;e=e||a((P.parentWindow||w).event);var i=n.events[e.type];for(var r in i)(0,y.hasOwn)(i,r)&&(n.$$handleEvent=i[r],n.$$handleEvent(e)===!1&&(t=!1));return t}function l(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(l.guid+=1,n.$$guid=l.guid),e.events||(e.events={});var i="on"+t,r=e.events[t];r||(r=e.events[t]={},e[i]&&(r[0]=e[i])),r[n.$$guid]=n,e[i]=s}}function u(e,t,n){for(;t&&t!==e;){if(C(t,n))return t;t=t.parentElement}return null}function c(e,t,n){var i=O[t],r=n._delegateWrapper;t=i?i.type:t,e.removeEventListener?(e.removeEventListener(t,n,!1),r&&e.removeEventListener(t,r,!1)):e.events&&e.events[t]&&(delete e.events[t][n.$$guid],r&&delete e.events[t][r.$$guid])}function h(e,t,n,i,r){function o(s){var l=u(e,s.target,n);l&&(s.delegateTarget=l,a&&(i=a.wrap(e,i)),r===!0&&c(e,t,o),i.call(e,s))}var a=O[t];return t=a?a.type:t,(0,g.isFunction)(n)?a?l(e,t,a.wrap(e,n)):l(e,t,n):(i._delegateWrapper=o,l(e,t,o),i)}function f(e){var t=x&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0];if(t){for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}return e}function d(e){return M(e)||_(e)||S(e)}function p(e){return k["default"].IS_IE?1===e.button:0===e.button}Object.defineProperty(t,"__esModule",{value:!0}),t.hasShiftKey=t.hasMetaKey=t.hasCtrlKey=t.hasAltKey=void 0,t.removeEventListener=c,t.addEventListener=h,t.normalizeEvent=f,t.hasModifierKey=d,t.isLeftMouseButton=p;var v=n(5),y=n(7),g=n(4),m=n(10),b=n(13),k=i(b),w=window,P=window.document,x=k["default"].IS_TOUCH,O={mouseenter:{type:"mouseover",wrap:r},mouseleave:{type:"mouseout",wrap:r}},C=function(){var e=P.createElement("div"),t=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector,n=t&&t.call(e,"div");return function(e,i){if(n)return t.call(e,i);var r=e.parentNode;r||n||(r=P.createDocumentFragment(),r.appendChild(e));var o=r.querySelectorAll(i);return(0,v.some)(o,function(t){return t===e})}}();l.guid=0;var M=(t.hasAltKey=function(e){return e.altKey},t.hasCtrlKey=function(e){return e.ctrlKey}),_=t.hasMetaKey=function(e){return e.metaKey},S=t.hasShiftKey=function(e){return e.shiftKey}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=navigator.userAgent,i=navigator.appVersion;t["default"]={IS_IE:n.indexOf("MSIE")>=0,IS_IE11:!!n.match(/Trident\/7\./),IS_NS:n.indexOf("Mozilla/")>=0&&n.indexOf("MSIE")<0,IS_FF:n.indexOf("Firefox/")>=0,IS_GC:n.indexOf("Chrome/")>=0,IS_SF:n.indexOf("AppleWebKit/")>=0&&n.indexOf("Chrome/")<0,IS_OP:n.indexOf("Opera/")>=0,IS_OT:n.indexOf("Presto/2.4.")<0&&n.indexOf("Presto/2.3.")<0&&n.indexOf("Presto/2.2.")<0&&n.indexOf("Presto/2.1.")<0&&n.indexOf("Presto/2.0.")<0&&n.indexOf("Presto/1.")<0,IS_MT:n.indexOf("Firefox/")>=0&&n.indexOf("Firefox/1.")<0&&n.indexOf("Firefox/2.")<0||n.indexOf("Iceweasel/")>=0&&n.indexOf("Iceweasel/1.")<0&&n.indexOf("Iceweasel/2.")<0||n.indexOf("SeaMonkey/")>=0&&n.indexOf("SeaMonkey/1.")<0||n.indexOf("Iceape/")>=0&&n.indexOf("Iceape/1.")<0,IS_IOS:!!n.match(/(iPad|iPhone|iPod)/g),IS_WIN:i.indexOf("Win")>0,IS_MAC:i.indexOf("Mac")>0,IS_POINTER:window.navigator.msPointerEnabled||!1,IS_TOUCH:"ontouchstart"in document.documentElement||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,SUPPORT_FOREIGN_OBJECT:function(){if(document.createElementNS){var e=Object.prototype.toString,t=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return/SVGForeignObject/.test(e.call(t))}return!1}()}},function(e,t,n){"use strict";function i(e){return["M",e.getAttribute("x1"),e.getAttribute("y1"),"L",e.getAttribute("x2"),e.getAttribute("y2")].join(" ")}function r(e){var t=[];return(0,u.forEach)(e.points,function(e,n){t.push(0===n?"M":"L",e.x,e.y)}),t.push("Z"),t.join(" ")}function o(e){var t=[];return(0,u.forEach)(e.points,function(e,n){t.push(0===n?"M":"L",e.x,e.y)}),t.join(" ")}function a(e){var t=parseFloat(e.getAttribute("x"))||0,n=parseFloat(e.getAttribute("y"))||0,i=parseFloat(e.getAttribute("width"))||0,r=parseFloat(e.getAttribute("height"))||0,o=parseFloat(e.getAttribute("rx"))||0,a=parseFloat(e.getAttribute("ry"))||0,s=t+i,l=n+r,u=void 0;return u=o||a?["M",t+o,n,"L",s-o,n,"Q",s,n,s,n+a,"L",s,n+r-a,"Q",s,l,s-o,l,"L",t+o,l,"Q",t,l,t,l-o,"L",t,n+a,"Q",t,n,t+o,n,"Z"]:["M",t,n,"H",s,"V",l,"H",t,"V",n,"Z"],u.join(" ")}function s(e){var t=parseFloat(e.getAttribute("cx"))||0,n=parseFloat(e.getAttribute("cy"))||0,i=parseFloat(e.getAttribute("r")),r=i*c;return["M",t,n-i,"C",t+r,n-i,t+i,n-r,t+i,n,"C",t+i,n+r,t+r,n+i,t,n+i,"C",t-r,n+i,t-i,n+r,t-i,n,"C",t-i,n-r,t-r,n-i,t,n-i,"Z"].join(" ")}function l(e){var t=parseFloat(e.getAttribute("cx"))||0,n=parseFloat(e.getAttribute("cy"))||0,i=parseFloat(e.getAttribute("rx")),r=parseFloat(e.getAttribute("ry"))||i,o=i*c,a=r*c;return["M",t,n-r,"C",t+o,n-r,t+i,n-a,t+i,n,"C",t+i,n+a,t+o,n+r,t,n+r,"C",t-o,n+r,t-i,n+a,t-i,n,"C",t-i,n-a,t-o,n-r,t,n-r,"Z"].join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.lineToPathData=i,t.polygonToPathData=r,t.polylineToPathData=o,t.rectToPathData=a,t.circleToPathData=s,t.ellipseToPathData=l;var u=n(5),c=.5522847498307935},function(e,t,n){"use strict";function i(e){var t={tx:0,ty:0};if(e){var n=e.match(/translate\((.*)\)/);if(n){var i=(0,h.split)(n[1],/[ ,]+/);i[0]&&(t.tx+=(0,c.toFloat)(i[0])),i[1]&&(t.ty+=(0,c.toFloat)(i[1]))}}return t}function r(e){var t={sx:1,sy:1};if(e){var n=e.match(/scale\((.*)\)/);if(n){var i=(0,h.split)(n[1],/[ ,]+/);i[0]&&(t.sx*=(0,c.toFloat)(i[0])),(i[1]||i[0])&&(t.sy*=(0,c.toFloat)(i[1]||i[0]))}}return t}function o(e){var t={angle:0};if(e){var n=e.match(/rotate\((.*)\)/);if(n){var i=(0,h.split)(n[1],/[ ,]+/);i[0]&&(t.angle+=(0,c.toFloat)(i[0])),i[1]&&i[2]&&(t.cx=(0,c.toFloat)(i[1]),t.cy=(0,c.toFloat)(i[2]))}}return t}function a(e){return{translate:i(e),rotate:o(e),scale:r(e)}}function s(e){return e?(0,h.trim)(e.replace(/translate\([^)]*\)/g,"")):""}function l(e){return e?(0,h.trim)(e.replace(/scale\([^)]*\)/g,"")):""}function u(e){return e?(0,h.trim)(e.replace(/rotate\([^)]*\)/g,"")):""}Object.defineProperty(t,"__esModule",{value:!0}),t.parseTranslate=i,t.parseScale=r,t.parseRotate=o,t.parseTransform=a,t.clearTranslate=s,t.clearScale=l,t.clearRotate=u;var c=n(8),h=n(6)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(6),u=n(4),c=n(5),h=n(17),f=i(h),d=n(23),p=i(d),v=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.inPorts=(0,c.map)(n.metadata.inPorts,function(e){return n.standardizePort(e)}),n.outPorts=(0,c.map)(n.metadata.outPorts,function(e){return n.standardizePort(e)}),n.portById={},(0,c.forEach)(n.inPorts,function(e){n.portById[e.id]=e}),(0,c.forEach)(n.outPorts,function(e){n.portById[e.id]=e}),n}return a(t,e),s(t,[{key:"eachInPort",value:function(e,t){(0,c.forEach)(this.inPorts,e,t)}},{key:"eachOutPort",value:function(e,t){(0,c.forEach)(this.outPorts,e,t)}},{key:"getInPorts",value:function(){return this.inPorts}},{key:"getOutPorts",value:function(){return this.outPorts}},{key:"getPortById",value:function(e){return this.portById[e]||null}},{key:"isInPort",value:function(e){return(0,c.some)(this.inPorts,function(t){return t.id===e.id})}},{key:"isOutPort",value:function(e){return(0,c.some)(this.outPorts,function(t){return t.id===e.id})}},{key:"standardizePort",value:function(e){return(0,u.isObject)(e)||(e={id:e}),e.id||(e.id=(0,l.uuid)()),e}},{key:"getPortMarkup",value:function(){return this.metadata.portMarkup}}]),t}(f["default"]);v.setDefaults({portMarkup:"",inPorts:[],outPorts:[],view:p["default"]}),t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(18),u=i(l),c=n(21),h=i(c),f=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"isNode",value:function(){return!0}},{key:"getBBox",value:function(){var e=this.getPosition(),t=this.getSize();return new u["default"](e.x,e.y,t.width,t.height)}}],[{key:"isNode",value:function(e){return e&&e instanceof t}}]),t}(h["default"]);f.setDefaults({tagName:"g",markup:"",classNames:"pane-cell pane-node",pane:null,view:null,data:null,
attrs:null,size:{width:1,height:1,relative:!1},position:{x:0,y:0,relative:!1},rotation:{angle:0,inherited:!0}}),t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),l=r(s),u=n(19),c=i(u),h=n(20),f=i(h),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3];o(this,e),this.x=t,this.y=n,this.width=i,this.height=r}return a(e,[{key:"getOrigin",value:function(){return new c["default"](this.x,this.y)}},{key:"getCenter",value:function(){return new c["default"](this.x+this.width/2,this.y+this.height/2)}},{key:"getCorner",value:function(){return new c["default"](this.x+this.width,this.y+this.height)}},{key:"getTopRight",value:function(){return new c["default"](this.x+this.width,this.y)}},{key:"getBottomLeft",value:function(){return new c["default"](this.x,this.y+this.height)}},{key:"getNearestSideToPoint",value:function(e){var t=e.x-this.x,n=e.y-this.y,i=this.x+this.width-e.x,r=this.y+this.height-e.y,o=t,a="left";return o>i&&(o=i,a="right"),o>n&&(o=n,a="top"),o>r&&(a="bottom"),a}},{key:"getNearestPointToPoint",value:function(e){if(this.containsPoint(e)){var t=this.getNearestSideToPoint(e);if("right"===t)return new c["default"](this.x+this.width,e.y);if("left"===t)return new c["default"](this.x,e.y);if("bottom"===t)return new c["default"](e.x,this.y+this.height);if("top"===t)return new c["default"](e.x,this.y)}return e.adhereToRect(this)}},{key:"containsPoint",value:function(e){return e&&e.x>=this.x&&e.x<=this.x+this.width&&e.y>=this.y&&e.y<=this.y+this.height}},{key:"containsRect",value:function(e){this.normalize(),e.normalize();var t=e.x,n=e.y,i=e.width,r=e.height,o=this.x,a=this.y,s=this.width,l=this.height;return t>=o&&n>=a&&o+s>=t+i&&a+l>=n+r}},{key:"unContainsRect",value:function(e){return this.normalize(),e.normalize(),!(this.containPoint(e.getOrigin())||this.containPoint(e.getCorner())||this.containPoint(e.getTopRight())||this.containPoint(e.getBottomLeft()))}},{key:"intersect",value:function(t){var n=this.getOrigin(),i=this.getCorner(),r=t.getOrigin(),o=t.getCorner();if(n.x>=o.x||n.y>=o.y||r.x>=i.x||r.y>=i.y)return null;var a=Math.max(n.x,r.x),s=Math.max(n.y,r.y),l=Math.min(i.x,o.x)-a,u=Math.min(i.y,o.y)-s;return new e(a,s,l,u)}},{key:"union",value:function(t){var n=this.getOrigin(),i=this.getCorner(),r=t.getOrigin(),o=t.getCorner(),a=Math.min(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(i.x,o.x),u=Math.max(i.y,o.y);return new e(a,s,l-a,u-s)}},{key:"intersectionWithLineFromCenterToPoint",value:function(e,t){var n=void 0,i=this.getCenter();t&&e.rotate(i,t);for(var r=[new f["default"](this.getOrigin(),this.getTopRight()),new f["default"](this.getTopRight(),this.getCorner()),new f["default"](this.getCorner(),this.getBottomLeft()),new f["default"](this.getBottomLeft(),this.getOrigin())],o=new f["default"](i,e),a=r.length-1;a>=0;a-=1){var s=r[a].intersection(o);if(s){n=s;break}}return n&&t&&n.rotate(i,-t),n}},{key:"moveAndExpand",value:function(e){return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}},{key:"grow",value:function(e){return this.x-=e,this.y-=e,this.width+=2*e,this.height+=2*e,this}},{key:"round",value:function(e){return this.x=e?l.toFixed(this.x,e):Math.round(this.x),this.y=e?l.toFixed(this.y,e):Math.round(this.y),this.width=e?l.toFixed(this.width,e):Math.round(this.width),this.height=e?l.toFixed(this.height,e):Math.round(this.height),this}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.width,i=this.height;return 0>n&&(e+=n,n=-n),0>i&&(t+=i,i=-i),this.x=e,this.y=t,this.width=n,this.height=i,this}},{key:"getBBox",value:function(t){var n=l.toRad(t||0),i=Math.abs(Math.sin(n)),r=Math.abs(Math.cos(n)),o=this.width*r+this.height*i,a=this.width*i+this.height*r;return new e(this.x+(this.width-o)/2,this.y+(this.height-a)/2,o,a)}},{key:"snapToGrid",value:function(e,t){var n=this,i=n.getOrigin(),r=n.getCorner();return i=i.snapToGrid(e,t),r=r.snapToGrid(e,t),n.x=i.x,n.y=i.y,n.width=r.x-i.x,n.height=r.y-i.y,n}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"valueOf",value:function(){return[this.x,this.y,this.width,this.height]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"clone",value:function(){return e.fromRect(this)}}],[{key:"equals",value:function(e,t){var n=this.isRect(e)&&this.isRect(t);return n&&(e.standardizePort(),t.standardizePort(),n=e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height),n}},{key:"fromRect",value:function(t){return new e(t.x,t.y,t.width,t.height)}},{key:"fromVerticesAndRotation",value:function(t,n){var i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=(t.x+n.x)/2,o=(t.y+n.y)/2,a=new c["default"](t.x,t.y).distance(new c["default"](n.x,n.y)),s=180*Math.atan(Math.abs((n.y-t.y)/(t.x-n.x)))/Math.PI,l=Math.abs(a*Math.sin((90-i+s)/180*Math.PI)),u=Math.abs(a*Math.cos((90-i+s)/180*Math.PI)),h=r-l/2,f=o-u/2,d=new e(h,f,l,u);return d.cx=r,d.cy=o,d.rotation=i,d}},{key:"isRect",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=d},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),s=i(a),l=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];r(this,e),this.x=t,this.y=n}return o(e,[{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return this.x=e,this.y=t,this}},{key:"translate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return this.x+=e,this.y+=t,this}},{key:"rotate",value:function(t,n){n=(n+360)%360,this.toPolar(t),this.y+=s.toRad(n);var i=e.fromPolar(this.x,this.y,t);return this.x=i.x,this.y=i.y,this}},{key:"scale",value:function(t,n,i){return i=i||new e(0,0),this.x=i.x+t*(this.x-i.x),this.y=i.y+n*(this.y-i.y),this}},{key:"move",value:function(e,t){var n=s.toRad(e.theta(this));return this.translate(Math.cos(n)*t,-Math.sin(n)*t)}},{key:"reflect",value:function(e){return e.move(this,this.distance(e))}},{key:"diff",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"round",value:function(e){return this.x=e?s.toFixed(this.x,e):Math.round(this.x),this.y=e?s.toFixed(this.y,e):Math.round(this.y),this}},{key:"smooth",value:function(){return this.round(2)}},{key:"theta",value:function(t){t=t||new e;var n=-(t.y-this.y),i=t.x-this.x,r=10,o=0===s.toFixed(i,r)&&0===s.toFixed(n,r)?0:Math.atan2(n,i);return 0>o&&(o=2*Math.PI+o),s.toDeg(o)}},{key:"distance",value:function(t){t=t||new e;var n=t.x-this.x,i=t.y-this.y;return Math.sqrt(n*n+i*i)}},{key:"manhattanDistance",value:function(t){return t=t||new e,Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}},{key:"toPolar",value:function(t){t=t||new e(0,0);var n=this.x-t.x,i=this.y-t.y;return this.y=s.toRad(t.theta(e.fromPoint(this))),this.x=Math.sqrt(n*n+i*i),this}},{key:"normalize",value:function(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],n=this.x,i=this.y;if(0===n&&0===i)return this;var r=void 0;return r=0===n?t/i:0===i?t/n:t/this.distance(new e),this.x=r*n,this.y=r*i,this}},{key:"changeInAngle",value:function(t,n,i){return e.fromPoint(this).translate(-t,-n).theta(i)-this.theta(i)}},{key:"snapToGrid",value:function(e,t){return this.x=s.snapToGrid(this.x,e),this.y=s.snapToGrid(this.y,t||e),this}},{key:"adhereToRect",value:function(e){return e.containsPoint(this)?this:(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height),this)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}},{key:"valueOf",value:function(){return[this.x,this.y]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"clone",value:function(){return e.fromPoint(this)}}],[{key:"equals",value:function(e,t){return this.isPoint(e)&&this.isPoint(t)&&e.x===t.x&&e.y===t.y}},{key:"isPoint",value:function(t){return t&&t instanceof e}},{key:"isPointLike",value:function(e){return this.isPoint(e)?!0:e?s.hasOwn(e,"x")&&s.hasOwn(e,"y"):!1}},{key:"fromPoint",value:function(t){return new e(t.x,t.y)}},{key:"fromPolar",value:function(t,n,i){i=i||new e(0,0);var r=Math.abs(t*Math.cos(n)),o=Math.abs(t*Math.sin(n)),a=s.normalizeAngle(s.toDeg(n));return 90>a?o=-o:180>a?(r=-r,o=-o):270>a&&(r=-r),new e(i.x+r,i.y+o)}},{key:"fromString",value:function(t){var n=t.split(-1===t.indexOf("@")?" ":"@");return new e(s.toFloat(n[0]),s.toFloat(n[1]))}},{key:"random",value:function(t,n,i,r){var o=Math.floor(Math.random()*(n-t+1)+t),a=Math.floor(Math.random()*(r-i+1)+i);return new e(o,a)}}]),e}();t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),l=r(s),u=n(19),c=i(u),h=function(){function e(t,n){if(o(this,e),!t)throw new Error("The start point of line must be specified");if(!n)throw new Error("The end point of line must be specified");this.start=t,this.end=n}return a(e,[{key:"getLength",value:function(){return Math.sqrt(this.getSquaredLength())}},{key:"getSquaredLength",value:function(){var e=this.end.x-this.start.x,t=this.end.y-this.end.x;return e*e+t*t}},{key:"getMidpoint",value:function(){var e=(this.start.x+this.end.x)/2,t=(this.start.y+this.end.y)/2;return new c["default"](e,t)}},{key:"getPointAt",value:function(e){var t=(1-e)*this.start.x+e*this.end.x,n=(1-e)*this.start.y+e*this.end.y;return new c["default"](t,n)}},{key:"intersection",value:function(e){var t=this.start,n=this.end,i=e.start,r=e.end,o=new c["default"](n.x-t.x,n.y-t.y),a=new c["default"](r.x-i.x,r.y-i.y),s=o.x*a.y-o.y*a.x,l=new c["default"](i.x-t.x,i.y-t.y),u=l.x*a.y-l.y*a.x,h=l.x*o.y-l.y*o.x;if(0===s||0>u*s||0>h*s)return null;if(s>0){if(u>s||h>s)return null}else if(s>u||s>h)return null;return new c["default"](t.x+u*o.x/s,t.y+u*o.y/s)}},{key:"getDirection",value:function(){var e=this.start,t=this.end,n=l.toRad(e.y),i=l.toRad(t.y),r=e.x,o=t.x,a=l.toRad(o-r),s=Math.sin(a)*Math.cos(i),u=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(a),c=["NE","E","SE","S","SW","W","NW","N"],h=l.toDeg(Math.atan2(s,u)),f=h-22.5;return 0>f&&(f+=360),f=l.toInt(f/45),c[f]}},{key:"getOffset",value:function(e){var t=this.start,n=this.end;return((n.x-t.x)*(e.y-t.y)-(n.y-t.y)*(e.x-t.x))/2}},{key:"valueOf",value:function(){return[this.satrt.valueOf(),this.end.valueOf()]}},{key:"toString",value:function(){return this.start.toString()+" "+this.end.toString()}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"clone",value:function(){return e.fromLine(this)}}],[{key:"equals",value:function(e,t){return this.isLine(e)&&this.isLine(t)&&(e.start&&e.start.equals(t.start)||!e.start&&!t.start)&&(e.end&&e.end.equals(t.end)||!e.end&&!t.end)}},{key:"fromLine",value:function(t){return new e(t.start.clone(),t.end.clone())}},{key:"isLine",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){var n=this.getChildCount();return t=p.fixIndex(t,n),e.parent===this&&t===n&&(t-=1),e.removeFromParent({silent:!0}),e.parent=this,this.children&&this.children.length?this.children.splice(t,0,e):(this.children=[],this.children.push(e)),this}function s(e,t){var n=e&&e.getModel();return!n&&t&&t.getModel&&(n=t.getModel()),n}function l(e){return this.setParent.scheduled=e,this}function u(){return this.setParent.scheduled===!0}function c(e){return this.setTerminal.scheduled=e,this}function h(){return this.setTerminal.scheduled===!0}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n(3),p=r(d),v=n(22),y=i(v),g=function(){function e(t){o(this,e);var n=p.merge({},this.constructor.defaults,t);this.data=n.data,this.attrs=n.attrs||{},this.visible=n.visible!==!1,this.metadata=n}return f(e,[{key:"isLink",value:function(){return!1}},{key:"getTerminal",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];return e?this.source:this.target}},{key:"setTerminal",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setTerminal(this,e,t),c.call(this,!0))}return h.call(this)||(e=e?new y["default"](e):null,t?(this.source=e,e?(this.sourceNode=e.node,this.sourcePort=e.port,this.sourcePoint=e.point):(this.sourceNode=null,this.sourcePort=null,this.sourcePoint=null)):(this.target=e,e?(this.targetNode=e.node,this.targetPort=e.port,this.targetPoint=e.point):(this.targetNode=null,this.targetPort=null,this.targetPoint=null))),this}},{key:"getTerminalNode",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourceNode:this.targetNode;if(!t){var n=this.getTerminal(e);t=n&&n.node||null}return t}},{key:"setTerminalNode",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setTerminalNode(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourceNode=e:this.targetNode=e;var r=this.getTerminal(t);r&&(r.node=e)}return this}},{key:"getTerminalPort",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourcePort:this.targetPort;if(!t){var n=this.getTerminal(e);t=n&&n.port||null}return t}},{key:"setTerminalPort",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this);i&&(i.setTerminalPort(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourcePort=e:this.targetPort=e;var r=this.getTerminal(t);r&&(r.port=e)}return this}},{key:"getTerminalPoint",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=e?this.sourcePoint:this.targetPoint;if(!t){var n=this.getTerminal(e);t=n&&n.point||null}return t}},{key:"setTerminalPoint",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(c.call(this,!1),!n.silent){var i=s(this);i&&(i.setTerminalPoint(this,e,t),c.call(this,!0))}if(!h.call(this)){t?this.sourcePoint=e:this.targetPoint=e;var r=this.getTerminal(t);r&&(r.point=e)}return this}},{key:"removeFromTerminal",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this.getTerminal(e);if(n){if(c.call(this,!1),!t.silent){var i=s(this,n);i&&(i.removeFromTerminal(this,e),c.call(this,!0))}h.call(this)||n.removeLink(this,e,{silent:!0})}return this}},{key:"isNode",value:function(){return!1}},{key:"getLinks",value:function(){return this.links||[]}},{key:"getLinkCount",value:function(){return this.getLinks().length}},{key:"indexOfLink",value:function(e){return p.indexOf(this.links,e)}},{key:"getLinkAt",value:function(e){return this.links?this.links[e]:null}},{key:"eachLink",value:function(e,t){return p.forEach(this.links,e,t)}},{key:"filterLink",value:function(e,t){return p.filter(this.links,e,t)}},{key:"addLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!e)return this;if(c.call(e,!1),!n.silent){var i=s(e,this);i&&(i.setTerminal(e,this,t),c.call(e,!0))}return h.call(e)||(e.removeFromTerminal(t,{silent:!0}),(!this.links||this.indexOfLink(e)<0||e.getTerminalNode(!t)!==this)&&(this.links||(this.links=[]),this.links.push(e)),e.setTerminal(this,t,{silent:!0})),this}},{key:"removeLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!e)return this;if(c.call(e,!1),!n.silent){var i=s(e,this);i&&(i.setTerminal(e,null,t),c.call(e,!0))}if(!h.call(e)){if(this.links&&e.getTerminalNode(!t)!==this){var r=this.indexOfLink(e);r>=0&&this.links.splice(r,1)}e.setTerminal(null,t,{silent:!0})}return this}},{key:"getChildren",value:function(){return this.children||[]}},{key:"getChildCount",value:function(){return this.getChildren().length}},{key:"indexOfChild",value:function(e){return p.indexOf(this.children,e)}},{key:"getChildAt",value:function(e){return this.children?this.children[e]:null}},{key:"eachChild",value:function(e,t){return p.forEach(this.children,e,t)}},{key:"filterChild",value:function(e,t){return p.filter(this.children,e,t)}},{key:"insertChild",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return e?(p.isObject(t)&&(n=t),l.call(e,!1),n.silent||e.setParent(this,t),u.call(e)||a.call(this,e,t),this):this}},{key:"removeChild",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.removeChildAt(this.indexOfChild(e),t)}},{key:"removeChildAt",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this.getChildAt(e);return n&&(l.call(n,!1),t.silent||n.setParent(null),u.call(n)||(this.children.splice(e,1),n.parent=null)),n}},{key:"getParent",value:function(){return this.parent}},{key:"setParent",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(l.call(this,!1),!n.silent){var i=s(this,e);i&&(i.setParent(this,e,t),l.call(this,!0))}return u.call(this)||(e?a.call(e,this,t):this.removeFromParent({silent:!0})),this}},{key:"removeFromParent",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.parent){var t=!1;if(!e.silent){var n=s(this,this.parent);n&&(n.removeCell(this),t=!0)}t||this.parent.removeChild(this,{silent:!0})}return this}},{key:"isOrphan",value:function(){return p.isNil(this.parent)}},{key:"isAncestor",value:function(e){if(!e)return!1;for(;e&&e!==this;)e=e.parent;return e===this}},{key:"contains",value:function(e){return this.isAncestor(this,e)}},{key:"getAncestors",value:function(){for(var e=[],t=this.parent;t;)e.push(t),t=t.parent;return e}},{key:"getDescendants",value:function(){var e=this,t=[];return this.eachChild(function(n){t.push(n),t=t.concat(e.getDescendants(n))}),t}},{key:"getSize",value:function(e){return e?this.metadata.size:this.size}},{key:"_setSize",value:function(e){this.metadata.size=e}},{key:"setSize",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={width:e.width,height:e.height,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setSize(this,e),n=!0)}return n||this._setSize(e),this}},{key:"resize",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.setSize({width:e,height:t},n)}},{key:"getPosition",value:function(e){return e?this.metadata.position:this.position}},{key:"_setPosition",value:function(e){this.metadata.position=e}},{key:"setPosition",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={x:e.x,y:e.y,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setPosition(this,e),n=!0)}return n||this._setPosition(e),this}},{key:"translate",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return this.setPosition({x:e,y:t},n)}},{key:"getRotation",value:function(e){return e?this.metadata.rotation:this.rotation}},{key:"_setRotation",value:function(e){this.metadata.rotation=e}},{key:"setRotation",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(e={angle:e.angle,relative:e.relative===!0},!t.silent){var i=this.getModel();i&&(i.setRotation(this,e),n=!0)}return n||this._setRotation(e),this}},{key:"rotate",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return this.setRotation({angle:e},t)}},{key:"getGeometry",value:function(e){return{size:this.getSize(e),position:this.getPosition(e),rotation:this.getRotation(e)}}},{key:"_setGeometry",value:function(e){var t=this;p.forEach(["size","position","rotation"],function(n){var i=e[n];i&&t["_set"+p.ucFirst(n)](i)})}},{key:"setGeometry",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=this.getModel();i&&(i.setGeometry(this,e),n=!0)}return n||this._setGeometry(e),this}},{key:"isCollapsed",value:function(){return this.metadata.collapsed===!0}},{key:"_setCollapsed",value:function(e){this.metadata.collapsed=e}},{key:"setCollapsed",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=s(this);i&&(i.setCollapsed(this,e),n=!0)}return n||this._setCollapsed(e),this}},{key:"collapse",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setCollapsed(!0,e)}},{key:"expand",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setCollapsed(!1,e)}},{key:"toggleCollapse",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.isCollapsed()?this.expand(e):this.collapse(e)}},{key:"isVisible",value:function(){return this.visible!==!1}},{key:"_setVisible",value:function(e){this.visible=this.metadata.visible=!!e}},{key:"setVisible",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=s(this);i&&(i.setVisible(this,e),n=!0)}return n||this._setVisible(e),this}},{key:"show",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setVisible(!0,e)}},{key:"hide",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.setVisible(!1,e)}},{key:"toggleVisible",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.isVisible()?this.hide(e):this.show(e)}},{key:"getAttribute",value:function(){return this.metadata.attrs}},{key:"_setAttribute",value:function(e){this.metadata.attrs=p.merge({},this.getAttribute(),e)}},{key:"setAttribute",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=!1;if(!t.silent){var i=this.getModel();i&&(i.setAttribute(this,e),n=!0)}return!n&&this.metadata&&this._setAttribute(e),this}},{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(e){return this.model=e||null,this}},{key:"addTo",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?this.getModel():arguments[2];return n&&n.addCell(this,e,t),this}},{key:"getView",value:function(e){return e.getView(this)}},{key:"getClassName",value:function(){var e=this.metadata.classNames;return p.isArray(e)?e.join(" "):e||""}},{key:"getTagName",value:function(){return this.metadata.tagName||"g"}},{key:"getMarkup",value:function(){return this.metadata.markup}},{key:"getRenderData",value:function(){return this.data}},{key:"valueOf",value:function(){return this.data}},{key:"toString",value:function(){return this.getId()||Object.toString.call(this)}},{key:"cloneData",value:function(){var e=this.data;if(e){if(e.clone&&p.isFunction(e.clone))return e.clone();if(p.isNode(e))return e.cloneNode(!0);if(p.isObject(e))return p.merge({},e)}return e}},{key:"clone",value:function(e,t){var n=p.merge({},this.metadata,e);return n.data=t===!0?this.cloneData():this.data,n.visible=this.visible,new this.constructor(n)}},{key:"destroy",value:function(){this.eachChild(function(e){return e.destroy()}),this.eachLink(function(e){return e.destroy()}),this.removeFromTerminal(!0).removeFromTerminal(!1).removeFromParent(),p.destroy(this)}}],[{key:"setDefaults",value:function(e){this.defaults=p.merge({},this.defaults,e)}}]),e}();t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return this.setTerminal.scheduled=e,this}function s(){return this.setTerminal.scheduled===!0}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(19),f=i(h),d=function(){function e(t){return o(this,e),t instanceof e?t:(t&&(t.isNode&&t.isNode()?this.node=t:f["default"].isPointLike(t)?this.point=f["default"].fromPoint(t):c.isObject(t)&&(this.node=t.node,this.port=t.port,this.point=f["default"].isPointLike(t.point)?f["default"].fromPoint(t.point):null)),this)}return l(e,[{key:"addLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(e){if(a.call(e,!1),!n.silent){var i=e.getModel()||this.getModel();i&&(i.setTerminal(e,this,t),a.call(e,!0))}s.call(e)||(this.node&&this.node.addLink(e,t,{silent:!0}),e.setTerminal(this,t,{silent:!0}))}return this}},{key:"removeLink",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(e){if(a.call(e,!1),!n.silent){var i=e.getModel()||this.getModel();i&&(i.setTerminal(e,null,t),a.call(e,!0))}s.call(e)||(this.node&&this.node.removeLink(e,t,{silent:!0}),e.setTerminal(null,t,{silent:!0}))}return this}},{key:"duplicate",value:function(t){var n=new e(t);return c.forEach(["node","port","point"],function(e){this[e]&&!n[e]&&(n[e]=this[e])},this),n}},{key:"getModel",value:function(){return this.node&&this.node.getModel()}}]),e}();t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function k(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:k(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},h=n(3),f=r(h),d=n(24),p=i(d),v=n(25),y=i(v),g=n(26),m=i(g),b=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),u(t,[{key:"renderMarkup",value:function(){return c(Object.getPrototypeOf(t.prototype),"renderMarkup",this).call(this),this.renderPorts(),this}},{key:"renderPorts",value:function(){var e=this.vel,t=this.getCell(),n=t.getInPorts(),i=t.getOutPorts(),r=t.getPortMarkup(),o=e.findOne(t.getPortsWrapSelector(!0)),a=e.findOne(t.getPortsWrapSelector(!1));return o&&(o.empty(),f.forEach(n,function(e){var t=this.compileMarkup(r,e);o.append((0,p["default"])(t))},this)),a&&(a.empty(),f.forEach(i,function(e){var t=this.compileMarkup(r,e);a.append((0,p["default"])(t))},this)),this}},{key:"getConnectionPointOnPort",value:function(){return null}},{key:"getPortBodyBBox",value:function(e){var t=this.getCell(),n=f.isObject(e)?e.id:e;e=t.getPortById(n);var i=t.getPortSelector(e,t.isInPort(e));if(i){var r=this.findOne(i),o=r&&r.findOne(".port-body");if(o)return o.getBBox()}return null}},{key:"getPortBodyGeom",value:function(e){var t=this.getCell(),n=f.isObject(e)?e.id:e;e=t.getPortById(n);var i=t.getPortSelector(e,t.isInPort(e));if(i){var r=this.findOne(i),o=r&&r.findOne(".port-body"),a=o&&o.node;if(a){var s=o.getBBox(!1,this.getPane()),l=s.getCenter(),u=void 0;if(f.isNode(a,"circle")){var c=f.getComputedStyle(a,"r");c=f.toFloat(c),c&&(u=new y["default"](l.x,l.y,c,c))}else if(f.isNode(a,"ellipse")){var h=f.getComputedStyle(a,"rx"),d=f.getComputedStyle(a,"ry");h=f.toFloat(h),d=f.toFloat(d),h&&d&&(u=new y["default"](l.x,l.y,h,d))}else u=s;return u}}return null}},{key:"findPortByElem",value:function(e){var t=this,n=t.vel,i=t.cell,r=(0,p["default"])(e),o="pane-port";if(r.hasClass(o)||(r=r.findParent(o,n.node)),r){var a=r.parent();if(a){var s=function(){var e=r.index(),t=a.hasClass("in")?"in":a.hasClass("out")?"out":"",n="in"===t?i.inPorts:"out"===t?i.outPorts:[],o=i.getPortSelector(t,e),s=null;return f.some(n,function(e){return e.selector===o?(s=e,!0):!1}),{v:s}}();if("object"===("undefined"==typeof s?"undefined":l(s)))return s.v}}return null}}]),t}(m["default"]);t["default"]=b},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);
return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){var e=void 0;do w+=1,e="pane-path-"+w;while(document.getElementById(e));return e}function s(e,t){return{x:t.x*e.a+t.y*e.c,y:t.x*e.b+t.y*e.d}}function l(e){var t=s(e,{x:0,y:1}),n=s(e,{x:1,y:0}),i=180/Math.PI*Math.atan2(t.y,t.x)-90,r=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:i,skewY:r,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:i}}function u(e){var t=x.isVElement(e)?e:d(e);return y.isArray(t)?t[t.length-1]:t}function c(e,t,n){if(e){var i=y.map(y.isArray(e)?e:[e],function(t){return x.isVElement(t)?t:d(e)});y.forEach(i,t,n)}}function h(e){return new P(e)}function f(e){return e instanceof P?e.node:e}function d(e,t,n){if(!e)return null;if(e instanceof P&&(e=e.node),y.isString(e))if(e=y.trim(e),"svg"===e.toLowerCase())e=y.createSvgDocument();else if("<"===e[0]){var i=y.createSvgDocument(e);if(i.childNodes.length>1)return y.map(i.childNodes,function(e){return h(document.importNode(e,!0))});e=document.importNode(i.firstChild,!0)}else e=y.createSvgElement(e);var r=h(e);return t&&r.setAttrs(t),n&&r.append(n),r}Object.defineProperty(t,"__esModule",{value:!0}),t.VElement=void 0;var p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v=n(3),y=r(v),g=n(18),m=i(g),b=n(19),k=i(b),w=0,P=t.VElement=function(){function e(t){if(o(this,e),!(this instanceof e))return new e(t);if(t instanceof e&&(t=t.node),!t)throw new Error("Unknown elem for VElement");return this.node=t,this}return p(e,[{key:"attr",value:function(e,t){return y.isUndefined(e)?y.reduce(this.node.attributes,function(e,t){return e[t.nodeName]=t.nodeValue,e},{}):y.isString(e)&&y.isUndefined(t)?this.node.getAttribute(e):(y.isObject(e)?this.setAttrs(e):this.setAttr(e,t),this)}},{key:"setAttr",value:function(e,t){return y.isNil(t)?this.removeAttr(e):y.setAttribute(this.node,e,t),this}},{key:"setAttrs",value:function(e){return y.forIn(e,function(e,t){this.setAttr(t,e)},this),this}},{key:"removeAttr",value:function(e){return y.removeAttribute(this.node,e),this}},{key:"show",value:function(){return y.showHide(this.node,!0),this}},{key:"hide",value:function(){return y.showHide(this.node,!1),this}},{key:"toggle",value:function(e){return y.isBoolean(e)?e?this.show():this.hide():(y.isHidden(this.node)?this.show():this.hide(),this)}},{key:"getClassName",value:function(){return y.getClassName(this.node)}},{key:"hasClass",value:function(e){return y.hasClass(this.node,e)}},{key:"addClass",value:function(e){return y.addClass(this.node,e),this}},{key:"removeClass",value:function(e){return y.removeClass(this.node,e),this}},{key:"toggleClass",value:function(e,t){return y.toggleClass(this.node,e,t),this}},{key:"css",value:function(e,t){return e?(y.setStyle(this.node,e,t),this):this.node.style}},{key:"text",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e=y.sanitizeText(e);var i=this.attr("y");i||this.attr("y","0.8em"),this.attr("display",e?null:"none"),this.attr("xml:space","preserve"),this.node.textContent="";var r=this.node,o=n.textPath;if(o){var s=this.find("defs");s.length||(s=d("defs"),this.append(s));var l=Object(o)===o,u=l?o.d:o,c=void 0;u&&(c=d("path",{d:u,id:a()}),s.append(c));var h=d("textPath");!o["xlink:href"]&&c&&h.attr("xlink:href","#"+c.node.id),l&&h.attr(o),this.append(h),r=h.node}var f=0,p=e.split("\n"),v=n.lineHeight,g=n.annotations,m=n.includeAnnotationIndices;return g&&(g=y.isArray(g)?g:[g]),v="auto"===v?"1.5em":v||"1em",y.forEach(p,function(e,i){var o=d("tspan",{dy:i?v:"0",x:t.attr("x")||0});o.addClass("pane-text-line"),e?g?!function(){var t=0,r=x.annotateString(e,g,{offset:-f,includeAnnotationIndices:m});y.forEach(r,function(e){var n=void 0;if(y.isObject(e)){var i=y.toInt(e.attrs["font-size"]);i&&i>t&&(t=i),n=d("tspan",e.attrs),m&&n.attr("annotations",e.annotations),e.attrs["class"]&&n.addClass(e.attrs["class"]),n.node.textContent=e.t}else n=document.createTextNode(e||" ");o.append(n)}),"auto"===n.lineHeight&&t&&0!==i&&o.attr("dy",1.2*t+"px")}():o.node.textContent=e:(o.addClass("pane-text-empty"),o.node.style.opacity=0,o.node.textContent="-"),r.appendChild(o.node),f+=e.length+1},this),this}},{key:"html",value:function(e){return this.node.innerHTML=e,this}},{key:"remove",value:function(){return y.removeElement(this.node),this}},{key:"empty",value:function(){return y.emptyElement(this.node),this}},{key:"append",value:function(e){return c(e,function(e){this.node.appendChild(f(e))},this),this}},{key:"prepend",value:function(e){return c(e,function(e){this.node.insertBefore(f(e),this.node.firstChild)},this),this}},{key:"before",value:function(e){return c(e,function(e){this.node.parentNode&&this.node.parentNode.insertBefore(f(e),this.node)},this),this}},{key:"after",value:function(e){return c(e,function(e){this.node.parentNode&&this.node.parentNode.insertBefore(f(e),this.node.nextSibling)},this),this}},{key:"appendTo",value:function(e){return u(e).append(this),this}},{key:"prependTo",value:function(e){return u(e).prepend(this),this}},{key:"insertBefore",value:function(e){return u(e).before(this),this}},{key:"insertAfter",value:function(e){return u(e).after(this),this}},{key:"getSVG",value:function(){return this.node instanceof window.SVGSVGElement?this:h(this.node.ownerSVGElement)}},{key:"getDefs",value:function(){var e=this.getSVG(),t=e.node.getElementsByTagName("defs");return t&&t.length?t=h(t[0]):(t=d("defs"),e.append(t)),t}},{key:"clone",value:function(){var e=h(this.node.cloneNode(!0));return this.node.id&&e.node.removeAttribute("id"),e}},{key:"find",value:function(e){return y.map(this.node.querySelectorAll(e),h)}},{key:"findOne",value:function(e){var t=this.node.querySelector(e);return t?h(t):null}},{key:"findParent",value:function(e,t){for(var n=t||this.node.ownerSVGElement,i=this.node.parentNode;i&&i!==n;){var r=h(i);if(r.hasClass(e))return r;i=i.parentNode}return null}},{key:"parent",value:function(){var e=this.node&&this.node.parentNode;return e?h(e):null}},{key:"index",value:function(){for(var e=0,t=this.node.previousSibling;t;)1===t.nodeType&&(e+=1),t=t.previousSibling;return e}},{key:"translate",value:function(e,t,n){var i=this.attr("transform")||"",r=y.parseTranslate(i);if(y.isUndefined(e))return r;e=n?r.tx+e:e,t=n?r.ty+t:t;var o=y.clearTranslate(i),a="translate("+e+","+t+")";return o&&(a=a+" "+o),this.attr("transform",a),this}},{key:"rotate",value:function(e,t,n,i){var r=this.attr("transform")||"",o=y.parseRotate(r);if(y.isUndefined(e))return o;e%=360;var a=i?o.angle+e:e,s=y.isUndefined(t)||y.isUndefined(n)?"":","+t+","+n,l=y.clearRotate(r),u="rotate("+a+s+")";return l&&(u=l+" "+u),this.attr("transform",u)}},{key:"scale",value:function(e,t,n){var i=this.attr("transform")||"",r=y.parseScale(i);if(y.isUndefined(e))return r;y.isUndefined(t)&&(t=e),e=n?r.sx*e:e,t=n?r.sy*t:t;var o=y.clearScale(i),a="scale("+e+","+t+")";return o&&(a=o+" "+a),this.attr("transform",a)}},{key:"getBBox",value:function(e,t){if(!this.node.ownerSVGElement)return new m["default"](0,0,0,0);var n=void 0;try{n=this.node.getBBox(),n={x:n.x,y:n.y,width:n.width,height:n.height}}catch(i){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}if(!e){var r=this.getTransformToElement(t||this.node.ownerSVGElement);n=x.transformRect(n,r)}return m["default"].fromRect(n)}},{key:"toLocalPoint",value:function(e,t){var n=this.getSVG().node,i=n.createSVGPoint();i.x=e,i.y=t;try{var r=i.matrixTransform(n.getScreenCTM().inverse()),o=this.getTransformToElement(n).inverse();return r.matrixTransform(o)}catch(a){return i}}},{key:"getTransformToElement",value:function(e){return y.getTransformToElement(this.node,e)}},{key:"translateCenterToPoint",value:function(e){var t=this.getBBox(),n=t.getCenter();return this.translate(e.x-n.x,e.y-n.y),this}},{key:"translateAndAutoOrient",value:function(e,t,n){var i=this.scale();this.attr("transform",""),this.scale(i.sx,i.sy);var r=this.getSVG().node,o=this.getBBox(!1,n),a=r.createSVGTransform();a.setTranslate(-o.x-o.width/2,-o.y-o.height/2);var s=r.createSVGTransform(),u=k["default"].fromPoint(e).changeInAngle(e.x-t.x,e.y-t.y,t);s.setRotate(u,0,0);var c=r.createSVGTransform(),h=k["default"].fromPoint(e).move(t,o.width/2),f=e.x+(e.x-h.x),d=e.y+(e.y-h.y);c.setTranslate(f,d);var p=this.getTransformToElement(n),v=r.createSVGTransform();v.setMatrix(c.matrix.multiply(s.matrix.multiply(a.matrix.multiply(p))));var g=l(v.matrix);return f=y.toFixed(g.translateX,2),d=y.toFixed(g.translateY,2),this.translate(f,d),this.rotate(y.toFixed(g.rotation,2)),this}},{key:"animateAlongPath",value:function(){}},{key:"sample",value:function t(e){e=e||1;for(var n=this.node.getTotalLength(),i=0,r=[];n>i;){var t=this.node.getPointAtLength(i);r.push({distance:i,x:t.x,y:t.y}),i+=e}return r}},{key:"toPath",value:function(){var e=h(y.createSvgElement("path")),t=this.toPathData();return e.attr(this.attr()),t&&e.attr("d",t),e}},{key:"toPathData",value:function(){var e=this.node.tagName.toLowerCase();if("path"===e)return this.attr("d");var t=y[e+"ToPathData"];if(y.isFunction(t))return t(this.node);throw new Error(e+" cannot be converted to PATH.")}},{key:"findIntersection",value:function(e,t){var n=this,i=n.getSVG().node;t=t||i;var r=m["default"].fromRect(n.getBBox(!1,t)),o=r.getCenter(),a=r.intersectionWithLineFromCenterToPoint(e);if(a){var s=n.node.localName.toUpperCase();if("RECT"===s){var l=new m["default"](parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),u=n.getTransformToElement(t),c=x.decomposeMatrix(u),h=i.createSVGTransform();h.setRotate(-c.rotation,o.x,o.y);var f=x.transformRect(l,h.matrix.multiply(u));a=m["default"].fromRect(f).intersectionWithLineFromCenterToPoint(e,c.rotation)}else if("PATH"===s||"POLYGON"===s||"POLYLINE"===s||"CIRCLE"===s||"ELLIPSE"===s){for(var d="PATH"===s?n:n.toPath(),p=d.sample(),v=1/0,y=[],g=0,b=p.length;b>g;g+1){var w=p[g],P=x.createSVGPoint(w.x,w.y);P=P.matrixTransform(n.getTransformToElement(t)),w=k["default"].fromPoint(P);var O=w.distance(o),C=1.1*w.distance(e),M=O+C;v>M?(v=M,y=[{sample:w,refDistance:C}]):v+1>M&&y.push({sample:w,refDistance:C})}y.sort(function(e,t){return e.refDistance-t.refDistance}),a=y[0].sample}return a}}}]),e}(),x=P.create=d,O=d("svg").node;y.extend(x,{isVElement:function(e){return e instanceof P},createSVGPoint:function(e,t){var n=O.createSVGPoint();return n.x=e,n.y=t,n},createSVGMatrix:function(e){var t=O.createSVGMatrix();for(var n in e)t[n]=e[n];return t},createSVGTransform:function(e){return y.isUndefined(e)?O.createSVGTransform():(e instanceof SVGMatrix||(e=x.createSVGMatrix(e)),O.createSVGTransformFromMatrix(e))},transformRect:function(e,t){var n=O.createSVGPoint();n.x=e.x,n.y=e.y;var i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;var r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;var o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;var a=n.matrixTransform(t),s=Math.min(i.x,r.x,o.x,a.x),l=Math.max(i.x,r.x,o.x,a.x),u=Math.min(i.y,r.y,o.y,a.y),c=Math.max(i.y,r.y,o.y,a.y);return{x:s,y:u,width:l-s,height:c-u}},annotations:function(e,t,n){t=t||[],t=y.isArray(t)?t:[t],n=n||{};for(var i=[],r=[],o=n.offset||0,a=void 0,s=void 0,l=void 0,u=0,c=e.length;c>u;u+=1){s=r[u]=e[u];for(var h=0,f=t.length;f>h;h+=1){var d=t[h],p=d.start+o,v=d.end+o;u>=p&&v>u&&(y.isObject(s)?s.attrs=y.merge({},s.attrs,d.attrs):s=r[u]={t:e[u],attrs:d.attrs},n.includeAnnotationIndices&&(s.annotations||(s.annotations=[]),s.annotations.push(h)))}l=r[u-1],l?y.isObject(s)&&y.isObject(l)?JSON.stringify(s.attrs)===JSON.stringify(l.attrs)?a.t+=s.t:(i.push(a),a=s):y.isObject(s)?(i.push(a),a=s):y.isObject(l)?(i.push(a),a=s):a=(a||"")+s:a=s}return a&&i.push(a),i}}),t["default"]=x},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(18),s=i(a),l=n(19),u=i(l),c=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],o=arguments.length<=3||void 0===arguments[3]?0:arguments[3];r(this,e),this.x=t,this.y=n,this.a=i,this.b=o}return o(e,[{key:"getCenter",value:function(){return new u["default"](this.x,this.y)}},{key:"getBBox",value:function(){return new s["default"](this.x-this.a,this.y-this.b,2*this.a,2*this.b)}},{key:"grow",value:function(e){return this.a+=e,this.b+=e,this}},{key:"intersectionWithLineFromCenterToPoint",value:function(e,t){var n=void 0,i=this.getCenter();t&&e.rotate(i,t);var r=e.x-this.x,o=e.y-this.y;if(0===r)return n=this.getBBox().getNearestPointToPoint(e),t?n.rotate(i,-t):n;var a=o/r,s=a*a,l=this.a*this.a,c=this.b*this.b,h=Math.sqrt(1/(1/l+s/c));h=0>r?-h:h;var f=a*h;return n=new u["default"](this.x+h,this.y+f),t?n.rotate(i,-t):n}},{key:"equals",value:function(t){return e.equals(this,t)}},{key:"valueOf",value:function(){return[this.x,this.y,this.a,this.b]}},{key:"toString",value:function(){return this.valueOf().join(", ")}},{key:"clone",value:function(){return e.fromEllipse(this)}}],[{key:"equals",value:function(e,t){return this.isEllipse(e)&&this.isEllipse(t)&&e.x===t.x&&e.y===t.y&&e.a===t.a&&e.b===t.b}},{key:"fromEllipse",value:function(t){return new e(t.x,t.y,t.a,t.b)}},{key:"isEllipse",value:function(t){return t&&t instanceof e}}]),e}();t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(27),f=i(h),d=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode=this.findOne(".pane-scalable"),this.rotatableNode=this.findOne(".pane-rotatable"),this.update().resize().rotate().translate()}},{key:"update",value:function(e){var n=this,i=this.cell.attrs,r=this.rotatableNode,o=void 0;r&&(o=r.attr("transform"),r.attr("transform",""));var a={},s=[];c.forIn(e||i,function(e,i){var r=n.find(i);if(r.length){a[i]=r;var o=t.specialAttributes.slice();c.isObject(e.filter)&&(o.push("filter"),n.applyFilter(r,e.filter)),c.isObject(e.fill)&&(o.push("fill"),n.applyGradient(r,"fill",e.fill)),c.isObject(e.stroke)&&(o.push("stroke"),n.applyGradient(r,"stroke",e.stroke)),c.isNil(e.text)||(o.push("lineHeight","textPath","annotations"),c.forEach(r,function(t){t.text(e.text,{textPath:e.textPath,lineHeight:e.lineHeight,annotations:e.annotations})}));var l={};c.forIn(e,function(e,t){c.contains(o,t)||(l[t]=e)}),c.isEmptyObject(l)||c.forEach(r,function(e){e.attr(l)}),c.isNil(e.html)||c.forEach(r,function(t){t.node.innerHTML=e.html});var u=c.some(["ref-x","ref-y","ref-dx","ref-dy","x-alignment","y-alignment","ref-width","ref-height"],function(t){return!c.isNil(e[t])});u&&s.push(i)}});var l=this.cell.size,u={x:0,y:0,width:l.width,height:l.height};return c.forEach(s,function(t){var r=i[t],o=e&&e[t];o&&(r=c.merge({},r,o)),c.forEach(a[t],function(e){n.positionRelative(e,u,r,a)})}),r&&r.attr("transform",o||""),this}},{key:"positionRelative",value:function(e,t,n,i){var r=n.ref;if(r){var o=i&&i[r];if(o=o?o[0]:"."===r?this.vel:this.vel.findOne(r),!o)throw new Error("NodeView: reference does not exists.");t=o.getBBox(!1,this.elem)}var a=c.toFloat(n["ref-dx"]),s=c.toFloat(n["ref-dy"]),l=n["y-alignment"],u=n["x-alignment"],h=n["ref-x"],f=c.isPercentage(h);h=c.toFloat(h,f);var d=n["ref-y"],p=c.isPercentage(d);d=c.toFloat(d,p);var v=n["ref-width"],y=c.isPercentage(v);v=c.toFloat(v,y);var g=n["ref-height"],m=c.isPercentage(g);g=c.toFloat(g,m),c.isFinite(v)&&(y||v>=0&&1>=v?e.attr("width",c.toFixed(v*t.width,2)):e.attr("width",Math.max(c.toFixed(v+t.width,2),0))),c.isFinite(g)&&(m||g>=0&&1>=g?e.attr("height",c.toFixed(g*t.height,2)):e.attr("height",Math.max(c.toFixed(g+t.height,2),0)));var b=e.findParent("pane-scalable",this.elem),k=e.attr("transform");k&&e.attr("transform",c.clearTranslate(k));var w=0,P=0,x=void 0;if(c.isFinite(a)&&(b?(x=b.scale(),w=t.x+t.width+a/x.sx):w=t.x+t.width+a),c.isFinite(s)&&(b?(x=x||b.scale(),P=t.y+t.height+s/x.sy):P=t.y+t.height+s),c.isFinite(h)&&(f||h>0&&1>h?w=t.x+t.width*h:b?(x=x||b.scale(),w=t.x+h/x.sx):w=t.x+h),c.isFinite(d)&&(f||d>0&&1>d?P=t.y+t.height*d:b?(x=x||b.scale(),P=t.y+d/x.sy):P=t.y+d),!c.isNil(l)||!c.isNil(u)){var O=e.getBBox(!1,this.getPane());"middle"===l?P-=O.height/2:c.isFinite(l)&&(P+=l>-1&&1>l?O.height*l:l),"middle"===u?w-=O.width/2:c.isFinite(u)&&(w+=u>-1&&1>u?O.width*u:u)}return e.translate(c.toFixed(w,2),c.toFixed(P,2)),this}},{key:"scale",value:function(e,t){return this.vel.scale(e,t),this}},{key:"resize",value:function(){if(!this.scalableNode)return this;var e=this.scalableNode.getBBox(!0),t=this.cell.getSize(),n=t.width/(e.width||1),i=t.height/(e.height||1);return n=c.toFixed(n,2),i=c.toFixed(i,2),this.scalableNode.attr("transform","scale("+n+","+i+")"),this.update(),this}},{key:"rotate",value:function(){if(this.rotatableNode){var e=this.cell.getSize(),t=e.width/2,n=e.height/2;this.rotatableNode.attr("transform","rotate("+this.cell.getRotation()+","+t+","+n+")")}return this}},{key:"translate",value:function(){var e=this.cell.getPosition();return this.vel.attr("transform","translate("+e.x+","+e.y+")"),this}},{key:"getBBox",value:function(){return this.vel.getBBox()}},{key:"getStrokeWidth",value:function(){var e=this.findOne("rect")||this.findOne("path")||this.findOne("circle")||this.findOne("ellipse")||this.findOne("polyline")||this.findOne("polygon");if(e&&e.node){var t=c.getComputedStyle(e.node,"stroke-width");return t&&c.toFloat(t)||0}return 0}},{key:"getStrokedBBox",value:function(){var e=this.getStrokeWidth()-1,t=this.getCell().getBBox();return e?t.grow(e/2):t}},{key:"getConnectionPointOnBorder",value:function(){return null}}],[{key:"specialAttributes",get:function(){return["text","html","style","ref","ref-x","ref-y","ref-dx","ref-dy","ref-width","ref-height","x-alignment","y-alignment"]}}]),t}(f["default"]);t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(28),p=i(d),v=n(29),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"ensureElement",value:function(){this.vel=(0,f["default"])(this.cell.getTagName(),{"class":this.cell.getClassName()}),this.elem=this.vel.node,this.elem.cellId=this.cell.id;var e=this.getPane();return e&&e.appendChild(this.elem),this}},{key:"renderMarkup",value:function(){var e=this.compileMarkup(this.cell.getMarkup(),this.cell.getRenderData());if(!e)throw new Error("`markup` is missing while the default `render()` implementation is used.");return this.vel.append((0,f["default"])(e)),this}},{key:"find",value:function(e){return"."===e?[this.vel]:this.vel.find(e)}},{key:"findOne",value:function(e){return"."===e?this.vel:this.vel.findOne(e)}},{key:"applyAttr",value:function(e,t){return t&&c.forEach(this.find(e),function(e){e.attr(t)}),this}},{key:"applyFilter",value:function(e,t){if(!t)return this;var n=t.name||"",i=t.args||{},r=t.attrs,o=p["default"][n];if(!n||!o)throw new Error('Invalided filter: "'+n+'"');var a=c.isString(e)?this.find(e):e;if(!a.length)return this;var s=this.paper.svg,l=c.hashCode(JSON.stringify(t)),u=n+"-"+this.paper.id+"-"+l;if(!s.getElementById(u)){var h=(0,f["default"])(o(i));h.attr({filterUnits:"objectBoundingBox",x:-1,y:-1,width:3,height:3}),r&&h.attr(r),h.node.id=u,(0,f["default"])(s).getDefs().append(h)}return c.forEach(a,function(e){e.attr("filter","url(#"+u+")")}),this}},{key:"applyGradient",value:function(e,t,n){if(!t||!n)return this;var i=n.type,r=n.stops,o=n.attrs;if(!i||!r||!r.length)return this;var a=c.isString(e)?this.find(e):e;if(!a.length)return this;var s=this.paper.svg,l=i+"-"+this.paper.id+"-"+c.hashCode(JSON.stringify(n));if(!s.getElementById(l)){var u=["<"+i+">",c.map(r,function(e){return'<stop offset="'+e.offset+'" stop-color="'+e.color+'" stop-opacity="'+(c.isFinite(e.opacity)?e.opacity:1)+'" />'}).join(""),"</"+i+">"].join(""),h=(0,f["default"])(u);o&&h.attr(o),h.node.id=l,(0,f["default"])(s).getDefs().append(h)}return c.forEach(a,function(e){e.attr(t,"url(#"+l+")")}),this}},{key:"getBounds",value:function(e){if(e){var t=e===document?e:e.ownerDocument,n=c.getBounds(this.elem),i=c.getOffsetUntil(e,this.elem),r=this.getPaper(),o=r&&r.sx||1,a=(e.offsetWidth||e.clientWidth)*o,s=(e.offsetHeight||e.clientHeight)*o,l=n.left+i.left*o,u=n.top+i.top*o,h=t.body.clientWidth-a-l,f=t.body.clientHeight-s-u;return{left:l,top:u,right:h,bottom:f,width:a,height:s}}return null}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);t["default"]={outline:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.color||"blue",n=(0,i.isFinite)(e.width)?e.width:1,r=(0,i.isFinite)(e.margin)?e.margin:2,o=(0,i.isFinite)(e.opacity)?e.opacity:1,a=r,s=r+n;return(0,i.trim)('\n      <filter>\n        <feFlood flood-color="'+t+'" flood-opacity="'+o+'" result="colored"/>\n        <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="'+s+'" />\n        <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="'+a+'" />\n        <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n        <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n        <feMerge>\n          <feMergeNode in="outline"/>\n          <feMergeNode in="SourceGraphic"/>\n        </feMerge>\n      </filter>\n    ')},highlight:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.color||"red",n=(0,i.isFinite)(e.blur)?e.blur:0,r=(0,i.isFinite)(e.width)?e.width:1,o=(0,i.isFinite)(e.opacity)?e.opacity:1;return(0,i.trim)('\n      <filter>\n        <feFlood flood-color="'+t+'" flood-opacity="'+o+'" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="'+r+'"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="'+n+'"/> \n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    ')},blur:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.x)?e.x:2,n=(0,i.isFinite)(e.y)?[t,e.y]:t;return(0,i.trim)('\n      <filter>\n        <feGaussianBlur stdDeviation="'+n+'"/>\n      </filter>\n    ')},dropShadow:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.dx||0,n=e.dy||0,r=e.color||"black",o=(0,i.isFinite)(e.blur)?e.blur:4,a=(0,i.isFinite)(e.opacity)?e.opacity:1,s="SVGFEDropShadowElement"in window?'<filter>\n           <feDropShadow stdDeviation="'+o+'" dx="'+t+'" dy="'+n+'" flood-color="'+r+'" flood-opacity="'+a+'" />\n         </filter>':'<filter>\n           <feGaussianBlur in="SourceAlpha" stdDeviation="'+o+'" />\n           <feOffset dx="'+t+'" dy="'+n+'" result="offsetblur" />\n           <feFlood flood-color="'+r+'" />\n           <feComposite in2="offsetblur" operator="in" />\n           <feComponentTransfer>\n             <feFuncA type="linear" slope="'+a+'" />\n           </feComponentTransfer>\n           <feMerge>\n             <feMergeNode/>\n             <feMergeNode in="SourceGraphic"/>\n           </feMerge>\n         </filter>';return(0,i.trim)(s)},grayScale:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1,n=.2126+.7874*(1-t),r=.7152-.7152*(1-t),o=.0722-.0722*(1-t),a=.2126-.2126*(1-t),s=.7152+.2848*(1-t),l=.0722-.0722*(1-t),u=.2126-.2126*(1-t),c=.0722+.9278*(1-t);return(0,i.trim)('\n      <filter>\n        <feColorMatrix type="matrix" values="'+n+" "+r+" "+o+" 0 0 "+a+" "+s+" "+l+" 0 0 "+u+" "+r+" "+c+' 0 0 0 0 0 1 0"/>\n      </filter>\n    ')},sepia:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1,n=.393+.607*(1-t),r=.769-.769*(1-t),o=.189-.189*(1-t),a=.349-.349*(1-t),s=.686+.314*(1-t),l=.168-.168*(1-t),u=.272-.272*(1-t),c=.534-.534*(1-t),h=.131+.869*(1-t);return(0,i.trim)('\n      <filter>\n        <feColorMatrix type="matrix" values="'+n+" "+r+" "+o+" 0 0 "+a+" "+s+" "+l+" 0 0 "+u+" "+c+" "+h+' 0 0 0 0 0 1 0"/>\n      </filter>\n    ')},saturate:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1;return(0,i.trim)('\n      <filter>\n        <feColorMatrix type="saturate" values="'+(1-t)+'"/>\n      </filter>\n    ')},hueRotate:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.angle||0;return(0,i.trim)('\n      <filter>\n        <feColorMatrix type="hueRotate" values="'+t+'"/>\n      </filter>\n    ')},invert:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1,n=1-t;return(0,i.trim)('\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="'+t+" "+n+'"/>\n          <feFuncG type="table" tableValues="'+t+" "+n+'"/>\n          <feFuncB type="table" tableValues="'+t+" "+n+'"/>\n        </feComponentTransfer>\n      </filter>\n    ')},brightness:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1;return(0,i.trim)('\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="linear" slope="'+t+'"/>\n          <feFuncG type="linear" slope="'+t+'"/>\n          <feFuncB type="linear" slope="'+t+'"/>\n        </feComponentTransfer>\n      </filter>\n    ')},contrast:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=(0,i.isFinite)(e.amount)?e.amount:1,n=.5-t/2;return(0,i.trim)('\n      <filter>\n       <feComponentTransfer>\n          <feFuncR type="linear" slope="'+t+'" intercept="'+n+'"/>\n          <feFuncG type="linear" slope="'+t+'" intercept="'+n+'"/>\n          <feFuncB type="linear" slope="'+t+'" intercept="'+n+'"/>\n        </feComponentTransfer>\n      </filter>\n    ')}}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),s=i(a),l=function(){function e(t,n){r(this,e),this.cell=n,this.paper=t,this.invalid=!0,this.ensureElement(),this.setup()}return o(e,[{key:"ensureElement",value:function(){return this}},{key:"setup",value:function(){return this}},{key:"render",value:function(){return this}},{key:"update",value:function(){return this}},{key:"compileMarkup",value:function(e,t){return s.isFunction(e)?e(t):s.format(e,t)}},{key:"getCell",value:function(){return this.cell}},{key:"getPaper",value:function(){return this.paper}},{key:"getModel",value:function(){return this.paper&&this.paper.getModel()}},{key:"getPane",value:function(){var e=void 0,t=this.cell.metadata.pane;return t&&(s.isString(t)?e=this.paper[t]:s.isNode(t)&&(e=t)),e||this.paper.drawPane}},{key:"destroy",value:function(){s.removeElement(this.elem),s.destroy(this)}}]),e}();t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function b(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:b(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},c=n(3),h=r(c),f=n(18),d=i(f),p=n(26),v=i(p),y={content:".pane-node-content",name:".name",portList:".pane-port-list",inPortList:".pane-port-list.in",outPortList:".pane-port-list.out",portWrap:".pane-port-wrap",portItem:".pane-port",portMagnet:".port-magnet",portAdsorb:".is-adsorbed"},g={portItem:"pane-port",inPortList:"pane-port-list in",outPortList:"pane-port-list out",connected:"is-connected",connecting:"is-connecting",connectable:"is-connectable",
adsorbed:"is-adsorbed",bulb:"pane-node-bulb",recommending:"recommending",recommendable:"recommendable"},m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"renderMarkup",value:function(){return u(Object.getPrototypeOf(t.prototype),"renderMarkup",this).call(this),this.renderPorts(!0),this.renderPorts(!1),this}},{key:"renderPorts",value:function(e){var t=this,n=this.getCell(),i=n.getVisiblePorts(e),r=i.length;if(r){var o=this.getPortListVel(e);o&&!function(){var e=n.getPortMarkup(),a=h.map(i,function(t){return this.compileMarkup(e,t)},t).join("");o.html(a),h.forEach(o.find(y.portWrap),function(e){e.css({width:h.toPercentage(1/(r+1),2)})})}()}return this}},{key:"setNodeName",value:function(e){var t=this.getCell();t.data&&(t.data.name=e);var n=this.findOne(y.name);return n&&(n.empty(),n.append(document.createTextNode(e))),this}},{key:"setPortConnected",value:function(e,t,n){var i=this.getPortVel(e,t);i&&i.toggleClass(g.connected,n)}},{key:"setPortConnecting",value:function(e,t,n){var i=this.getPortVel(e,t);i&&i.toggleClass(g.connecting,n)}},{key:"setPortHighlight",value:function(e,t,n){var i=this.getPortVel(e,t);i&&i.toggleClass(g.connectable,n);var r=this.findOne(y.content);r&&r.toggleClass(g.connectable,n)}},{key:"setPortAdsorbed",value:function(e,t,n){var i=this,r=this.getPortVel(e,t);r&&!function(){var e=r.findOne(y.portMagnet);if(e&&e.toggleClass(g.adsorbed,n),n){var o=i.getPortSelector(t)+" "+y.portAdsorb;h.forEach(i.find(o),function(t){e&&t.node===e.node||t.removeClass(g.adsorbed)})}}()}},{key:"setRecommendable",value:function(e){this.vel.toggleClass(g.recommendable,e)}},{key:"setRecommending",value:function(e){this.vel.toggleClass(g.recommending,e)}},{key:"getBBox",value:function(){var e=h.getBounds(this.elem);return e?new d["default"](e.left,e.top,e.width,e.height):null}},{key:"getStrokedBBox",value:function(){var e=this.cell.getBBox(),t=0,n=this.findOne(y.content);return n&&(t=h.getComputedStyle(n.node,"border-width")-1),t?e.grow(t/2):e}},{key:"getPortBodyBBox",value:function(e,t){var n=this.getPortElem(e,t);if(n){var i=this.getBounds(n);return this.getPaper().toLocalRect({x:i.left,y:i.top,width:i.width,height:i.height})}return null}},{key:"getPortSelector",value:function(e,t){var n=this.getPortListSelector(e)+" "+y.portItem;return t&&(n+='[data-id="'+t.id+'"]'),n}},{key:"getPortListSelector",value:function(e){return e?y.inPortList:y.outPortList}},{key:"getPortListVel",value:function(e){return this.findOne(this.getPortListSelector(e))}},{key:"getPortsVel",value:function(e){return this.find(this.getPortSelector(e))}},{key:"getPortVel",value:function(e,t){var n=this.getCell();h.isObject(e)||(e=n.getPortById(e));var i=this.getPortSelector(t,e);return i?this.findOne(i):null}},{key:"getPortElem",value:function(e,t){var n=this.getPortVel(e,t);return n?n.node:null}},{key:"findPortElem",value:function(e){for(;e&&e!==this.elem;){if(h.hasClass(e,g.portItem))return e;e=e.parentNode}return null}},{key:"isPortElem",value:function(e){return!!this.findPortElem(e)}},{key:"isOutPortElem",value:function(e){for(e=this.findPortElem(e);e&&e!==this.elem;){if(h.hasClass(e,g.outPortList))return!0;e=e.parentNode}return!1}},{key:"isInPortElem",value:function(e){for(e=this.findPortElem(e);e&&e!==this.elem;){if(h.hasClass(e,g.inPortList))return!0;e=e.parentNode}return!1}},{key:"isBulbElem",value:function(e){for(;e&&e!==this.elem;){if(h.hasClass(e,g.bulb))return!0;e=e.parentNode}return!1}},{key:"findPortByElem",value:function(e){var t=this,n=null,i=e&&this.findPortElem(e);return i&&!function(){var e=t.isOutPortElem(i)?t.cell.getOutPorts():t.cell.getInPorts(),r=i.getAttribute("data-id");h.some(e,function(e){return h.toString(e.id)===r?(n=e,!0):!1})}(),n}}]),t}(v["default"]);t["default"]=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(19),p=i(d),v=n(27),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup().update(),this}},{key:"update",value:function(){return this.cache={},this.parseConnector().parseTerminal(!0).parseTerminal(!1).updateMarker().updateConnector().updateComment()}},{key:"parseConnector",value:function(){var e=this.cell,t=e.getConnector(),n=e.getMarker(!0),i=e.getMarker(!1),r=this.getStrokeWidth(t.selector),o=this.getStrokeWidth(n.selector),a=this.getStrokeWidth(i.selector),s=n.options;s||(s=n.options={}),s.connectorStrokeWidth=r,s.markerStrokeWidth=o;var l=i.options;return l||(l=i.options={}),l.connectorStrokeWidth=r,l.markerStrokeWidth=a,this.cacheConnector(t),this.cacheMarker(n,!0),this.cacheMarker(i,!1),this}},{key:"parseTerminal",value:function(e){var t=this.cell,n=t.getTerminalPoint(e),i=t.getTerminalPort(e),r=t.getTerminalNode(e),o=r&&this.paper.getView(r);return this.cacheStaticConnPoint(n,e),this.cacheTerminalView(o,e),this.cacheTerminalPort(i,e),this}},{key:"updateMarker",value:function(){return this.renderMarker(!0).renderMarker(!1).updateConnectionPoint(!0).updateConnectionPoint(!1).transformMarker(!0).transformMarker(!1).updateConnectionPointOnMarker(!0).updateConnectionPointOnMarker(!1)}},{key:"updateConnector",value:function(){var e=this.fetchConnector(),t=e.parse&&c.isFunction(e.parse)?e.parse:e.name&&this.paper.getConnector(e.name);if(!t||!c.isFunction(t))throw new Error('Unknown connector: "'+e.name+'"');var n=this.getConnectionPoint(!0),i=this.getConnectionPoint(!1);if(n&&i){var r=t.call(this,n,i);this.applyAttr(".connector-wrap",{d:r}),this.applyAttr(e.selector,{d:r})}else this.vel.empty();return this}},{key:"updateComment",value:function(e){var t=this.cell.data,n=this.vel.getBBox(!0),i=this.vel.findOne(".comment-bg"),r=this.vel.findOne(".comment");if(c.isUndefined(e)?e=t?t.comment:"":t&&(t.comment=e),i&&r)if(e){r.text(e);var o=r.attr("transform");o&&r.attr("transform",c.clearTranslate(o));var a=r.getBBox(!0),s=n.x+.5*n.width,l=n.y+.5*n.height;s-=a.width/2,l-=a.height/2,s=c.toFixed(s,2),l=c.toFixed(l,2),r.translate(s,l),i.attr({width:a.width+10,height:a.height+10}),i.translate(s-5,l-5)}else i.attr({width:"",height:"",transform:""}),r.attr({y:"",transform:""}),r.empty();return this}},{key:"renderMarker",value:function(e){var t=this.fetchMarker(e),n=this.findOne(t.selector);if(t&&n){var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getMarker(t.name);if(i&&c.isFunction(i)){var r=i(n,t.options),o=r.vel;if(o){var a=n.node,s=a.parentNode,l=n.getClassName();s.insertBefore(o.node,a),s.removeChild(a),o.addClass(l),n=o}this.cacheMarkerVel(n,e),this.cacheRenderedMarker(r,e)}}return this}},{key:"updateConnectionPoint",value:function(e){var t=this.fetchStaticConnPoint(e);return t||this.updateConnPointOnPort(e)||this.updateConnPointOnNode(e),this}},{key:"updateConnPointOnPort",value:function(e){var t=this.getPortBodyBBox(e);if(t){var n=new p["default"](t.getCenter().x,e?t.y+t.height:t.y);this.cacheConnPointOnPort(n,e)}return this.fetchConnPointOnPort(e)}},{key:"updateConnPointOnNode",value:function(e){var t=null,n=this.getTerminalBBox(e);if(n){var i=this.getReferencePoint(n,e);i&&(t=n.intersectionWithLineFromCenterToPoint(i)),t=t||n.getCenter(),this.cacheConnPointOnNode(t,e)}return this.fetchConnPointOnNode(e)}},{key:"getStrokeWidth",value:function(e){var t=this.findOne(e);if(t&&t.node){var n=c.getComputedStyle(t.node,"stroke-width");return n&&c.toFloat(n)||0}return 0}},{key:"getTerminalBBox",value:function(e){var t=this.fetchTerminalBBox(e);if(!t){var n=this.fetchTerminalView(e);n&&(t=n.getStrokedBBox(),t=this.fixStrokedBBox(t,e)),this.cacheTerminalBBox(t,e)}return t}},{key:"fixStrokedBBox",value:function(e,t){if(e){var n=this.fetchMarker(t),i=this.fetchRenderedMarker(t);if(n&&i){var r=n.options.markerStrokeWidth;if(r){var o=i.rad||0;o>=Math.PI/4||0===o?e.grow(r/2):e.grow(r/Math.sin(o)/2)}}}return e}},{key:"getReferencePoint",value:function(e,t){var n=this.fetchStaticConnPoint(t);if(!n){var i=this.getPortBodyBBox(!t);i&&(n=i.intersectionWithLineFromCenterToPoint(e.getCenter()),n=n||i.getCenter())}if(!n){var r=this.getTerminalBBox(!t);r&&(n=r.intersectionWithLineFromCenterToPoint(e.getCenter()),n=n||r.getCenter())}return n}},{key:"getPortBodyBBox",value:function(e){var t=this.fetchPortBodyBBox(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyBBox&&(t=n.getPortBodyBBox(i,!e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyBBox(t,e)))}return t}},{key:"getConnectionPoint",value:function(e){var t=this.fetchConnPointOnMarker(e)||this.fetchStaticConnPoint(e)||this.fetchConnPointOnPort(e)||this.fetchConnPointOnNode(e);return t}},{key:"transformMarker",value:function(e){var t=this.fetchRenderedMarker(e);if(t){var n=this.getPane(),i=this.fetchMarkerVel(e),r=this.getConnectionPoint(e),o=new p["default"](r.x,r.y+(e?50:-50));r&&o&&i&&i.translateAndAutoOrient(r,o,n)}return this}},{key:"updateConnectionPointOnMarker",value:function(e){var t=this.fetchMarkerVel(e),n=this.fetchRenderedMarker(e);if(t&&n){var i=this.getPane(),r=n.point,o=f["default"].createSVGPoint(r.x,r.y);o=o.matrixTransform(t.getTransformToElement(i));var a=p["default"].fromPoint(o);this.cacheConnPointOnMarker(a,e)}return this}},{key:"cacheConnector",value:function(e){this.cache.connector=e}},{key:"fetchConnector",value:function(){return this.cache.connector}},{key:"cacheMarker",value:function(e,t){t?this.cache.sourceMarker=e:this.cache.targetMarker=e}},{key:"fetchMarker",value:function(e){return e?this.cache.sourceMarker:this.cache.targetMarker}},{key:"cacheRenderedMarker",value:function(e,t){e&&(t?this.cache.renderedSourceMarker=e:this.cache.renderedTargetMarker=e)}},{key:"fetchRenderedMarker",value:function(e){return e?this.cache.renderedSourceMarker:this.cache.renderedTargetMarker}},{key:"cacheMarkerVel",value:function(e,t){e&&(t?this.cache.sourceMarkerVel=e:this.cache.targetMarkerVel=e)}},{key:"fetchMarkerVel",value:function(e){return e?this.cache.sourceMarkerVel:this.cache.targetMarkerVel}},{key:"cacheTerminalView",value:function(e,t){e&&(t?this.cache.sourceView=e:this.cache.targetView=e)}},{key:"fetchTerminalView",value:function(e){return e?this.cache.sourceView:this.cache.targetView}},{key:"cacheTerminalPort",value:function(e,t){c.isNil(e)||(t?this.cache.sourcePort=e:this.cache.targetPort=e)}},{key:"fetchTerminalPort",value:function(e){return e?this.cache.sourcePort:this.cache.targetPort}},{key:"cacheStaticConnPoint",value:function(e,t){e&&(t?this.cache.staticSourcePoint=e:this.cache.staticTargetPoint=e)}},{key:"fetchStaticConnPoint",value:function(e){return e?this.cache.staticSourcePoint:this.cache.staticTargetPoint}},{key:"cacheConnPointOnMarker",value:function(e,t){e&&(t?this.cache.sourcePointOnMarker=e:this.cache.targetPointOnMarker=e)}},{key:"fetchConnPointOnMarker",value:function(e){return e?this.cache.sourcePointOnMarker:this.cache.targetPointOnMarker}},{key:"cacheConnPointOnPort",value:function(e,t){e&&(t?this.cache.sourcePointOnPort=e:this.cache.targetPointOnPort=e)}},{key:"fetchConnPointOnPort",value:function(e){return e?this.cache.sourcePointOnPort:this.cache.targetPointOnPort}},{key:"cacheConnPointOnNode",value:function(e,t){e&&(t?this.cache.sourcePointOnTerminal=e:this.cache.targetPointOnTerminal=e)}},{key:"fetchConnPointOnNode",value:function(e){return e?this.cache.sourcePointOnTerminal:this.cache.targetPointOnTerminal}},{key:"cacheTerminalBBox",value:function(e,t){e&&(t?this.cache.sourceTerminalBBox=e:this.cache.targetTerminalBBox=e)}},{key:"fetchTerminalBBox",value:function(e){return e?this.cache.sourceTerminalBBox:this.cache.targetTerminalBBox}},{key:"cachePortBodyBBox",value:function(e,t){e&&(t?this.cache.sourcePortBBox=e:this.cache.targetPortBBox=e)}},{key:"fetchPortBodyBBox",value:function(e){return e?this.cache.sourcePortBBox:this.cache.targetPortBBox}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function b(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:b(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},c=n(3),h=r(c),f=n(18),d=i(f),p=n(17),v=i(p),y=n(33),g=i(y),m=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"isGroup",value:function(){return!0}},{key:"getBBox",value:function(){var e=this.getSize(),t=this.getPosition();return new d["default"](t.x,t.y,e.width,e.height)}},{key:"getCollapsedSize",value:function(){return{width:180,height:30}}},{key:"getFullBBox",value:function(){var e=null;return h.forEach(this.getNodes(),function(t){var n=t.getBBox();n&&(e=e?e.union(n):n)}),e}},{key:"getSize",value:function(){return this.metadata.size}},{key:"getPosition",value:function(){return this.metadata.position}},{key:"getBBoxByStatus",value:function(e){var t=this.getFullBBox(),n=this.getCollapsedSize();return t?e?(t.x+=t.width+20-180,t.y-=35,t.width=n.width,t.height=n.height):(t.x-=35,t.y-=35,t.width+=70,t.height+=55):t={x:0,y:0,width:n.width,height:n.height},t}},{key:"updateGeometry",value:function(e){var t=this.getBBoxByStatus(this.isCollapsed());return this.setGeometry({size:{width:t.width,height:t.height},position:{x:t.x,y:t.y}},{silent:e}),this}},{key:"getNodes",value:function(){return this.children||[]}},{key:"addNodes",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return h.isArray(t)||(t=[t]),t.length&&!function(){var n=e.isCollapsed();if(h.forEach(t,function(e){e&&e.isNode()&&this.insertChild(e),n&&e.setVisible(!1)},e),n){var i=e.getChangedLink(t);e.updateLinks(i,n),e.changedLinks?e.changedLinks.concat(i):e.changedLinks=i}e.updateGeometry(!0)}(),this}},{key:"removeNodes",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments[1];return h.isArray(t)||(t=[t]),t.length&&!function(){var i=[],r=e.isCollapsed(),o=0;h.some(n.getChildren(),function(e,t){if(e.isGroup&&e.isGroup())o=t;else if(e.isNode())return o+=1,!0;return!1}),h.forEach(t.slice(0),function(t){e.isInGroup(t)&&(h.forEach(e.changedLinks,function(e){e.terminal.node===t&&i.push(e)}),n&&(r&&t.setVisible(!0),n.insertChild(t,o)))}),e.updateLinks(i,!1),e.updateGeometry(!0)}(),this}},{key:"getRenderData",value:function(){var e=u(Object.getPrototypeOf(t.prototype),"getRenderData",this).call(this);return h.merge({},e,{size:this.metadata.size,position:this.metadata.position,collapsed:this.isCollapsed()})}},{key:"isInGroup",value:function(e){return h.some(this.getNodes(),function(t){return e===t})}},{key:"getChangedLink",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=[];return h.forEach(e,function(e){e.eachLink(function(n){var i=n.getTerminalNode(!0),r=n.getTerminalNode(!1),o=i===e?r:i,a=o===r;this.isInGroup(o)||t.push({link:n,terminal:n.getTerminal(a),isSource:a})},this)},this),t}},{key:"updateLinks",value:function(e,t){h.forEach(e,function(e){e.link.setTerminalNode(t?this:e.terminal,e.isSource),e.isSource||(e.link.metadata.targetMarker=t?"block":null)},this)}},{key:"_setCollapsed",value:function(e){return u(Object.getPrototypeOf(t.prototype),"_setCollapsed",this).call(this,e),this.updateGeometry(!0),h.forEach(this.getNodes(),function(t){t.setVisible(!e)}),e&&(this.changedLinks=this.getChangedLink(this.getNodes())),this.updateLinks(this.changedLinks,this.isCollapsed()),this}}]),t}(v["default"]);m.setDefaults({tagName:"g",pane:"backgroundPane",classNames:"pane-group",view:g["default"]}),t["default"]=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(29),p=i(d),v=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){return this.renderMarkup(),this.scalableNode=this.findOne(".pane-scalable"),this.resize().translate(),this}},{key:"ensureElement",value:function(){this.vel=(0,f["default"])(this.cell.getTagName(),{"class":this.cell.getClassName()}),this.elem=this.vel.node,this.elem.cellId=this.cell.id;var e=this.getPane();return e&&e.appendChild(this.elem),this}},{key:"setup",value:function(){var e=this;return c.addEventListener(this.elem,"mousedown",".btn-toggle",function(e){e.stopPropagation()}),c.addEventListener(this.elem,"click",".btn-toggle",function(t){t.stopPropagation(),e.cell.toggleCollapse();var n=e.getPaper();n&&n.trigger("group:collapseChanged",e.cell)}),this}},{key:"renderMarkup",value:function(){var e=this.cell,t=this.compileMarkup(e.getMarkup(),e.getRenderData());return this.elem.innerHTML=t,this}},{key:"find",value:function(e){return"."===e?[this.vel]:this.vel.find(e)}},{key:"findOne",value:function(e){return"."===e?this.vel:this.vel.findOne(e)}},{key:"resize",value:function(){var e=this.scalableNode;if(!e)return this;var t=e.getBBox(!0),n=this.cell.getSize(),i=n.width/(t.width||1),r=n.height/(t.height||1);return i=c.toFixed(i,2),r=c.toFixed(r,2),e.scale(i,r),this}},{key:"translate",value:function(){var e=this.cell.getPosition();return this.vel.translate(e.x,e.y),this}},{key:"setNodeName",value:function(e){var t=this.getCell();t.data&&(t.data.name=e);var n=this.findOne(".name");return n&&(n.empty(),n.append(document.createTextNode(e))),this}},{key:"getStrokeWidth",value:function(){return 1}},{key:"getStrokedBBox",value:function(){var e=this.getStrokeWidth()-1,t=this.getCell().getBBox();return e?t.grow(e/2):t}}]),t}(p["default"]);t["default"]=v},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(18),u=i(l),c=n(17),h=i(c),f=n(35),d=i(f),p=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"isRemark",value:function(){return!0}},{key:"getRemark",value:function(){return this.data.name||""}},{key:"getBBox",value:function(){var e=this.getSize(),t=this.getPosition();return new u["default"](t.x,t.y,e.width,e.height)}},{key:"getMaxSize",value:function(){return{width:180,height:96}}},{key:"getSize",value:function(){return this.metadata.size||this.getMaxSize()}},{key:"getPosition",value:function(){return this.metadata.position}}]),t}(h["default"]);p.setDefaults({tagName:"g",pane:"decoratePane",classNames:"pane-remark",view:d["default"]}),t["default"]=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(29),p=i(d),v={foreignobject:"foreignobject",content:".pane-remark-content",editor:".pane-remark-editor"},y={editor:"pane-remark-editor","float":"pane-remark-float"},g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){return this.renderMarkup(),this.resize().translate(),this}},{key:"renderMarkup",value:function(){var e=this.cell,t=this.compileMarkup(e.getMarkup(),e.getRenderData());return this.elem.innerHTML=t,this}},{key:"ensureElement",value:function(){this.vel=(0,f["default"])(this.cell.getTagName(),{"class":this.cell.getClassName()}),this.elem=this.vel.node,this.elem.cellId=this.cell.id;var e=this.getPane();return e&&e.appendChild(this.elem),this}},{key:"setup",value:function(){var e=this;return c.addEventListener(this.elem,"dblclick",v.content,function(t){t.stopPropagation(),e.editRemark()}),c.addEventListener(this.elem,"mousedown",v.editor,function(e){e.stopPropagation()}),c.addEventListener(this.elem,"keydown",v.editor,function(e){e.stopPropagation()}),this}},{key:"find",value:function(e){return"."===e?[this.vel]:this.vel.find(e)}},{key:"findOne",value:function(e){return"."===e?this.vel:this.vel.findOne(e)}},{key:"resize",value:function(){var e=this.detectContentSize();return this.cell.size=e,this.cell.metadata.size=e,this.setContentSize(e.width,e.height),this}},{key:"translate",value:function(){var e=this.cell.getPosition();return this.vel.translate(e.x,e.y),this}},{key:"editRemark",value:function(){var e=this;if(!this.editing){this.editing=!0;var t=this.cell.getRemark(),n=this.getContentElem();if(this.setContentSize(180,72),n){n.innerHTML='<textarea class="'+y.editor+'">'+t+"</textarea>";var i=n.querySelector(v.editor);i&&(i.focus(),i.select(),c.addEventListener(i,"blur",function(t){t.stopPropagation(),e.saveRemark()}),c.addEventListener(i,"keydown",function(t){t.stopPropagation();var n=t.keyCode;13===n?e.saveRemark():27===n&&e.saveRemark(!0)}))}}}},{key:"saveRemark",value:function(e){if(this.editing){this.editing=!1;var t=this.getContentElem();if(t){var n=t.querySelector(v.editor);if(n){var i=this.cell.getRemark(),r=n.value;if(e?r=i:r?(r=c.escape(r),this.cell.data.name=r):r=i,c.removeElement(n),t.appendChild(document.createTextNode(r)),!e){var o=this.getPaper(),a=this.cell.getSize(),s=this.detectContentSize();if(this.cell.size=s,this.cell.metadata.size=s,this.setContentSize(s.width,s.height),r!==i&&o&&o.trigger("remark:updateName",this.cell,r),a.width!==s.width||a.height!==s.height){var l=(a.width-s.width)/2,u=(a.height-s.height)/2,h=this.cell.getPosition();h.x+=l,h.y+=u,this.cell.position={x:h.x,y:h.y},this.translate(),o&&o.trigger("cells:updatePosition",[this.cell])}}}}}}},{key:"detectContentSize",value:function(){var e=this.cell.getMaxSize(),t=this.cell.getSize();this.vel.addClass(y["float"]),this.setContentSize(e.width,e.height);var n=this.getContentSize();return this.setContentSize(t.width,t.height),this.vel.removeClass(y["float"]),n}},{key:"setContentSize",value:function(e,t){this.findOne(v.foreignobject).attr({width:e,height:t})}},{key:"getContentSize",value:function(){var e=this.getContentElem();return{width:e.offsetWidth||e.clientWidth,height:e.offsetHeight||e.clientHeight}}},{key:"getContentElem",value:function(){return this.elem.querySelector(v.content)}}]),t}(p["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),s=i(a),l={paperScroll:null,distance:0},u=function(){function e(t){r(this,e),t&&this.install(t)}return o(e,[{key:"destroy",value:function(){this.destroyed||(s.removeElement(this.container),s.destroy(this))}},{key:"install",value:function(e){return this.options=s.merge({},l,e),this.paperScroll=this.options.paperScroll,this.paper=this.paperScroll.paper,this.ensureElement(),this}},{key:"ensureElement",value:function(){return this.container=s.createElement("div"),this.paper.wrap.appendChild(this.container),s.addClass(this.container,"pane-navigator"),this}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(3),s=i(a),l={paper:null,distance:0},u=function(){function e(t){r(this,e),t&&this.install(t)}return o(e,[{key:"destroy",value:function(){this.destroyed||(this.hide(),s.destroy(this))}},{key:"install",value:function(e){this.options=s.merge({},l,e),this.paper=this.options.paper,this.ensureElement(),this.paper.on("cells:moving",this.onCellsMoving.bind(this)),this.paper.on("cells:moveEnd",this.onCellsMoveEnd.bind(this))}},{key:"ensureElement",value:function(){return this.hLine=s.createElement("div"),this.vLine=s.createElement("div"),s.addClass(this.hLine,"pane-snapline horizontal"),s.addClass(this.vLine,"pane-snapline vertical"),this}},{key:"onCellsMoving",value:function(e,t){var n=t.getCenter(),i=t.getOrigin(),r=t.getCorner();this.vertical=null,this.horizontal=null,this.hide(),this.paper.eachView(function(e){var o=e.cell;if(o&&o.isNode()){var a=o.getBBox(),s=a.getCenter(),l=a.getOrigin(),u=a.getCorner();this.check(n,s,t,a)||this.check(n,l,t,a)||this.check(n,u,t,a)||this.check(i,l,t,a)||this.check(i,u,t,a)||this.check(r,l,t,a)||this.check(r,u,t,a)}},this),this.show()}},{key:"onCellsMoveEnd",value:function(){this.hide()}},{key:"check",value:function(e,t,n,i){var r=this.options.distance,o=this.vertical,a=this.horizontal,s=e.y-t.y;return Math.abs(s)<=r?(a||(a=this.horizontal={top:t.y,left:n.x,right:n.x+n.width}),a.left=Math.min(a.left,n.x,i.x),a.right=Math.max(a.right,n.x+n.width,i.x+i.width),!0):(s=e.x-t.x,Math.abs(s)<=r?(o||(o=this.vertical={left:t.x,top:n.y,bottom:n.y+n.height}),o.top=Math.min(o.top,n.y,i.y),o.bottom=Math.max(o.bottom,n.y+n.height,i.y+i.height),!0):!1)}},{key:"hide",value:function(){return s.removeElement(this.hLine),s.removeElement(this.vLine),this}},{key:"show",value:function(){var e=this.paper,t=e.rawPane,n=e.sx,i=e.sy,r=e.tx,o=e.ty,a=this.vertical,l=this.horizontal;a&&(s.setStyle(this.vLine,{left:Math.round(a.left*n+r)+"px",top:Math.round(a.top*i+o)+"px",height:Math.round((a.bottom-a.top)*i)+"px"}),t.appendChild(this.vLine)),l&&(s.setStyle(this.hLine,{left:Math.round(l.left*n+r)+"px",top:Math.round(l.top*i+o)+"px",width:Math.round((l.right-l.left)*n)+"px"}),t.appendChild(this.hLine))}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),l=r(s),u=n(13),c=i(u),h={paper:null,space:50,minWidth:0,minHeight:0},f=function(){function e(t){o(this,e),t&&this.install(t)}return a(e,[{key:"destroy",value:function(){this.destroyed||(l.removeElement(this.scrollElem),l.destroy(this))}},{key:"install",value:function(e){this.options=l.merge({},h,e),this.space=l.normalizeSides(this.options.space),this.paper=this.options.paper;var t=this.paper;this.sx=t.sx,this.sy=t.sy,this.baseWidth=t.width,this.baseHeight=t.height,this.scrollLeft=0,this.scrollTop=0,this.stageLevel=0,this.stageScrollLeft=0,this.stageScrollTop=0,t.on("paper:scale",this.doScale,this),
t.on("paper:resize",this.doResize,this),this.ensureElement(),this.addScrollEvent(),this.doResize(),this.adjustClientSize(),this.adjustPadding(),this.center()}},{key:"ensureElement",value:function(){var e=this.paper,t=l.createElement("div");return this.scrollElem=t,this.scrollParent=e.getWrap(),l.addClass(t,"pane-scroll"),this.scrollElem.appendChild(e.getStage()),this.scrollParent.appendChild(t),this}},{key:"addScrollEvent",value:function(){var e=this;return this.onScroll||!function(){var t=e;t.onScroll=function(){t.setScroll(t.scrollParent.scrollLeft,t.scrollParent.scrollTop)}}(),l.addEventListener(this.scrollParent,"scroll",this.onScroll),this}},{key:"removeScrollEvent",value:function(){return l.removeEventListener(this.scrollParent,"scroll",this.onScroll),this}},{key:"adjustClientSize",value:function(){var e=l.getScrollBarWidth();return this.clientWidth=this.scrollParent.clientWidth-e,this.clientHeight=this.scrollParent.clientHeight-e,this}},{key:"adjustPadding",value:function(e){if(e)e=l.normalizeSides(e);else{var t=this.space,n=this.clientWidth,i=this.clientHeight;e={top:i-t.top,right:n-t.right,bottom:i-t.bottom,left:n-t.left}}return this.padding=e,l.setStyle(this.scrollElem,{paddingTop:e.top+"px",paddingRight:e.right+"px",paddingBottom:e.bottom+"px",paddingLeft:e.left+"px"}),this}},{key:"adjustPaper",value:function(){var e=this.paper,t=e.sx,n=e.sy,i={frameWidth:this.baseWidth*t,frameHeight:this.baseHeight*n};this.options.minWidth&&(i.minWidth=this.options.minWidth*t),this.options.minHeight&&(i.minHeight=this.options.minHeight*n);var r=e.tx,o=e.ty;if(e.fitToContent(i)){var a=e.tx-r,s=e.ty-o;0===a&&0===s||(this.increaseStage(),this.stageScroll(a,s,{relative:!0}),this.decreaseStage())}return this}},{key:"doScale",value:function(e,t,n,i){return this.sx=e,this.sy=t,this.adjustPaper(),(n||i)&&this.center(n,i),this}},{key:"doResize",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.baseWidth:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.baseHeight:arguments[1];return l.setStyle(this.scrollElem,{width:e+"px",height:t+"px"}),this}},{key:"applyScroll",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.stageScrollLeft:arguments[0],t=arguments.length<=1||void 0===arguments[1]?this.stageScrollTop:arguments[1];return this.removeScrollEvent(),this.scrollParent.scrollLeft=e,this.scrollParent.scrollTop=t,this.setScroll(this.stageScrollLeft,this.stageScrollTop),this.addScrollEvent(),this}},{key:"setScroll",value:function(e,t){return this.scrollLeft=e,this.scrollTop=t,this}},{key:"stageScroll",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return n.relative?(this.stageScrollLeft+=e,this.stageScrollTop+=t):(this.stageScrollLeft=e,this.stageScrollTop=t),this}},{key:"increaseStage",value:function(){return this.stageLevel+=1,1===this.stageLevel&&(this.stageScrollLeft=this.scrollLeft,this.stageScrollTop=this.scrollTop),this}},{key:"decreaseStage",value:function(){return this.stageLevel-=1,0===this.stageLevel&&(this.applyScroll(),this.stageScrollLeft=0,this.stageScrollTop=0),this}},{key:"center",value:function(e,t){var n=this.paper,i=n.tx,r=n.ty;if(l.isUndefined(e)||l.isUndefined(t)){var o=-i,a=-r,s=o+n.width,u=a+n.height;e=(o+s)/2,t=(a+u)/2}else e*=n.sx,t*=n.sy;var c=this.clientWidth/2-(e+i+this.padding.left-this.scrollLeft),h=this.clientHeight/2-(t+r+this.padding.top-this.scrollTop);return this.increaseStage(),this.stageScroll(-c,-h,{relative:!0}),this.decreaseStage(),this}},{key:"centerContent",value:function(){var e=this.paper.getContentBBox(!0);return this.center(e.x+e.width/2,e.y+e.height/2),this}},{key:"toLocalPoint",value:function(e,t){var n=this.paper,i=this.padding;return e+=this.scrollLeft-i.left-n.tx,e/=n.sx,t+=this.scrollTop-i.top-n.ty,t/=n.sy,{x:Math.round(e),y:Math.round(t)}}},{key:"getCenter",value:function(){return this.toLocalPoint(this.clientWidth/2,this.clientHeight/2)}},{key:"beforeZoom",value:function(){return c["default"].IS_IE&&l.setStyle(this.elem,"visibility","hidden"),this}},{key:"afterZoom",value:function(){return c["default"].IS_IE&&l.setStyle(this.elem,"visibility",""),this}},{key:"zoom",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=e,i=e;t.absolute||(n+=this.sx,i+=this.sy);var r=t.scaleGrid;r&&(n=l.snapToGrid(n,r),i=l.snapToGrid(i,r));var o=t.minScale,a=t.maxScale;n=l.clamp(n,o||0,a||Number.MAX_VALUE),i=l.clamp(i,o||0,a||Number.MAX_VALUE);var s=t.cx,u=t.cy;if(l.isUndefined(s)||l.isUndefined(u)){var c=this.getCenter();s=c.x,u=c.y}var h=s*(n-this.sx),f=u*(i-this.sy);return this.beforeZoom(),this.increaseStage(),this.paper.scale(n,i),this.stageScroll(h,f,{relative:!0}),this.decreaseStage(),this.afterZoom(),this}},{key:"zoomToFit",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.paper,n=t.tx,i=t.ty,r=this.scrollParent.clientWidth,o=this.scrollParent.clientHeight;return e.fittingBBox=e.fittingBBox||{x:n,y:i,width:r,height:o},this.beforeZoom(),t.scaleContentToFit(e),t.translate(n,i),this.adjustPaper(),this.centerContent(),this.afterZoom(),this}}]),e}();t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(40),u=i(l),c=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"isGroup",value:function(e){return e&&e.isGroup&&e.isGroup()}},{key:"isRemark",value:function(e){return e&&e.isRemark&&e.isRemark()}},{key:"isNode",value:function(e){return e&&e.isNode()}},{key:"isLink",value:function(e){return e&&e.isLink()}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(41),f=i(h),d=function(e){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];o(this,t);var i=a(this,Object.getPrototypeOf(t).call(this));return i.paper=e,i.disabled=!1,i.configure(n).init(),i}return s(t,e),l(t,[{key:"configure",value:function(){return this}},{key:"init",value:function(){return this}},{key:"destroy",value:function(){c.destroy(this)}},{key:"getPaper",value:function(){return this.paper}},{key:"getModel",value:function(){return this.paper&&this.paper.model}},{key:"isDisabled",value:function(){return this.disabled===!0}},{key:"isEnabled",value:function(){return this.disabled===!1}},{key:"disable",value:function(){return this.disabled=!0,this.trigger("handler:disabled"),this}},{key:"enable",value:function(){return this.disabled=!1,this.trigger("handler:enabled"),this}},{key:"invoke",value:function(e,t){return this.isDisabled()||e.call(t),this}}]),t}(f["default"]);t["default"]=d},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){for(var i=!0,r=0,o=e.length;o>r;r+=2)i=l.invoke(e[r],t,e[r+1]||n)!==!1&&i;return i}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),l=i(s),u=function(){function e(){r(this,e)}return a(e,[{key:"on",value:function(e,t,n){if(!t)return this;var i=this.__events||(this.__events={});return l.forEach(l.split(e),function(e){var r=i[e]||(i[e]=[]);r.push(t,n)}),this}},{key:"once",value:function(e,t,n){var i=this,r=function o(){i.off(e,o);for(var r=arguments.length,a=Array(r),s=0;r>s;s++)a[s]=arguments[s];t.apply(n||i,a)};return this.on(e,r,n)}},{key:"off",value:function(e,t,n){var i=this.__events;return i?e||t||n?(e=e?l.split(e):l.keys(i),l.forEach(e,function(e){var r=i[e];if(r){if(!t&&!n)return void delete i[e];for(var o=r.length-2;o>=0;o-=2)t&&r[o]!==t||n&&r[o+1]!==n||r.splice(o,2)}}),this):(delete this.__events,this):this}},{key:"trigger",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];var r=this.__events;if(!r||!e)return null;var a=!0,s=r["*"];return l.forEach(l.split(e),function(e){var t=void 0;"*"!==e&&(t=r[e],t&&(a=o(t,n,this)&&a)),s&&(a=o(s,[e].concat(n),this)&&a)},this),a}}]),e}();t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function w(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:w(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},h=n(3),f=r(h),d=n(18),p=i(d),v=n(39),y=i(v),g={multi:!0,movement:!0,areaSelect:!0,areaSelectKey:"shift",scrollDelay:40,scrollSense:18},m={previewRect:"pane-selection-preview",selectionRect:"pane-selection-rect",cursorMove:"pane-cursor-move",cursorMoving:"pane-cursor-moving",cursorCross:"pane-cursor-cross"},b=f.getScrollBarWidth(),k=function(e){function t(){return a(this,t),s(this,Object.getPrototypeOf(t).apply(this,arguments))}return l(t,e),u(t,[{key:"configure",value:function(e){return this.options=f.merge({},g,e),this.scrollParent=f.getScrollParent(this.getPaper().svg),this}},{key:"init",value:function(){return this.previewRect=f.createElement("div"),this.selectionRect=f.createElement("div"),f.addClass(this.previewRect,m.previewRect),f.addClass(this.selectionRect,m.selectionRect),this.focusedCell=null,this.movingCells=[],this.selectedCells=[],this.origin=null,this.bounds=null,this.getPaper().on("cell:pointerDown",this.onCellMouseDown.bind(this)).on("cell:contextmenu",this.onCellContextMenu.bind(this)).on("blank:pointerDown",this.onBlankMouseDown.bind(this)).on("blank:pointerMove",this.onBlankMouseMove.bind(this)).on("blank:pointerUp",this.onBlankMouseUp.bind(this)),this.nodeMouseUpHandler=this.onCellMouseUp.bind(this),this.nodeMouseMoveHandler=this.onCellMouseMove.bind(this),this.keyUpHandler=this.onKeyUp.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),f.addEventListener(document.body,"keydown",this.keyDownHandler),f.addEventListener(document.body,"keyup",this.keyUpHandler),this.switchMode(!1),this}},{key:"destroy",value:function(){f.removeEventListener(document.body,"keydown",this.keyDownHandler),f.removeEventListener(document.body,"keyup",this.keyUpHandler),c(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"switchMode",value:function(e){return this.isSelectMode=e===!0,this.switchModeClass(this.isSelectMode),this}},{key:"switchModeClass",value:function(e){var t=this.getPaper().getWrap();return this.setCursorStyle(t,e),this}},{key:"setCursorStyle",value:function(e,t){return f.removeClass(e,m.cursorMove),f.removeClass(e,m.cursorCross),t===!0?f.addClass(e,m.cursorCross):t===!1&&f.addClass(e,m.cursorMove),this}},{key:"onKeyDown",value:function(e){var t=this.options.areaSelectKey;if(this.options.areaSelect&&t){var n="has"+f.ucFirst(t)+"Key";f[n]&&(this.hasAreaSelectKey=f[n](e))}this.hasAreaSelectKey&&!this.isSelectMode&&this.switchModeClass(!0)}},{key:"onKeyUp",value:function(){this.hasAreaSelectKey&&!this.isSelectMode&&(this.switchModeClass(!1),this.hasAreaSelectKey=!1)}},{key:"onCellMouseDown",value:function(e,t,n,i,r){this.isDisabled()||this.isNode(e)&&!this.isGroup(e)&&!this.isRemark(e)&&t.isPortElem(n.target)||t.isBulbElem&&t.isBulbElem(n.target)||(this.moving=!1,this.bounds=null,this.isNode(e)&&(this.lastX=i,this.lastY=r,this.origin={x:i,y:r},this.movingCells=this.isCellSelected(e)?this.selectedCells:[e]),this.getPaper().on("cell:pointerMove",this.nodeMouseMoveHandler).on("cell:pointerUp",this.nodeMouseUpHandler))}},{key:"onCellMouseMove",value:function(e,t,n,i,r){if(!this.isLink(e)&&this.origin){if(!this.moving){var o=this.getPreviewBounds();o&&(this.bounds=o,this.previewOriginX=o.x,this.previewOriginY=o.y,this.updatePreview(!0),this.showPreview()),this.moving=!0}if(this.bounds){this.stopScrollTimer();var a=this.previewOriginX+i-this.origin.x,s=this.previewOriginY+r-this.origin.y,l=this.getScrollBounds(),u=this.getMoveDirection(i,r);this.bounds.x=Math.round(f.clamp(a,l.left,l.right-this.bounds.width)),this.bounds.y=Math.round(f.clamp(s,l.top,l.bottom-this.bounds.height)),this.updatePreview(),this.paper.trigger("cells:moving",this.movingCells,this.bounds),1===this.movingCells.length&&this.paper.trigger("cell:moving",this.movingCells[0],this.bounds),this.autoScrollPreview(u)}}}},{key:"onCellMouseUp",value:function(e,t,n,i,r){var o=0,a=0;this.origin&&(this.hidePreview(),o=i-this.origin.x,a=r-this.origin.y);var s=this.getPaper();if(!this.moving||0===o&&0===a)if(e.isLink())this.clearSelection(),this.setCellFocused(e,t);else{var l=this.options.multi&&f.hasModifierKey(n);this.selectCell(e,t,l),this.notifySelectionChange(),l||this.setCellFocused(e,t)}else o=this.bounds.x-this.previewOriginX,a=this.bounds.y-this.previewOriginY,this.stopScrollTimer(),0===o&&0===a||this.updateNodesPosition(this.movingCells,o,a);this.moving&&(s.trigger("cells:moveEnd",this.movingCells,this.bounds),1===this.movingCells.length&&s.trigger("cell:moveEnd",this.movingCells[0],this.bounds)),this.origin&&s.off("cell:pointerMove",this.nodeMouseMoveHandler).off("cell:pointerUp",this.nodeMouseUpHandler),this.lastX=null,this.lastY=null,this.origin=null,this.bounds=null,this.moving=!1,this.movingCells=null}},{key:"onCellContextMenu",value:function(e,t){!this.isNode(e)||this.isGroup(e)||this.isRemark(e)||this.isCellSelected(e)||this.selectCell(e,t)}},{key:"onBlankMouseDown",value:function(e,t,n){if(!this.isDisabled()&&!this.isOnScrollBar(e)){if(this.isAreaSelect=this.isSelectMode||this.hasAreaSelectKey,this.isMovement=!this.isAreaSelect&&this.options.movement,this.isAreaSelect&&(this.origin={x:t,y:n}),this.isMovement){this.origin={x:e.pageX,y:e.pageY},this.originScrollLeft=this.scrollParent.scrollLeft,this.originScrollTop=this.scrollParent.scrollTop;var i=this.getPaper().getWrap();f.removeClass(i,m.cursorMove),f.addClass(i,m.cursorMoving),f.addClass(document.body,m.cursorMoving)}f.hasModifierKey(e)||this.clearSelection()}}},{key:"onBlankMouseMove",value:function(e,t,n){this.isDisabled()||(this.isAreaSelect?this.onAreaSelect(e,t,n):this.isMovement&&this.onMovement(e,t,n))}},{key:"onAreaSelect",value:function(e,t,n){if(this.moving||(this.setCursorStyle(document.body,!0),this.showSelectionRect(),this.moving=!0),this.moving){var i=this.origin,r=this.getScrollBounds(),o=t,a=n,s=Math.abs(o-i.x),l=Math.abs(a-i.y),u=void 0;o>=i.x?(o=i.x,u=r.right-o,s>u&&(s=Math.round(u))):(u=i.x-r.left,s>u&&(s=Math.round(u),o=Math.round(r.left))),a>=i.y?(a=i.y,u=r.bottom-a,l>u&&(l=Math.round(u))):(u=i.y-r.top,l>u&&(l=Math.round(u),a=Math.round(r.top))),this.bounds={x:o,y:a,width:s,height:l},this.stopScrollTimer(),this.updateSelectionRect(),this.autoScrollSelectionRect(t,n)}}},{key:"onMovement",value:function(e){this.moving||(this.moving=!0);var t=this.origin.x-e.pageX,n=this.origin.y-e.pageY;this.scrollParent.scrollLeft=this.originScrollLeft+t,this.scrollParent.scrollTop=this.originScrollTop+n}},{key:"onBlankMouseUp",value:function(e){if(!this.isDisabled()){if(this.isAreaSelect)f.hasModifierKey(e)||this.clearSelection(),this.moving&&this.bounds&&(this.stopScrollTimer(),this.hideSelectionRect(),this.selectCellsInRect(this.bounds)),this.notifySelectionChange(),this.setCellFocused(null);else if(this.isMovement){this.originScrollLeft=0,this.originScrollTop=0,this.moving||(this.clearSelection(),this.notifySelectionChange(),this.setCellFocused(null));var t=this.getPaper().getWrap();f.addClass(t,m.cursorMove),f.removeClass(t,m.cursorMoving),f.removeClass(document.body,m.cursorMoving)}(this.isAreaSelect||this.isMovement)&&this.setCursorStyle(document.body),this.switchModeClass(!!this.isSelectMode),this.bounds=null,this.origin=null,this.moving=!1,this.isMovement=!1,this.isAreaSelect=!1}}},{key:"getScrollBounds",value:function(e){var t=this.getPaper(),n=this.scrollParent,i=t.stage.parentNode,r=t.sx,o=t.sy,a=n.scrollTop,s=n.scrollLeft,l=n.scrollWidth,u=n.scrollHeight,c=n.clientWidth,h=n.clientHeight,d=f.toInt(i.style.paddingLeft),p=f.toInt(i.style.paddingTop);return e?{left:(s-d-t.tx)/r,top:(a-p-t.ty)/o,right:(c+s-d-t.tx)/r,bottom:(h+a-p-t.ty)/o}:{left:-(d+t.tx)/r,top:-(p+t.ty)/o,right:(l-d-t.tx)/r,bottom:(u-p-t.ty)/o}}},{key:"getMoveDirection",value:function(e,t){var n=e-this.lastX,i=t-this.lastY;this.lastX=e,this.lastY=t;var r=0;return r=Math.abs(n)>Math.abs(i)?n>0?2:4:i>0?3:1}},{key:"stopScrollTimer",value:function(){return this.scrollTimer&&(clearTimeout(this.scrollTimer),this.scrollTimer=0),this}},{key:"getPreviewBounds",value:function(){var e=null;return f.forEach(this.movingCells,function(t){if(t.isNode()){var n=t.getBBox();n&&(e=e?e.union(n):n)}}),e}},{key:"autoScrollPreview",value:function(e){if(this.isParentScrollable()){var t=this.bounds,n=this.getPaper(),i=n.sx,r=n.sy,o=this.scrollParent,a=o.scrollWidth,s=o.scrollHeight,l=o.clientWidth,u=o.clientHeight,c=this.options.scrollSense,h=t.x,f=t.y,d=t.width,p=t.height,v=o.scrollTop,y=o.scrollLeft,g=this.getScrollBounds(),m=this.getScrollBounds(!0),b=m.left,k=m.top,w=m.right-d,P=m.bottom-p,x=!1;4===e&&y>0&&Math.round(h-b)<=0?(x=!0,t.x=Math.round(Math.max(g.left,b-c/i)),y=Math.round(Math.max(0,y-c))):2===e&&a-l>y&&Math.round(h-w)>=0?(x=!0,t.x=Math.round(Math.min(g.right-d,w+c/i)),y=Math.round(Math.min(a-l,y+c))):1===e&&v>0&&Math.round(f-k)<=0?(x=!0,t.y=Math.round(Math.max(g.top,k-c/r)),v=Math.round(Math.max(0,v-c))):3===e&&s-u>v&&Math.round(f-P)>=0&&(x=!0,t.y=Math.round(Math.min(g.bottom-p,P+c/r)),v=Math.round(Math.min(s-u,v+c))),x&&(o.scrollTop=v,o.scrollLeft=y,this.updatePreview(),this.scrollTimer=setTimeout(this.autoScrollPreview.bind(this,e),this.options.scrollDelay))}return this}},{key:"updatePreview",value:function(e){var t=this.bounds;if(t){var n=this.getPaper(),i=this.previewRect,r=Math.round(t.x*n.sx+n.tx),o=Math.round(t.y*n.sy+n.ty);if(f.setTranslate(i,r,o),e){var a=Math.round(t.width*n.sx),s=Math.round(t.height*n.sy);f.setStyle(i,{width:a+"px",height:s+"px"});var l="";1!==this.movingCells.length||this.isGroup(this.movingCells[0])||this.isRemark(this.movingCells[0])||(l=Math.floor(s/2)+"px"),f.setStyle(i,{"border-radius":l})}}return this}},{key:"hidePreview",value:function(){return f.removeElement(this.previewRect),this}},{key:"showPreview",value:function(){var e=this.getPaper();return e&&e.rawPane&&e.rawPane.appendChild(this.previewRect),this}},{key:"hideSelectionRect",value:function(){return f.removeElement(this.selectionRect),this}},{key:"showSelectionRect",value:function(){var e=this.getPaper();return e&&e.rawPane&&e.rawPane.appendChild(this.selectionRect),this}},{key:"updateSelectionRect",value:function(){var e=this.bounds;if(e){var t=this.getPaper(),n=this.selectionRect,i=Math.round(e.x*t.sx+t.tx),r=Math.round(e.y*t.sy+t.ty),o=Math.round(e.width*t.sx),a=Math.round(e.height*t.sy);f.setTranslate(n,i,r),f.setStyle(n,{width:o+"px",height:a+"px"})}return this}},{key:"autoScrollSelectionRect",value:function(e,t){if(this.isParentScrollable()){var n=this.options.scrollSense,i=this.bounds,r=!1,o=this.scrollParent,a=o.scrollWidth,s=o.scrollHeight,l=o.clientWidth,u=o.clientHeight,c=o.scrollTop,h=o.scrollLeft,f=this.getPaper(),d=f.sx,p=f.sy,v=this.getScrollBounds(),y=this.getScrollBounds(!0);h>0&&e<=y.left?(r=!0,e-=n/d,i.x=Math.round(Math.max(v.left,i.x-n/d)),h=Math.round(Math.max(0,h-n))):a-l>h&&e>=y.right?(r=!0,e+=n/d,i.width=Math.round(Math.min(v.right-i.x,i.width+n/d)),h=Math.round(Math.min(a-l,h+n))):c>0&&t<y.top?(r=!0,t-=n/p,i.y=Math.round(Math.max(v.top,i.y-n/p)),c=Math.round(Math.max(0,c-n))):s-u>c&&t>y.bottom&&(r=!0,t+=n/p,i.height=Math.round(Math.min(v.bottom-i.y,i.height+n/p)),c=Math.round(Math.min(s-u,c+n))),r&&(o.scrollTop=c,o.scrollLeft=h,this.updateSelectionRect(),this.scrollTimer=setTimeout(this.autoScrollSelectionRect.bind(this,e,t),this.options.scrollDelay))}return this}},{key:"selectCellsInRect",value:function(e){var t=this.getModel(),n=t&&t.findCellInArea(p["default"].fromRect(e));return this.selectCells(n),this}},{key:"selectCells",value:function(e){return e&&e.length&&f.forEach(e,function(e){this.setSelected(e,this.paper.getView(e),!0)},this),this}},{key:"selectCell",value:function(e,t,n){return n?this.setSelected(e,t,!e.selected):this.clearSelection().setSelected(e,t,!0),this}},{key:"isCellSelected",value:function(e){return e.selected===!0}},{key:"setSelected",value:function(e,t,n){return n=!!n,n!==e.selected&&(e.selected=n,n?this.selectedCells.push(e):(f.contains(this.selectedCells,e)&&this.selectedCells.splice(f.indexOf(this.selectedCells,e),1),e.selected=!1),f.toggleClass(t.elem,"selected",e.selected)),this}},{key:"clearSelection",value:function(){var e=this.getPaper();return f.forEach(this.selectedCells,function(t){var n=e.getView(t);n&&f.removeClass(n.elem,"selected"),t.selected=!1}),this.selectedCells=[],this}},{key:"setCellFocused",value:function(e,t){if(this.focusedCell!==e){if(this.focusedCell){var n=this.getPaper().getView(this.focusedCell);n&&f.removeClass(n.elem,"focused"),this.focusedCell=null}e&&t&&(f.addClass(t.elem,"focused"),this.focusedCell=e)}return this.notifyFocus(),this}},{key:"divGroupsAndNodes",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=[],i=[],r={};return f.forEach(t,function(t){if(e.isGroup(t)){i.push(t);var a=e.divGroupsAndNodes(t.getChildren());f.forEach(a.nodes,function(e){r[e.id]||(n.push(e),r[e.id]=!0)}),i.push.apply(i,o(a.groups))}else r[t.id]||(n.push(t),r[t.id]=!0)}),{nodes:n,groups:i}}},{key:"updateNodesPosition",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=this,n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=this.divGroupsAndNodes(e),o=r.nodes,a=r.groups,s=this.getPaper(),l=this.getModel();l.beginUpdate(),f.forEach(o,function(e){var t=e.getPosition();e.setPosition({x:t.x+n,y:t.y+i,relative:t.relative===!0})}),f.forEach(a,function(e){var t=e.getPosition();e.setPosition({x:t.x+n,y:t.y+i,relative:t.relative===!0})}),l.endUpdate();var u=function(e){return t.isGroup(e)&&!f.some(a,function(t){return e===t})};f.forEach(o,function(e){for(var t=e.getParent();t;)u(t)&&t.updateGeometry(),t=t.getParent()}),f.forEach(o,function(e){e.isVisible()||s.updateNodeGeometry(e)}),this.notifyPositionChange(o)}},{key:"isParentScrollable",value:function(){var e=this.scrollParent;return e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight}},{key:"isOnScrollBar",value:function(e){var t=this.getPaper(),n=f.getBounds(t.getWrap()),i=n.left+n.width,r=i-b,o=n.top+n.height,a=o-b;return f.isWithin(e.pageX,r,i)||f.isWithin(e.pageY,a,o)}},{key:"notifyMoving",value:function(){this.getPaper().trigger("cells:moving",this.bounds,this.movingCells)}},{key:"notifyFocus",value:function(){this.focusedCell?this.getPaper().trigger("cell:focus",this.focusedCell):this.getPaper().trigger("paper:focus")}},{key:"notifySelectionChange",value:function(){this.getPaper().trigger("cells:selectionChanged",this.selectedCells)}},{key:"notifyPositionChange",value:function(e){this.getPaper().trigger("cells:updatePosition",e)}}]),t}(y["default"]);t["default"]=k},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(39),u=i(l),c=n(44),h=i(c),f=n(31),d=i(f),p=n(45),v=i(p),y=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),s(t,[{key:"init",value:function(){return this.clean(),this.getPaper().on("cell:pointerDown",this.onCellMouseDown.bind(this)),this.mouseUpHandler=this.onCellMouseUp.bind(this),this.mouseMoveHandler=this.onCellMouseMove.bind(this),this.mouseEnterHandler=this.onCellMouseEnter.bind(this),this.mouseLeaveHandler=this.onCellMouseLeave.bind(this),this}},{key:"clean",value:function(){return this.sourceNode=null,this.sourcePort=null,this.sourceView=null,this.connecting=!1,this.targetNode=null,this.targetView=null,this.targetPort=null,this.hasTarget=!1,this.localX=null,this.localY=null,this}},{key:"getEventData",value:function(){return{sourceNode:this.sourceNode,sourceView:this.sourceView,sourcePort:this.sourcePort,targetNode:this.targetNode,targetView:this.targetView,targetPort:this.targetPort,localX:this.localX,localY:this.localY}}},{key:"onCellMouseDown",value:function(e,t,n){this.isDisabled()||this.isGroup(e)||this.isRemark(e)||!this.isNode(e)||t.isOutPortElem(n.target)&&(this.sourceNode=e,this.sourceView=t,this.sourcePort=t.findPortByElem(n.target),this.sourcePort&&this.getPaper().on("cell:pointerMove",this.mouseMoveHandler).on("cell:pointerUp",this.mouseUpHandler))}},{key:"onCellMouseMove",value:function(e,t,n,i,r){var o=this.getPaper(),a=this.getModel();a.beginUpdate(),this.connecting||(this.getPaper().on("cell:mouseenter",this.mouseEnterHandler).on("cell:mouseleave",this.mouseLeaveHandler),this.link=new h["default"]({view:d["default"],pane:"linkPane",classNames:"pane-link pane-link-connecting",connector:v["default"],sourceMarker:null,targetMarker:"block",attrs:null}),a.addLink(this.link,{node:e,port:this.sourcePort.id}),this.connecting=!0),this.link&&this.link.setTerminal(o.toLocalPoint({x:n.pageX,y:n.pageY}),!1),a.endUpdate(),this.targetView?(this.localX=i,this.localY=r,this.targetPort=this.targetView.findPortByElem(n.target)):(this.localX=null,this.localY=null,this.targetPort=null),o.trigger("cell:connecting",this.getEventData())}},{key:"onCellMouseUp",value:function(){if(this.connecting){var e=this.getPaper(),t=this.getModel();e.off("cell:pointerMove",this.mouseMoveHandler).off("cell:pointerUp",this.mouseUpHandler).off("cell:mouseenter",this.mouseEnterHandler).off("cell:mouseleave",this.mouseLeaveHandler),t.beginUpdate(),this.link.removeFromParent(),e.trigger("cell:connected",this.getEventData()),t.endUpdate(),this.clean()}}},{key:"onCellMouseEnter",value:function(e,t,n){!this.isGroup(e)&&this.isNode(e)&&e!==this.sourceCell&&this.connecting&&(this.hasTarget=!0,this.targetNode=e,this.targetView=t,this.targetPort=t.findPortByElem(n.target))}},{key:"onCellMouseLeave",value:function(e){!this.isGroup(e)&&this.isNode(e)&&this.hasTarget&&this.connecting&&(this.hasTarget=!1,this.targetNode=null,this.targetView=null,this.targetPort=null)}}]),t}(u["default"]);t["default"]=y},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function m(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:m(r,t,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},h=n(3),f=r(h),d=n(19),p=i(d),v=n(21),y=i(v),g=function(e){function t(e){a(this,t);var n=s(this,Object.getPrototypeOf(t).call(this,e));return n.vertices=n.metadata.vertices||[],n}return l(t,e),u(t,[{key:"isLink",value:function(){return!0}},{key:"getRouter",value:function(){var e=this.metadata.router||{};return f.isFunction(e)?e={
parse:e}:f.isObject(e)||(e={name:e}),e}},{key:"getMarker",value:function(e){var t=e?this.metadata.sourceMarker:this.metadata.targetMarker;return f.isFunction(t)?t={parse:t}:f.isObject(t)||(t={name:t}),t.selector=e?".source-marker":".target-marker",t}},{key:"getConnector",value:function(){var e=this.metadata.connector||{};return f.isFunction(e)?e={parse:e}:f.isObject(e)||(e={name:e}),e.selector=".connector",e}},{key:"getVertices",value:function(){return this.vertices}},{key:"getVerticesCount",value:function(){return this.vertices?this.vertices.length:0}},{key:"getVerticeAt",value:function(e){return this.vertices?this.vertices[e]:null}},{key:"indexOfVertice",value:function(e){if(e&&p["default"].isPointLike(e))for(var t=0,n=this.getVerticesCount();n>t;t+=1){var i=this.getVerticeAt(t);if(e.x===i.x&&e.y===i.y)return t}return-1}},{key:"eachVertice",value:function(e,t){return f.forEach(this.vertices,e,t)}},{key:"filterVertice",value:function(e,t){return f.filter(this.vertices,e,t)}},{key:"insertVertice",value:function(e,t){var n=this.getVerticesCount();if(t=f.fixIndex(t,n),f.isArray(e)||(e=[e]),t===n){var i;(i=this.vertices).push.apply(i,o(e))}else this.vertices.splice(t,0,e);return this}},{key:"removeVertice",value:function(e){var t=this.indexOfVertice(e);return t>=0&&this.removeVerticeAt(t),this}},{key:"removeVerticeAt",value:function(e){var t=this.getVerticeAt(e);return t&&this.vertices.splice(e,1),t}},{key:"clearVertices",value:function(){return this.vertices=[],this}},{key:"clone",value:function(e,n){var i=c(Object.getPrototypeOf(t.prototype),"clone",this).call(this,e,n);return i.vertices=[],f.forEach(this.vertices,function(e){p["default"].isPointLike(e)&&i.vertices.push({x:e.x,y:e.y})}),i}}],[{key:"isLink",value:function(e){return e&&e instanceof t}}]),t}(y["default"]);g.setDefaults({tagName:"g",markup:'<path class="connector"/><path class="source-marker"/><path class="target-marker"/>',classNames:"pane-cell pane-link",pane:"linkPane",data:null,view:null,router:null,connector:"sharp",sourceMarker:null,targetMarker:null,attrs:{".connector":{fill:"none",stroke:"#000","stroke-width":1},".source-marker":{fill:"#000",stroke:"#000","stroke-width":1},".target-marker":{fill:"#000",stroke:"#000","stroke-width":1}}}),t["default"]=g},function(e,t){"use strict";function n(e,t){var n=(e.x+t.x)/2,i=(e.y+t.y)/2,r=50,o=t.y-e.y;return o>-100&&100>o&&(r=Math.max(Math.abs(t.y-e.y)/2,30)),["M",e.x,e.y,"Q",e.x,e.y+r,n,i,"T",t.x,t.y].join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.shapes=void 0;var r=n(47),o=i(r),a=n(48),s=i(a),l=n(49),u=i(l),c=n(50),h=i(c),f=n(51),d=i(f),p=n(52),v=i(p),y=n(53),g=i(y),m=n(54),b=i(m),k=n(55),w=i(k),P=n(56),x=i(P),O=n(57),C=i(O),M=n(58),_=i(M),S={basic:{Text:u["default"],Rect:o["default"],Path:s["default"],Image:d["default"],Ports:h["default"],Circle:v["default"],Rhombus:g["default"],Ellipse:b["default"],Polygon:w["default"],Polyline:x["default"],LabelLink:C["default"],ElementLink:_["default"]}};t.shapes=S},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><rect/></g><text/></g>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(17),f=i(h),d=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.parsePathData(),n}return s(t,e),l(t,[{key:"parsePathData",value:function(){var e=this.getPathData()||"",t=e.match(/([A-Za-z])/g);e=e.replace(/^[A-Za-z]/,"").replace(/[A-Za-z]$/,"");var n=c.split(e,/[A-Za-z]/);n=c.map(n,function(e){e=c.trim(e);for(var t=c.split(e,/[\s,]+/),n=[],i=0,r=t.length;r>i;i+=2)n.push({x:c.toFloat(t[i]),y:c.toFloat(t[i+1])});return n});var i=c.reduce(n,function(e,t){return e.concat(t)},[]),r=i[0].x,o=i[0].y;c.forEach(i,function(e){r=Math.min(e.x,r),o=Math.min(e.y,o)});var a=[];c.forEach(n,function(e,n){t[n]&&a.push(t[n]),c.forEach(e,function(e){var t=c.toFixed(e.x-r,2),n=c.toFixed(e.y-o,2);a.push(t,n)})}),t[n.length]&&a.push(t[n.length]);var s=a.join(" "),l=this.metadata.attrs;l.path?l.path.d=s:l.path={d:s}}},{key:"getPathData",value:function(){var e=this.metadata,t=e.attrs,n=t&&t.path,i=n&&n.d;if(!i){var r=/<path(?:.+)d=(["|'])(.*?)\1/,o=e.markup||"",a=o.match(r);a&&(i=a[2])}return i}}]),t}(f["default"]);d.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><path/></g><text/></g>',size:{width:60,height:60},attrs:{".":{fill:"#ffffff",stroke:"none"},path:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle",ref:"path","ref-x":.5,"ref-dy":10,fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><text/></g></g>',attrs:{".":{fill:"#fff",stroke:"none"},text:{"font-size":18,fill:"#000"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(16),f=i(h),d=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this,e));return n.updatePortsAttrs(),n}return s(t,e),l(t,[{key:"updatePortsAttrs",value:function(){var e={};return c.forEach(this.inPorts,function(t,n){c.merge(e,this.getPortAttrs(t,n,!0))},this),c.forEach(this.outPorts,function(t,n){c.merge(e,this.getPortAttrs(t,n,!1))},this),c.merge(this.attrs,e),this}},{key:"getPortAttrs",value:function(e,t,n){var i={},r=n?this.inPorts:this.outPorts,o=this.getPortSelector(e,n),a=o+">.port-label";return i[a]={text:e.id},i[o]={ref:".node-body","ref-y":(t+.5)*(1/r.length)},n||(i[o]["ref-dx"]=0),i}},{key:"getPortSelector",value:function(e,t){return this.getPortsWrapSelector(t)+'>.pane-port[data-id="'+e.id+'"]'}},{key:"getPortsWrapSelector",value:function(e){return".pane-ports."+(e?"in":"out")}}]),t}(f["default"]);d.setDefaults({size:{width:80,height:100},markup:'<g class="pane-rotatable">  <g class="pane-scalable">    <rect class="node-body"/>  </g>  <text class="node-label"/>  <g class="pane-ports in" />  <g class="pane-ports out" /></g>',portMarkup:'<g class="pane-port" data-id="${id}">  <circle class="port-body"/>  <text class="port-label"/></g>',attrs:{".node-label":{text:"port","ref-x":.5,"ref-y":.5,"y-alignment":"middle","text-anchor":"middle"},".in .port-label":{x:-15,dy:4},".out .port-label":{x:15,dy:4}}}),t["default"]=d},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><image/></g><text/></g>',attrs:{".":{fill:"#ffffff",stroke:"none"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><circle/></g><text/></g>',size:{width:60,height:60},attrs:{".":{fill:"#ffffff",stroke:"none"},circle:{fill:"#ffffff",stroke:"#000000",r:30,cx:30,cy:30},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(48),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({attrs:{path:{d:"M 30 0 L 60 30 30 60 0 30 z"},text:{"ref-y":.5,"y-alignment":"middle"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><ellipse/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},ellipse:{fill:"#ffffff",stroke:"#000000",rx:30,ry:20,cx:30,cy:20},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-y":.5,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><polygon/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><polyline/></g><text/></g>',size:{width:60,height:40},attrs:{".":{fill:"#ffffff",stroke:"none"},polyline:{fill:"#ffffff",stroke:"#000000"},text:{"font-size":14,text:"","text-anchor":"middle","ref-x":.5,"ref-dy":20,"y-alignment":"middle",fill:"#000000","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<g class="pane-rotatable"><g class="pane-scalable"><rect/></g><a><text/></a></g>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(17),l=i(s),u=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),t}(l["default"]);u.setDefaults({markup:'<a><g class="pane-rotatable"><g class="pane-scalable"><rect/></g><text/></g></a>',attrs:{".":{fill:"#fff",stroke:"none"},rect:{fill:"#fff",stroke:"#000","stroke-width":"1",width:80,height:30},text:{fill:"#000","font-size":12,"ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle","font-family":"Arial, helvetica, sans-serif"}}}),t["default"]=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.changes=void 0;var r=n(60),o=i(r),a=n(61),s=i(a),l=n(62),u=i(l),c=n(63),h=i(c),f=n(64),d=i(f),p=n(65),v=i(p),y=n(66),g=i(y),m=n(67),b=i(m),k={Change:o["default"],RootChange:s["default"],ChildChange:u["default"],VisibleChange:h["default"],TerminalChange:d["default"],GeometryChange:v["default"],CollapseChange:g["default"],ChangeCollection:b["default"]};t.changes=k},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){n(this,e)}return i(e,[{key:"digest",value:function(){return this}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n){r(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.model=e,i.root=n,i.previous=n,i}return a(t,e),s(t,[{key:"digest",value:function(){return this.root=this.previous,this.previous=this.model.rootChanged(this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i,a){r(this,t);var s=o(this,Object.getPrototypeOf(t).call(this));return s.model=e,s.child=n,s.parent=i,s.index=a,s.previous=i,s.previousIndex=a,s}return a(t,e),s(t,[{key:"digest",value:function(){var e=this.model,t=this.child,n=this.previous,i=this.previousIndex,r=t.parent,o=r?r.indexOfChild(t):0;return n||this.disConnect(t,!1),r=e.childChanged(t,n,i),this.parent=n,this.index=i,this.previous=r,this.previousIndex=o,this}},{key:"disConnect",value:function(e){if(e.isLink()){var t=e.getTerminal(!0),n=e.getTerminal(!1);t&&this.model.terminalChanged(e,null,!0),n&&this.model.terminalChanged(e,null,!1)}return e.eachChild(function(e){this.disConnect(e)},this),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.visible=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.visible=this.previous,this.previous=this.model.visibleChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i,a){r(this,t);var s=o(this,Object.getPrototypeOf(t).call(this));return s.model=e,s.link=n,s.terminal=i,s.previous=i,s.isSource=a,s}return a(t,e),s(t,[{key:"digest",value:function(){return this.terminal=this.previous,this.previous=this.model.terminalChanged(this.link,this.terminal,this.isSource),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.geometry=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.geometry=this.previous,this.previous=this.model.geometryChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.collapsed=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.collapsed=this.previous,this.previous=this.model.collapseChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){n(this,e),this.model=t,this.changes=[]}return i(e,[{key:"hasChange",value:function(){return!!this.changes.length}},{key:"getChanges",value:function(){return this.changes}},{key:"add",value:function(e){return e&&this.changes.push(e),this}},{key:"clear",value:function(){return this.changes=[],this}},{key:"notify",value:function(){return this.model.trigger("change",this.changes),this}}]),e}();t["default"]=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.geometry=void 0;var r=n(19),o=i(r),a=n(20),s=i(a),l=n(18),u=i(l),c=n(25),h=i(c),f=n(69),d=i(f),p={Point:o["default"],Line:s["default"],Rect:u["default"],Ellipse:h["default"],bezier:d["default"]};t.geometry=p},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){for(var t=o(e),n=["M",e[0].x,e[0].y],i=0;i<t[0].length;i+=1)n.push("C",t[0][i].x,t[0][i].y,t[1][i].x,t[1][i].y,e[i+1].x,e[i+1].y);return n}function o(e){var t=[],n=[],i=e.length-1;if(1===i)return t[0]=new l["default"]((2*e[0].x+e[1].x)/3,(2*e[0].y+e[1].y)/3),n[0]=new l["default"](2*t[0].x-e[0].x,2*t[0].y-e[0].y),[t,n];for(var r=[],o=1;i-1>o;o+=1)r[o]=4*e[o].x+2*e[o+1].x;r[0]=e[0].x+2*e[1].x,r[i-1]=(8*e[i-1].x+e[i].x)/2;for(var s=a(r),u=1;i-1>u;u+=1)r[u]=4*e[u].y+2*e[u+1].y;r[0]=e[0].y+2*e[1].y,r[i-1]=(8*e[i-1].y+e[i].y)/2;for(var c=a(r),h=0;i>h;h+=1)t.push(new l["default"](s[h],c[h])),i-1>h?n.push(new l["default"](2*e[h+1].x-s[h+1],2*e[h+1].y-c[h+1])):n.push(new l["default"]((e[i].x+s[i-1])/2,(e[i].y+c[i-1])/2));return[t,n]}function a(e){var t=e.length,n=[],i=[],r=2;n[0]=e[0]/r;for(var o=1;t>o;o+=1)i[o]=1/r,r=(t-1>o?4:3.5)-i[o],n[o]=(e[o]-n[o-1])/r;for(var a=1;t>a;a+=1)n[t-a-1]-=i[t-a]*n[t-a];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.curveThroughPoints=r,t.getCurveControlPoints=o;var s=n(19),l=i(s)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(41),f=i(h),d=n(21),p=i(d),v=n(22),y=i(v),g=n(61),m=i(g),b=n(71),k=i(b),w=n(62),P=i(w),x=n(63),O=i(x),C=n(72),M=i(C),_=n(73),S=i(_),E=n(64),j=i(E),T=n(65),B=i(T),N=n(66),L=i(N),V=n(74),R=i(V),A=n(67),z=i(A),F=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return n.nextId=0,n.updateLevel=0,n.endingUpdate=!1,n.changes=new z["default"](n),e?n.setRoot(e):n.clear(),n}return s(t,e),l(t,[{key:"clear",value:function(){return this.setRoot(this.createRoot())}},{key:"getDefaultParent",value:function(){return this.getRoot().getChildAt(0)}},{key:"isOrphan",value:function(e){return e&&e.isOrphan()}},{key:"isAncestor",value:function(e,t){return e&&e.isAncestor(t)}},{key:"contains",value:function(e,t){return t||(t=e,e=this.root),this.isAncestor(e,t)}},{key:"getAncestors",value:function(e){return e?e.getAncestors():[]}},{key:"getDescendants",value:function(e){return e?e.getDescendants():[]}},{key:"getParents",value:function(){}},{key:"getCellById",value:function(e){return this.cells?this.cells[e]:null}},{key:"findCellAtPoint",value:function(e){var t=this,n=[];return e&&this.eachCell(function(i){if(t.isNode(i)){var r=i.getBBox();r&&r.containsPoint(e)&&n.push(i)}}),n}},{key:"findCellInArea",value:function(e){var t=this,n=[];return e&&this.eachCell(function(i){if(t.isNode(i)){var r=i.getBBox();r&&e.containsRect(r)&&n.push(i)}}),n}},{key:"createCellId",value:function(){var e=this.nextId;return this.nextId+=1,"cell-"+e}},{key:"isRoot",value:function(e){return e&&this.root===e}},{key:"createRoot",value:function(){var e=new p["default"];return e.insertChild(this.createLayer(),{silent:!0}),e}},{key:"getRoot",value:function(e){for(var t=this.root;e;)t=e,e=e.parent;return t}},{key:"setRoot",value:function(e){return this.digest(new m["default"](this,e))}},{key:"rootChanged",value:function(e){var t=this.root;return this.root=e,this.cells=null,this.nextId=0,this.cellAdded(e),t}},{key:"isLayer",value:function(e){return e&&this.isRoot(e.parent)}},{key:"getLayers",value:function(){return this.getRoot().children||[]}},{key:"createLayer",value:function(){return new p["default"]}},{key:"eachLayer",value:function(e,t){return c.forEach(this.getLayers(),e,t)}},{key:"addNode",value:function(e,t,n){return this.addCells([e],t,n)}},{key:"addLink",value:function(e,t,n,i,r){return this.addCells([e],i,r,t,n)}},{key:"addCell",value:function(e,t,n,i,r){return this.addCells([e],t,n,i,r)}},{key:"addCells",value:function(e,t,n,i,r){var o=this;t=t||this.getDefaultParent(),n=c.fixIndex(n,t.getChildCount()),this.beginUpdate();try{c.forEach(e,function(e){e&&(e!==t&&(o.setParent(e,t,n),n+=1),i&&o.setTerminal(e,i,!0),r&&o.setTerminal(e,r,!1))})}finally{this.endUpdate()}return this}},{key:"removeCell",value:function(e){return e&&(this.isRoot(e)?this.setRoot(null):this.getParent(e)&&this.digest(new P["default"](this,e,null))),e}},{key:"getParent",value:function(e){return e?e.parent:null}},{key:"setParent",value:function(e,t,n){if(e)if(t)try{this.beginUpdate(),this.digest(new P["default"](this,e,t,n))}finally{this.endUpdate()}else this.removeCell(e);return this}},{key:"childChanged",value:function(e,t,n){var i=this.getParent(e);return t?t===i&&i.indexOfChild(e)===n||t.insertChild(e,n,{silent:!0}):i&&i.removeChild(e,{silent:!0}),t?this.contains(i)||this.cellAdded(e):this.cellRemoved(e),i}},{key:"cellAdded",value:function(e){if(e){var t=e.getId()||this.createCellId(e);if(t){var n=this.getCellById(t);if(n!==e){for(;n;)t=this.createCellId(e),n=this.getCellById(t);this.cells||(this.cells={}),e.setId(t),this.cells[t]=e}}c.isNumeric(t)&&(this.nextId=Math.max(this.nextId,t)),e.setModel(this),e.eachChild(this.cellAdded,this)}}},{key:"cellRemoved",value:function(e){var t=this;if(e){e.eachChild(function(e){t.cellRemoved(e)});var n=e.getId();this.cells&&n&&delete this.cells[n],e.setModel(null)}}},{key:"updateLinkParents",value:function(e,t){var n=this;t=t||this.getRoot(e),e.eachChild(function(e){n.updateLinkParents(e,t)}),e.eachLink(function(e){n.isAncestor(t,e)&&n.updateLinkParent(e,t)})}},{key:"updateLinkParent",value:function(e,t){for(var n=this,i=null,r=e.getTerminal(!0),o=e.getTerminal(!1);r&&!r.isLink()&&r.geometry&&r.geometry.relative;)r=r.parent;for(;o&&!o.isLink()&&o.geometry&&o.geometry.relative;)o=o.parent;if(n.isAncestor(t,r)&&n.isAncestor(t,o)&&(i=r===o?r.parent:n.getNearestCommonAncestor(r,o),i&&(i.parent!==n.viewport||n.isAncestor(i,e))&&e.parent!==i)){var a=e.geometry;if(a){var s=n.getOrigin(e.parent),l=n.getOrigin(i),u=l.x-s.x,c=l.y-s.y;a=a.clone(),a.translate(-u,-c),n.setGeometry(e,a)}n.add(i,e)}}},{key:"getNearestCommonAncestor",value:function(){return null}},{key:"eachCell",value:function(e,t){this.cells&&e&&c.isFunction(e)&&c.forIn(this.cells,function(n,i){e.call(t,n,i)})}},{key:"filterCell",value:function(e,t){var n=[];return this.cells&&e&&c.isFunction(e)&&c.forIn(this.cells,function(i,r){e.call(t,i,r)&&n.push(i)}),n}},{key:"eachNode",value:function(e,t){var n=this,i=this.filterCell(function(e){return n.isNode(e)},this);return c.forEach(i,e,t)}},{key:"eachLink",value:function(e,t){var n=this,i=this.filterCell(function(e){return n.isLink(e)},this);return c.forEach(i,e,t)}},{key:"getChildNodes",value:function(e){return this.getChildCells(e,!0,!1)}},{key:"getChildLinks",value:function(e){return this.getChildCells(e,!1,!0)}},{key:"eachChildNode",value:function(e,t,n){c.forEach(this.getChildNodes(e),t,n)}},{key:"eachChildLink",value:function(e,t,n){c.forEach(this.getChildLinks(e),t,n)}},{key:"getChildCells",value:function(e,t,n){return e?e.filterChild(function(e){return t&&e.isNode()||n&&e.isLink()}):[]}},{key:"indexOfChild",value:function(e,t){return e?e.indexOfChild(t):-1}},{key:"getChildAt",value:function(e,t){return e?e.getChildAt(t):null}},{key:"getChildren",value:function(e){return e?e.children:null}},{key:"getChildCount",value:function(e){return e?e.getChildCount():0}},{key:"isNode",value:function(e){return e?e.isNode():!1}},{key:"getLinkCount",value:function(e){return e?e.getLinkCount():0}},{key:"indexOfLink",value:function(e,t){return e?e.indexOfLink(t):-1}},{key:"getLinkAt",value:function(e,t){return e?e.getLinkAt(t):null}},{key:"isLink",value:function(e){return e?e.isLink():!1}},{key:"getTerminal",value:function(e,t){return e?e.getTerminal(t):null}},{key:"getTerminalNode",value:function(e,t){return e?e.getTerminalNode(t):null}},{key:"getTerminalPort",value:function(e,t){return e?e.getTerminalPort(t):null}},{key:"getTerminalPoint",value:function(e,t){return e?e.getTerminalPoint(t):null}},{key:"setTerminal",value:function(e,t,n){if(e)try{this.beginUpdate(),this.digest(new j["default"](this,e,new y["default"](t),n))}finally{this.endUpdate()}return this}},{key:"setTerminalNode",value:function(e,t,n){return e&&this.setTerminal(e,t,n),this}},{key:"setTerminalPort",value:function(e,t,n){if(e){var i=this.getTerminal(e,n);i=i?i.duplicate({port:t}):new y["default"]({port:t}),this.setTerminal(e,i,n)}return this}},{key:"setTerminalPoint",value:function(e,t,n){return e&&this.setTerminal(e,t,n),this}},{key:"setTerminals",value:function(e,t,n){this.beginUpdate();try{this.setTerminal(e,t,!0),this.setTerminal(e,n,!1)}finally{this.endUpdate()}return this}},{key:"removeFromTerminal",value:function(e,t){return e&&this.setTerminal(e,null,t),this}},{key:"terminalChanged",value:function(e,t,n){var i=this.getTerminal(e,n);return t?t.addLink(e,n,{silent:!0}):i&&i.removeLink(e,n,{silent:!0}),i}},{key:"isCollapsed",value:function(e){return e?e.isCollapsed():!1}},{key:"setCollapsed",value:function(e,t){if(e&&t!==this.isCollapsed(e))try{this.beginUpdate(),this.digest(new L["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"collapseChanged",value:function(e,t){var n=this.isCollapsed(e);return e.setCollapsed(t,{silent:!0}),n}},{key:"isVisible",value:function(e){return e?e.isVisible():!1}},{key:"setVisible",value:function(e,t){if(e&&t!==this.isVisible(e))try{this.beginUpdate(),this.digest(new O["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"visibleChanged",value:function(e,t){var n=this.isVisible(e);return e.setVisible(t,{silent:!0}),n}},{key:"getAttribute",value:function(e){return e?e.getAttribute():null}},{key:"setAttribute",value:function(e,t){if(e)try{this.beginUpdate(),this.digest(new R["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"attributeChanged",value:function(e,t){var n=this.getAttribute(e);return e.setAttribute(t,{silent:!0}),n}},{key:"getPosition",value:function(e,t){return e?e.getPosition(t):null}},{key:"setPosition",value:function(e,t){if(e&&t){var n=e.getPosition(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.x!==t.x||n.y!==t.y||n.relative!==t.relative)try{this.beginUpdate(),this.digest(new M["default"](this,e,{x:t.x,y:t.y,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"positionChanged",value:function(e,t){var n=e.getPosition(!0);return e.setPosition(t,{silent:!0}),n}},{key:"getSize",value:function(e,t){return e?e.getSize(t):null}},{key:"setSize",value:function(e,t){if(e&&t){var n=e.getSize(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.width!==t.width||n.height!==t.height||n.relative!==t.relative)try{this.beginUpdate(),this.digest(new k["default"](this,e,{width:t.width,height:t.height,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"sizeChanged",value:function(e,t){var n=e.getSize(!0);return e.setSize(t,{silent:!0}),n}},{key:"getRotation",value:function(e,t){return e?e.getRotation(t):null}},{key:"setRotation",value:function(e,t){if(e&&t){var n=e.getRotation(!0)||{};if(t.relative=t.relative===!0,n.relative=n.relative===!0,n.angle!==t.angle||n.relative!==t.relative)try{this.beginUpdate(),this.digest(new S["default"](this,e,{angle:t.angle,relative:t.relative}))}finally{this.endUpdate()}}return this}},{key:"rotationChanged",value:function(e,t){var n=e.getRotation(!0);return e.setRotation(t,{silent:!0}),n}},{key:"getGeometry",value:function(e,t){return e?e.getGeometry(t):null}},{key:"setGeometry",value:function(e,t){if(e&&t)try{this.beginUpdate(),this.digest(new B["default"](this,e,t))}finally{this.endUpdate()}return this}},{key:"geometryChanged",value:function(e,t){var n=this,i=e.getGeometry(!0)||{};return c.forEach(["size","position","rotation"],function(i){t[i]&&n[i+"Changed"](e,t[i])}),i}},{key:"digest",value:function(e){return e.digest(),this.beginUpdate(),this.changes.add(e),this.endUpdate(),this}},{key:"beginUpdate",value:function(){this.updateLevel+=1,this.trigger("beginUpdate"),1===this.updateLevel&&this.trigger("startEdit")}},{key:"endUpdate",value:function(){if(this.updateLevel-=1,0===this.updateLevel&&this.trigger("endEdit"),!this.endingUpdate){this.endingUpdate=0===this.updateLevel;var e=this.changes;this.trigger("endUpdate",e.getChanges()),this.endingUpdate&&e.hasChange()&&e.notify().clear(),this.endingUpdate=!1}}},{key:"isUpdated",value:function(){return 0===this.updateLevel}},{key:"destroy",value:function(){c.destroy(this)}}]),t}(f["default"]);t["default"]=F},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.size=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.size=this.previous,this.previous=this.model.sizeChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.position=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.position=this.previous,this.previous=this.model.positionChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.rotation=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.position=this.previous,this.previous=this.model.rotationChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(60),u=i(l),c=function(e){function t(e,n,i){r(this,t);var a=o(this,Object.getPrototypeOf(t).call(this));return a.model=e,a.cell=n,a.attrs=i,a.previous=i,a}return a(t,e),s(t,[{key:"digest",value:function(){return this.attrs=this.previous,this.previous=this.model.attributeChanged(this.cell,this.previous),this}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(13),p=i(d),v=n(41),y=i(v),g=n(18),m=i(g),b=n(19),k=i(b),w=n(70),P=i(w),x=n(21),O=i(x),C=n(76),M=i(C),_=n(26),S=i(_),E=n(61),j=i(E),T=n(62),B=i(T),N=n(71),L=i(N),V=n(63),R=i(V),A=n(72),z=i(A),F=n(73),I=i(F),D=n(64),G=i(D),U=n(65),W=i(U),H=n(66),X=i(H),q=n(74),Y=i(q),K=window,$=K.document,Z={wrap:"pane-wrap",stage:"pane-stage",svg:"pane-svg",viewport:"pane-viewport",htmlPane:"pane-html",rawPane:"pane-raw"},J={width:"100%",height:"100%",tx:0,ty:0,sx:1,sy:1,gridSize:1,clickThreshold:0,isValidEvent:null,eventDelegate:null},Q=0,ee=function(e){function t(e){o(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return Q+=1,n.id="paper-"+Q,e&&n.init(e),n}return s(t,e),l(t,[{key:"configure",value:function(e){return this.options=c.merge({},J,e),this.trigger("paper:configure",this.options),this}},{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.configure(e),this.container=e.container,!this.container)throw new Error("Initialize error: invalid container");return e=this.options,this.ensureElement().createPanes().setup().resize(e.width,e.height).translate(e.tx,e.ty).scale(e.sx,e.sy).setModel(e.model),this.trigger("paper:init",this.options),this}},{key:"ensureElement",value:function(){return this.wrap=c.createElement("div"),this.stage=c.createElement("div"),this.svg=c.createSvgDocument(),this.viewport=c.createSvgElement("g"),c.addClass(this.wrap,Z.wrap),c.addClass(this.stage,Z.stage),c.addClass(this.svg,Z.svg),c.addClass(this.viewport,Z.viewport),this.svg.appendChild(this.viewport),this.stage.appendChild(this.svg),this.wrap.appendChild(this.stage),this.container.appendChild(this.wrap),this.trigger("paper:ensureElements"),this}},{key:"getContainer",value:function(){return this.container}},{key:"getWrap",value:function(){return this.wrap}},{key:"getStage",value:function(){return this.stage}},{key:"getSvg",value:function(){return this.svg}},{key:"getViewport",value:function(){return this.viewport}},{key:"getEventDelegate",value:function(){var e=this.eventDelegate;return e||(e=this.options.eventDelegate,c.isFunction(e)&&(e=e.call(this)),this.eventDelegate=e||this.getWrap()),this.eventDelegate}},{key:"createPanes",value:function(){var e=this.viewport,t=this.stage;return this.backgroundPane=e.appendChild(c.createSvgElement("g")),this.linkPane=e.appendChild(c.createSvgElement("g")),this.drawPane=e.appendChild(c.createSvgElement("g")),this.controlPane=e.appendChild(c.createSvgElement("g")),this.decoratePane=e.appendChild(c.createSvgElement("g")),this.htmlPane=t.appendChild(c.createElement("div")),c.addClass(this.htmlPane,Z.htmlPane),this.rawPane=t.appendChild(c.createElement("div")),c.addClass(this.rawPane,Z.rawPane),this.trigger("paper:createPanes"),this}},{key:"setup",value:function(){var e=this.getEventDelegate();return c.addEventListener(e,"contextmenu",this.onContextMenu.bind(this)),c.addEventListener(e,"dblclick",this.onDblClick.bind(this)),c.addEventListener(e,"click",this.onClick.bind(this)),c.addEventListener(e,"mouseenter",".pane-cell",this.onCellMouseEnter.bind(this)),c.addEventListener(e,"mouseleave",".pane-cell",this.onCellMouseLeave.bind(this)),c.addEventListener(e,"mouseover",".pane-cell",this.onCellMouseOver.bind(this)),c.addEventListener(e,"mouseout",".pane-cell",this.onCellMouseOut.bind(this)),c.addEventListener(e,"mousedown",this.onPointerDown.bind(this)),this.mouseMoved=0,p["default"].IS_POINTER&&(this.container.style.msTouchAction="none"),this.trigger("paper:setup"),this}},{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(){var e=arguments.length<=0||void 0===arguments[0]?new P["default"]:arguments[0];return this.model=e,this.model.on("change",this.handleChanges,this),this.reValidate(),this}},{key:"destroy",value:function(){this.trigger("paper:destroy"),c.removeElement(this.wrap),p["default"].IS_POINTER&&(this.container.style.msTouchAction="");var e=this.getModel();e&&!e.destroyed&&e.destroy(),c.destroy(this)}},{key:"registerHandlers",value:function(e){return e=c.isArray(e)?e:[e],this.handlers=this.handlers||[],this.handlerByName=this.handlerByName||{},c.forEach(e,function(e){if(this.handlerByName[e.name])throw new Error('handler with name "'+e.name+'" is already registered');this.handlers.push(e),this.handlerByName[e.name]=e},this),this}},{key:"resize",value:function(e,t,n){if(!c.isNil(e)&&!c.isNil(t)){var i=c.isPercentage(e);i&&(e=c.toFloat(e,!0)*this.container.clientWidth),i=c.isPercentage(t),i&&(t=c.toFloat(t,!0)*this.container.clientHeight),n&&(e+=c.isNil(this.width)?0:this.width,t+=c.isNil(this.height)?0:this.height),e=Math.round(e),t=Math.round(t),(0,f["default"])(this.svg).attr({width:e,height:t}),c.setStyle(this.stage,{width:e+"px",height:t+"px"}),this.width=e,this.height=t,this.trigger("paper:resize",e,t)}return this}},{key:"resizeTo",value:function(e,t){return this.resize(e,t,!1)}},{key:"resizeBy",value:function(e,t){return this.resize(e,t,!0)}},{key:"translate",value:function(e,t,n){return c.isNil(e)||c.isNil(t)||(n&&(e+=c.isNil(this.tx)||0,t+=c.isNil(this.ty)||0),(0,f["default"])(this.viewport).translate(e,t),c.setStyle(this.htmlPane,{top:t+"px",left:e+"px"}),this.tx=e,this.ty=t,this.trigger("paper:translate",e,t)),this}},{key:"translateTo",value:function(e,t){return this.translate(e,t,!1)}},{key:"translateBy",value:function(e,t){return this.translate(e,t,!0)}},{key:"scale",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];if(t=t||e,e&&t){var r=(0,f["default"])(this.viewport);r.attr("transform","");var o=this.tx,a=this.ty;if(n||i||o||a){var s=o-n*(e-1),l=a-i*(t-1);this.translateTo(s,l)}r.scale(e,t),c.setStyle(this.htmlPane,{transform:"translate3d(0, 0, 0) scale3d("+e+","+t+", 1)"}),this.sx=e,this.sy=t,this.trigger("paper:scale",e,t,n,i)}return this}},{key:"getContentBBox",value:function(e){if(e)return(0,f["default"])(this.viewport).getBBox(!0,this.svg);var t=this.viewport.getBoundingClientRect(),n=this.viewport.getScreenCTM(),i=this.viewport.getCTM();return m["default"].fromRect({x:t.left-n.e+i.e,y:t.top-n.f+i.f,width:t.width,height:t.height})}},{key:"fitToContent",value:function(e,t,n,i){function r(e){return!i.allowNewOrigin||"any"===i.allowNewOrigin||"negative"===i.allowNewOrigin&&0>e||"positive"===i.allowNewOrigin&&e>=0}c.isObject(e)?(i=e,n=i.padding||0,e=i.frameWidth||1,t=i.frameHeight||1):(i=i||{},n=n||0,e=e||1,t=t||1),n=c.normalizeSides(n);var o=this.getContentBBox(!0);o.x*=this.sx,o.y*=this.sy,o.width*=this.sx,o.height*=this.sy;var a=c.snapToGrid(o.width+o.x||1,e,"ceil"),s=c.snapToGrid(o.height+o.y||1,t,"ceil"),l=this.tx,u=this.ty;r(o.x)&&(l=Math.ceil(-o.x/e)*e,l+=n.left,a+=l),r(o.y)&&(u=Math.ceil(-o.y/t)*t,u+=n.top,s+=u),a+=n.right,s+=n.bottom,a=c.clamp(a,i.minWidth||0,i.maxWidth||Number.MAX_VALUE),s=c.clamp(s,i.minHeight||0,i.maxHeight||Number.MAX_VALUE);var h=a!==this.width||s!==this.height,f=l!==this.tx||u!==this.ty;return f&&this.translate(l,u),h&&this.resize(a,s),h||f}},{key:"scaleContentToFit",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.getContentBBox(!0);if(!t.width||!t.height)return this;e=c.merge({padding:0,minScale:null,maxScale:null,scaleGrid:null,preserveAspectRatio:!0},e);var n=c.normalizeSides(e.padding),i=e.fittingBBox;i||(i={x:this.tx,y:this.ty,width:this.width,height:this.height}),i=m["default"].fromRect(i).moveAndExpand({x:n.left,y:n.top,width:-(n.left+n.right),height:-(n.top+n.bottom)});var r=i.width/t.width,o=i.height/t.height,a=e.scaleGrid;a&&(r=c.snapToGrid(r,a,"floor"),o=c.snapToGrid(o,a,"floor"));var s=e.minScaleX||e.minScale,l=e.maxScaleX||e.maxScale,u=e.minScaleY||e.minScale,h=e.maxScaleY||e.maxScale;r=c.clamp(r,s,l),o=c.clamp(o,u,h),e.preserveAspectRatio&&(r=o=Math.min(r,o)),this.scale(r,o),t=this.getContentBBox(!0);var f=i.x-t.x,d=i.y-t.y;return this.translateTo(f,d),this}},{key:"reValidate",value:function(){return this.invalidate().validate()}},{key:"clear",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0],t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];return this.removeView(e),n&&(t||e!==this.currentRoot)?e.eachChild(function(e){this.clear(e,t,n)},this):this.invalidate(e,!0,!0),this}},{key:"invalidate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0],t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],i=this.getView(e);return i&&(i.invalid=!0),e.invalidating||(e.invalidating=!0,t&&e.eachChild(function(e){this.invalidate(e,t,n)},this),n&&e.eachLink(function(e){this.invalidate(e,t,n)},this),e.invalidating=!1),this}},{key:"validate",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.model.getRoot():arguments[0];return this.validateCell(e).validateView(e)}},{key:"validateCell",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(e){t=t&&e.isVisible();var n=this.getView(e,t);n&&!t&&this.removeView(e,!1,!1),e.eachChild(function(e){this.validateCell(e,t)},this)}return this}},{key:"validateView",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(e){var n=this.getView(e);n&&n.invalid&&(this.validateView(e.getParent(),!1).updateNodeGeometry(e).renderView(e),n.invalid=!1),t&&e.eachChild(function(e){this.validateView(e,t)},this)}return this}},{key:"updateNodeGeometry",value:function(e){return e&&e.isNode()&&this.updateNodeSize(e).updateNodePosition(e).updateNodeRotation(e),this}},{key:"updateNodeSize",value:function(e){if(e&&e.isNode()){var t=e.metadata.size||{},n=c.isUndefined(t.width)?1:t.width,i=c.isUndefined(t.height)?1:t.height,r=e.parent;if(t.relative&&r&&r.isNode()){var o=r.size,a=c.isPercentage(n);n=c.fixNumber(n,a,0),a||n>0&&1>n?n*=o.width:n+=o.width,a=c.isPercentage(i),i=c.fixNumber(i,a,0),a||i>0&&1>i?i*=o.height:i+=o.height}else n=c.fixNumber(n,!1,1),i=c.fixNumber(i,!1,1);e.size={width:Math.max(n,1),height:Math.max(i,1)}}return this}},{key:"updateNodePosition",value:function(e){if(e&&e.isNode()){var t=e.metadata.position||{},n=c.isUndefined(t.x)?0:t.x,i=c.isUndefined(t.y)?0:t.y,r=e.parent;if(t.relative&&r&&r.isNode()){var o=r.position,a=r.size,s=c.isPercentage(n);n=c.fixNumber(n,s,0),s||n>-1&&1>n?n=o.x+a.width*n:n+=o.x,s=c.isPercentage(i),i=c.fixNumber(i,s,0),s||i>-1&&1>i?i=o.y+a.height*i:i+=o.y}else n=c.fixNumber(n,!1,0),i=c.fixNumber(i,!1,0);e.position=this.snapToGrid({x:n,y:i},!0)}return this}},{key:"updateNodeRotation",value:function(e){if(e&&e.isNode()){var t=e.metadata.rotation||{},n=c.fixNumber(t.angle,!1,0),i=e.parent;if(t.inherited&&i&&i.isNode()&&0!==i.rotation){var r=e.position,o=e.size,a=new k["default"](r.x+o.width/2,r.y+o.height/2),s=i.position,l=i.size,u=s.x+l.width/2,h=s.y+l.height/2,f=new k["default"](u,h);a.rotate(f,-i.rotation),r.x=a.x-o.width/2,r.y=a.y-o.height/2,n+=i.rotation}e.rotation=n}return this}},{key:"getView",value:function(e,t){if(e){var n=this.getViewById(e.id);return!n&&t&&e.isVisible()&&(n=this.createView(e)),n}return null}},{key:"getViewById",value:function(e){return this.views?this.views[e]:null}},{key:"eachView",value:function(e,t){return c.forIn(this.views,e,t)}},{key:"getTerminalView",value:function(e,t){var n=this.model.getTerminal(e,t);return n&&n.node?this.getView(n.node):null}},{key:"createView",value:function(e){if(e){var t=e.metadata.view;if(t||(t=e.isLink()?M["default"]:e.isNode()?S["default"]:null),t){var n=new t(this,e);return this.views||(this.views={}),this.views[e.id]=n,n}}return null}},{key:"removeView",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];if(e){t&&e.eachChild(function(e){this.removeView(e,t,n)},this),n&&e.eachLink(function(e){this.removeView(e,t,n)},this);var i=this.getView(e);i&&(delete this.views[e.id],i.destroy())}return this}},{key:"renderView",value:function(e){var t=this.getView(e);return t&&(e.isLink()&&!this.canRenderLink(e)?this.removeView(e):t.render()),this}},{key:"canRenderLink",value:function(e){var t=e.getTerminalNode(!0),n=e.getTerminalNode(!1);return(!t||t.isVisible()&&this.getView(t))&&(!n||n.isVisible()&&this.getView(n))?(t||e.getTerminalPoint(!0))&&(n||e.getTerminalPoint(!1)):!1}},{key:"findViewByElem",value:function(e){if(this.views)for(e=c.isString(e)?this.svg.querySelector(e):e;e&&e!==this.svg&&e!==document;){var t=e.cellId;if(t)return this.views[t];e=e.parentNode}return null}},{key:"findViewByCell",value:function(e){return c.isString(e)?this.getViewById(e):this.getView(e)}},{key:"findViewByPoint",value:function(){}},{key:"findViewsInArea",value:function(){}},{key:"handleChanges",value:function(e){return c.forEach(e,function(e){this.distributeChange(e)},this),this.validate(),this}},{key:"distributeChange",value:function(e){return e instanceof j["default"]?this.onRootChanged(e):e instanceof B["default"]?this.onChildChanged(e):e instanceof R["default"]?this.onVisibleChange(e):e instanceof G["default"]?this.onTerminalChange(e):e instanceof L["default"]?this.onSizeChange(e):e instanceof z["default"]?this.onPositionChange(e):e instanceof I["default"]?this.onRotationChange(e):e instanceof Y["default"]?this.onAttributeChange(e):e instanceof W["default"]?this.onGeometryChange(e):e instanceof X["default"]&&this.onCollapseChange(e),this}},{key:"onRootChanged",value:function(e){e.viewport&&this.invalidate(e.viewport,!0,!0),e.previous&&this.removeView(e.previous,!0,!0)}},{key:"onChildChanged",value:function(e){var t=e.parent,n=e.previous;this.invalidate(e.child,!0,!0),t||this.removeView(e.child,!0,!0),t!==n&&(t&&this.invalidate(t,!1,!1),n&&this.invalidate(n,!1,!1))}},{key:"onVisibleChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onTerminalChange",value:function(e){this.invalidate(e.link,!0,!0)}},{key:"onSizeChange",value:function(e){
this.invalidate(e.cell,!0,!0)}},{key:"onPositionChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onRotationChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onAttributeChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onGeometryChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"onCollapseChange",value:function(e){this.invalidate(e.cell,!0,!0)}},{key:"getRouter",value:function(e){return this.constructor.getRouter(e)}},{key:"getConnector",value:function(e){return this.constructor.getConnector(e)}},{key:"getMarker",value:function(e){return this.constructor.getMarker(e)}},{key:"isValidEvent",value:function(e,t){var n=t&&t.cell;if(this.options.isValidEvent&&!this.options.isValidEvent(e,n,t))return!1;if(n&&n instanceof O["default"])return!0;var i=e.target,r=this.eventDelegate;return!(r!==i&&!c.containsElement(r,i))}},{key:"onContextMenu",value:function(e){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(this.isValidEvent(e,t)){var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:contextmenu",t.cell,t,e,n.x,n.y):this.trigger("blank:contextmenu",e,n.x,n.y)}}},{key:"onDblClick",value:function(e){e.preventDefault(),e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(this.isValidEvent(e,t)){var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:dblclick",t.cell,t,e,n.x,n.y):this.trigger("blank:dblclick",e,n.x,n.y)}}},{key:"onClick",value:function(e){if(this.mouseMoved<=this.options.clickThreshold){e=c.normalizeEvent(e);var t=this.findViewByElem(e.target);if(!this.isValidEvent(e,t))return;var n=this.snapToGrid({x:e.clientX,y:e.clientY});t?this.trigger("cell:click",t.cell,t,e,n.x,n.y):this.trigger("blank:click",e,n.x,n.y)}}},{key:"onCellMouseOver",value:function(e){this.onCellHover(e,"mouseover")}},{key:"onCellMouseOut",value:function(e){this.onCellHover(e,"mouseout")}},{key:"onCellMouseEnter",value:function(e){this.onCellHover(e,"mouseenter")}},{key:"onCellMouseLeave",value:function(e){this.onCellHover(e,"mouseleave")}},{key:"onCellHover",value:function(e,t){e=c.normalizeEvent(e);var n=this.findViewByElem(e.target);if(this.isValidEvent(e,n)){var i=this.snapToGrid({x:e.clientX,y:e.clientY});this.trigger("cell:"+t,n.cell,n,e,i.x,i.y)}}},{key:"onPointerDown",value:function(e){if(e=c.normalizeEvent(e),c.isLeftMouseButton(e)){var t=this.findViewByElem(e.target),n=t&&t.cell;this.isValidEvent(e,t)&&this.triggerPointDown(e,n,t)}}},{key:"triggerPointDown",value:function(e,t,n){e.preventDefault(),this.mouseMoved=0;var i=this.snapToGrid({x:e.clientX,y:e.clientY});n?(this.sourceView=n,this.trigger("cell:pointerDown",t,n,e,i.x,i.y)):this.trigger("blank:pointerDown",e,i.x,i.y),this.onMouseMoveHandler=this.onMouseMoveHandler||this.onPointerMove.bind(this),this.onMouseUpHandler=this.onMouseUpHandler||this.onPointerUp.bind(this),c.addEventListener($,"mousemove",this.onMouseMoveHandler),c.addEventListener($,"mouseup",this.onMouseUpHandler)}},{key:"onPointerMove",value:function(e){e.preventDefault(),e=c.normalizeEvent(e);var t=this.snapToGrid({x:e.clientX,y:e.clientY}),n=this.sourceView;n?(this.mouseMoved+=1,this.trigger("cell:pointerMove",n.cell,n,e,t.x,t.y)):this.trigger("blank:pointerMove",e,t.x,t.y)}},{key:"onPointerUp",value:function(e){e=c.normalizeEvent(e);var t=this.snapToGrid({x:e.clientX,y:e.clientY}),n=this.sourceView;n?(this.trigger("cell:pointerUp",n.cell,n,e,t.x,t.y),this.sourceView=null):this.trigger("blank:pointerUp",e,t.x,t.y),c.removeEventListener($,"mousemove",this.onMouseMoveHandler),c.removeEventListener($,"mouseup",this.onMouseUpHandler)}},{key:"snapToGrid",value:function(e,t){var n=this.options.gridSize||1;return t||(e=(0,f["default"])(this.drawPane).toLocalPoint(e.x,e.y)),{x:c.snapToGrid(e.x,n),y:c.snapToGrid(e.y,n)}}},{key:"toLocalPoint",value:function(e){var t=this.getRootOffset(),n=this.svg.createSVGPoint();n.x=e.x+t.left,n.y=e.y+t.top;var i=n.matrixTransform(this.drawPane.getCTM().inverse());return k["default"].fromPoint(i)}},{key:"toClientPoint",value:function(e){var t=this.getRootOffset(),n=this.svg.createSVGPoint();n.x=e.x,n.y=e.y;var i=n.matrixTransform(this.drawPane.getCTM());return i.x-=t.left,i.y-=t.top,k["default"].fromPoint(i)}},{key:"getRootOffset",value:function(){var e=void 0;p["default"].IS_FF&&(e=(0,f["default"])("rect",{width:this.options.width,height:this.options.height,x:0,y:0,opacity:0}),this.svg.appendChild(e.node));var t=c.getOffset(this.svg);p["default"].IS_FF&&e.remove();var n=$.body,i=$.documentElement,r=n.scrollTop||i.scrollTop,o=n.scrollLeft||i.scrollLeft;return{left:o-t.left,top:r-t.top}}},{key:"toLocalRect",value:function(e){var t=this.toLocalPoint({x:e.x,y:e.y}),n=this.toLocalPoint({x:e.x+e.width,y:e.y+e.height});return new m["default"](t.x,t.y,n.x-t.x,n.y-t.y)}}],[{key:"registRouter",value:function(e,t){return this.router||(this.router={}),this.router[e]=t,this}},{key:"getRouter",value:function(e){return this.router?this.router[e]:null}},{key:"registConnector",value:function(e,t){return this.connectors||(this.connectors={}),this.connectors[e]=t,this}},{key:"getConnector",value:function(e){return this.connectors?this.connectors[e]:null}},{key:"registMarker",value:function(e,t){return this.markers||(this.markers={}),this.markers[e]=t,this}},{key:"getMarker",value:function(e){return this.markers?this.markers[e]:null}}]),t}(y["default"]);t["default"]=ee},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(19),p=i(d),v=n(27),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"render",value:function(){return this.vel.empty(),this.renderMarkup().update(),this}},{key:"update",value:function(){return this.cache={},this.parseRouter().parseConnector().parseTerminal(!0).parseTerminal(!1).updateMarker().updateConnector().updateAttributes()}},{key:"updateAttributes",value:function(e){var t=this;return c.forIn(e||this.cell.attrs,function(e,n){var i=[];c.isObject(e.fill)&&(t.applyGradient(n,"fill",e.fill),i.push("fill")),c.isObject(e.stroke)&&(t.applyGradient(n,"stroke",e.stroke),i.push("stroke")),c.isObject(e.filter)&&(t.applyFilter(n,e.filter),i.push("filter"));var r={};c.forIn(e,function(e,t){c.contains(i,t)||(r[t]=e)}),t.applyAttr(n,r)}),this}},{key:"parseRouter",value:function(){var e=this.cell,t=e.getRouter(),n=c.filter(e.vertices||[],function(e){return p["default"].isPointLike(e)});n=c.map(n,function(e){return p["default"].fromPoint(e)});var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getRouter(t.name),r=i&&c.isFunction(i)?i.call(this,n,t.options||{}):n;return this.cacheRouterPoints(r),this}},{key:"parseConnector",value:function(){var e=this.cell,t=e.getConnector(),n=e.getMarker(!0),i=e.getMarker(!1),r=this.getStrokeWidth(t.selector),o=this.getStrokeWidth(n.selector),a=this.getStrokeWidth(i.selector),s=n.options;s||(s=n.options={}),s.connectorStrokeWidth=r,s.markerStrokeWidth=o;var l=i.options;return l||(l=i.options={}),l.connectorStrokeWidth=r,l.markerStrokeWidth=a,this.cacheConnector(t),this.cacheMarker(n,!0),this.cacheMarker(i,!1),this}},{key:"parseTerminal",value:function(e){var t=this.cell,n=t.getTerminalPoint(e),i=t.getTerminalNode(e),r=i&&this.paper.getView(i),o=t.getTerminalPort(e);return this.cacheStaticConnPoint(n,e),this.cacheTerminalView(r,e),this.cacheTerminalPort(o,e),this}},{key:"updateMarker",value:function(){return this.renderMarker(!0).renderMarker(!1).updateConnectionPoint(!0).updateConnectionPoint(!1).transformMarker(!0).transformMarker(!1).updateConnectionPointOnMarker(!0).updateConnectionPointOnMarker(!1)}},{key:"updateConnector",value:function(){var e=this.fetchConnector(),t=e.parse&&c.isFunction(e.parse)?e.parse:e.name&&this.paper.getConnector(e.name);if(!t||!c.isFunction(t))throw new Error('Unknown connector: "'+e.name+'"');var n=this.getConnectionPoint(!0),i=this.getConnectionPoint(!1);if(n&&i){var r=t.call(this,n,i,this.fetchRouterPoints(),e.options||{});this.applyAttr(e.selector,{d:r})}else this.vel.empty();return this}},{key:"renderMarker",value:function(e){var t=this.fetchMarker(e),n=this.findOne(t.selector);if(t&&n){var i=t.parse&&c.isFunction(t.parse)?t.parse:t.name&&this.paper.getMarker(t.name);if(i&&c.isFunction(i)){var r=i(n,t.options),o=r.vel;if(o){var a=n.node,s=a.parentNode,l=n.getClassName();s.insertBefore(o.node,a),s.removeChild(a),o.addClass(l),n=o}this.cacheMarkerVel(n,e),this.cacheRenderedMarker(r,e)}}return this}},{key:"updateConnectionPoint",value:function(e){var t=this.fetchStaticConnPoint(e);return t||this.updateConnPointOnPort(e)||this.updateConnPointOnNode(e),this}},{key:"updateConnPointOnPort",value:function(e){var t=this.fetchConnPointOnPort(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);if(i&&n){if(n.getConnectionPointOnPort&&(t=n.getConnectionPointOnPort(i,e)),!t){var r=this.getPortBodyBBox(e);if(r){var o=this.getReferencePoint(r,e),a=this.getPortBodyGeom(e)||r;o&&(t=a.intersectionWithLineFromCenterToPoint(o)),t=t||a.getCenter()}}this.cacheConnPointOnPort(t,e)}}return t}},{key:"updateConnPointOnNode",value:function(e){var t=this.fetchConnPointOnNode(e);if(!t){var n=this.fetchTerminalView(e);if(n){if(n.getConnectionPointOnBorder&&(t=n.getConnectionPointOnBorder()),!t){var i=this.getTerminalBBox(e);if(i){var r=this.getReferencePoint(i,e);r&&(t=i.intersectionWithLineFromCenterToPoint(r)),t=t||i.getCenter()}}this.cacheConnPointOnNode(t,e)}}return t}},{key:"getStrokeWidth",value:function(e){var t=this.findOne(e);if(t&&t.node){var n=c.getComputedStyle(t.node,"stroke-width");return n&&c.toFloat(n)||0}return 0}},{key:"getTerminalBBox",value:function(e){var t=this.fetchTerminalBBox(e);if(!t){var n=this.fetchTerminalView(e);n&&(t=n.getStrokedBBox(),t=this.fixStrokedBBox(t,e)),this.cacheTerminalBBox(t,e)}return t}},{key:"fixStrokedBBox",value:function(e,t){if(e){var n=this.fetchMarker(t),i=this.fetchRenderedMarker(t);if(n&&i){var r=n.options.markerStrokeWidth;if(r){var o=i.rad||0;o>=Math.PI/4||0===o?e.grow(r/2):e.grow(r/Math.sin(o)/2)}}}return e}},{key:"getReferencePoint",value:function(e,t){var n=this.fetchStaticConnPoint(t);if(!n){var i=this.fetchRouterPoints();n=t?i[0]:i[i.length-1]}if(!n){var r=this.getPortBodyBBox(!t);r&&(n=r.intersectionWithLineFromCenterToPoint(e.getCenter()),n=n||r.getCenter())}if(!n){var o=this.getTerminalBBox(!t);o&&(n=o.intersectionWithLineFromCenterToPoint(e.getCenter()),n=n||o.getCenter())}return n}},{key:"getPortBodyBBox",value:function(e){var t=this.fetchPortBodyBBox(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyBBox&&(t=n.getPortBodyBBox(i,e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyBBox(t,e)))}return t}},{key:"getPortBodyGeom",value:function(e){var t=this.fetchPortBodyGeom(e);if(!t){var n=this.fetchTerminalView(e),i=this.fetchTerminalPort(e);n&&i&&(n.getPortBodyGeom&&(t=n.getPortBodyGeom(i,e)),t&&(t=this.fixStrokedBBox(t,e),this.cachePortBodyGeom(t,e)))}return t}},{key:"getConnectionPoint",value:function(e){return this.fetchStaticConnPoint(e)||this.fetchConnPointOnMarker(e)||this.fetchConnPointOnPort(e)||this.fetchConnPointOnNode(e)}},{key:"transformMarker",value:function(e,t){var n=this.fetchRenderedMarker(e);if(n){var i=this.getPane(),r=this.fetchRouterPoints(),o=this.getConnectionPoint(!0),a=this.getConnectionPoint(!1),s=e?o:a,l=t||e?r[0]||a:r[r.length-1]||o,u=this.fetchMarkerVel(e);s&&l&&u&&u.translateAndAutoOrient(s,l,i)}return this}},{key:"updateConnectionPointOnMarker",value:function(e){var t=this.fetchMarkerVel(e),n=this.fetchRenderedMarker(e);if(t&&n){var i=this.getPane(),r=n.point,o=f["default"].createSVGPoint(r.x,r.y);o=o.matrixTransform(t.getTransformToElement(i));var a=p["default"].fromPoint(o);this.cacheConnPointOnMarker(a,e)}return this}},{key:"cacheRouterPoints",value:function(e){this.cache.routerPoints=e}},{key:"fetchRouterPoints",value:function(){return this.cache.routerPoints}},{key:"cacheConnector",value:function(e){this.cache.connector=e}},{key:"fetchConnector",value:function(){return this.cache.connector}},{key:"cacheMarker",value:function(e,t){t?this.cache.sourceMarker=e:this.cache.targetMarker=e}},{key:"fetchMarker",value:function(e){return e?this.cache.sourceMarker:this.cache.targetMarker}},{key:"cacheRenderedMarker",value:function(e,t){e&&(t?this.cache.renderedSourceMarker=e:this.cache.renderedTargetMarker=e)}},{key:"fetchRenderedMarker",value:function(e){return e?this.cache.renderedSourceMarker:this.cache.renderedTargetMarker}},{key:"cacheMarkerVel",value:function(e,t){e&&(t?this.cache.sourceMarkerVel=e:this.cache.targetMarkerVel=e)}},{key:"fetchMarkerVel",value:function(e){return e?this.cache.sourceMarkerVel:this.cache.targetMarkerVel}},{key:"cacheTerminalView",value:function(e,t){e&&(t?this.cache.sourceView=e:this.cache.targetView=e)}},{key:"fetchTerminalView",value:function(e){return e?this.cache.sourceView:this.cache.targetView}},{key:"cacheTerminalPort",value:function(e,t){c.isNil(e)||(t?this.cache.sourcePort=e:this.cache.targetPort=e)}},{key:"fetchTerminalPort",value:function(e){return e?this.cache.sourcePort:this.cache.targetPort}},{key:"cacheStaticConnPoint",value:function(e,t){e&&(t?this.cache.staticSourcePoint=e:this.cache.staticTargetPoint=e)}},{key:"fetchStaticConnPoint",value:function(e){return e?this.cache.staticSourcePoint:this.cache.staticTargetPoint}},{key:"cacheConnPointOnMarker",value:function(e,t){e&&(t?this.cache.sourcePointOnMarker=e:this.cache.targetPointOnMarker=e)}},{key:"fetchConnPointOnMarker",value:function(e){return e?this.cache.sourcePointOnMarker:this.cache.targetPointOnMarker}},{key:"cacheConnPointOnPort",value:function(e,t){e&&(t?this.cache.sourcePointOnPort=e:this.cache.targetPointOnPort=e)}},{key:"fetchConnPointOnPort",value:function(e){return e?this.cache.sourcePointOnPort:this.cache.targetPointOnPort}},{key:"cacheConnPointOnNode",value:function(e,t){e&&(t?this.cache.sourcePointOnTerminal=e:this.cache.targetPointOnTerminal=e)}},{key:"fetchConnPointOnNode",value:function(e){return e?this.cache.sourcePointOnTerminal:this.cache.targetPointOnTerminal}},{key:"cacheTerminalBBox",value:function(e,t){e&&(t?this.cache.sourceTerminalBBox=e:this.cache.targetTerminalBBox=e)}},{key:"fetchTerminalBBox",value:function(e){return e?this.cache.sourceTerminalBBox:this.cache.targetTerminalBBox}},{key:"cachePortBodyBBox",value:function(e,t){e&&(t?this.cache.sourcePortBBox=e:this.cache.targetPortBBox=e)}},{key:"fetchPortBodyBBox",value:function(e){return e?this.cache.sourcePortBBox:this.cache.targetPortBBox}},{key:"cachePortBodyGeom",value:function(e,t){e&&(t?this.cache.sourcePortGeom=e:this.cache.targetPortGeom=e)}},{key:"fetchPortBodyGeom",value:function(e){return e?this.cache.sourcePortGeom:this.cache.targetPortGeom}}]),t}(y["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(40),p=i(d),v=n(78),y=i(v),g=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this;this.name=e.name||"select";var n=this.getPaper(),i=this.getModel();return this.previewVel=(0,f["default"])("rect",{fill:"none","stroke-dasharray":"3px, 3px",stroke:"black"}),this.previewRect=this.previewVel.node,n.controlPane.appendChild(this.previewRect),this.hidePreview(),n.selection=[],this.origin={x:0,y:0},n.on("cell:pointerDown",function(e,n,i){t.invoke(function(){t.origin={x:i.x,y:i.y},t.selectCell(e,c.hasModifierKey(i))})}),n.on("cell:pointerMove",function(e,n,i){t.invoke(function(){t.showPreview().redrawPreview(i)})}),n.on("cell:pointerUp",function(e,r,o){t.invoke(function(){var e=t.origin;o.x===e.x&&o.y===e.y||(i.beginUpdate(),c.forEach(n.selection,function(t){var n=t.metadata.position;i.setGeometry(t,{position:{x:n.x+(o.x-e.x),y:n.y+(o.y-e.y),relative:n.relative}})}),i.endUpdate(),c.forEach(n.selection,function(e){e.vertexController.redraw()})),t.hidePreview()})}),n.on("blank:pointerDown",function(e){t.invoke(function(){c.hasModifierKey(e)||t.clearSelection()})}),this}},{key:"hidePreview",value:function(){return this.previewVel.hide(),this}},{key:"showPreview",value:function(){return this.previewVel.show(),this}},{key:"redrawPreview",value:function(e){var t=this,n=this.getPaper(),i=this.previewVel,r=n.selection;return r.length&&!function(){var o={x:Number.MAX_VALUE,y:Number.MAX_VALUE},a={x:0,y:0};c.forEach(r,function(e){var t=n.getView(e),i=t.vel.getBBox();i.x<o.x&&(o.x=i.x),i.y<o.y&&(o.y=i.y),i.x+i.width>a.x&&(a.x=i.x+i.width),i.y+i.height>a.y&&(a.y=i.y+i.height)});var s=t.origin;i.attr({x:o.x+(e.x-s.x),y:o.y+(e.y-s.y),width:a.x-o.x,height:a.y-o.y})}(),this}},{key:"_selectCell",value:function(e){var t=this.getPaper();return e.vertexController=new y["default"](t,{cell:e}),e.selected=!0,t.selection.push(e),this}},{key:"_unselectCell",value:function(e){var t=this.getPaper(),n=t.selection;return c.contains(n,e)&&t.selection.splice(c.indexOf(n,e),1),e.vertexController.destroy(),e.selected=!1,this}},{key:"selectCell",value:function(e,t){return t?e.selected?this._unselectCell(e):this._selectCell(e):(this.clearSelection(),e.selected?this:(this.clearSelection(),this._selectCell(e),this))}},{key:"clearSelection",value:function(){return c.forEach(this.paper.selection,function(e){e.vertexController.destroy(),e.selected=!1}),this.paper.selection=[],this}}]),t}(p["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(13),f=i(h),d=n(24),p=i(d),v=n(18),y=i(v),g=n(79),m=i(g),b=window,k=b.document,w={boundsAttr:{fill:"none",stroke:"#0f0","stroke-dasharray":"3px, 3px"},rotaterOffset:-12,rotaterAttr:{rx:5,ry:5,fill:"#0f0",stroke:"black",style:"cursor:crosshair;"},resizerAttr:{height:6,width:6,fill:"#0f0",stroke:"black"}},P=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],x=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"init",value:function(e){this.options=c.merge({},w,e);var t=(0,p["default"])("g",{"class":"vertex-bounds"});return this.cell=e.cell,this.vel=t,this.elem=t.node,this.paper.controlPane.appendChild(this.elem),this.redraw(),this}},{key:"redraw",value:function(){var e=this,t=e.cell;return e.moveTo(t.position).rotate().setSize(t.size).drawBounds().drawRotater().drawResizers(),this.bindEvents(),this}},{key:"moveTo",value:function(e){return this.vel.translate(e.x,e.y),this.position=e,this}},{key:"setSize",value:function(e){return this.size=e,this}},{key:"rotate",value:function(e,t,n){var i=this.cell;return t=c.isNumeric(t)?t:i.size.width/2,n=c.isNumeric(n)?n:i.size.height/2,e=c.isNumeric(e)?e:i.rotation,this.vel.rotate(e,t,n),this.rotation=e,this}},{key:"drawBounds",value:function(){var e=c.extend({},this.options.boundsAttr,this.size);return this.boundsVel?this.boundsVel.attr(e):(this.boundsVel=(0,p["default"])("rect",e),this.vel.append(this.boundsVel)),this}},{key:"drawRotater",value:function(){return this.rotaterVel||(this.rotaterVel=(0,p["default"])("ellipse",this.options.rotaterAttr),this.vel.append(this.rotaterVel)),this.rotaterVel.translate(this.size.width/2,this.options.rotaterOffset),this}},{key:"drawResizers",value:function(){var e=this.options;this.resizers||(this.resizers=[],c.forEach(P,function(){this.createResizer()},this));var t=this.resizers,n=e.resizerAttr.width/2,i=e.resizerAttr.height/2,r=this.size.height,o=this.size.width;return t[0].translate(-n,-i),t[1].translate(-n+o/2,-i),t[2].translate(-n+o,-i),t[3].translate(-n+o,-i+r/2),t[4].translate(-n+o,-i+r),t[5].translate(-n+o/2,-i+r),t[6].translate(-n,-i+r),t[7].translate(-n,-i+r/2),this.cacheResizerBBox(),this.adjustResizers(),this}},{key:"cacheResizerBBox",value:function(){return c.forEach(this.resizers,function(e){e.hidden||(e.cachedBBox=e.getBBox())}),this}},{key:"adjustResizers",value:function(){var e=this.cell,t=45,n=c.normalizeAngle(e.rotation),i=Math.floor(n/t),r=P.length;return c.forEach(this.resizers,function(e,t){var n=P[(t+i)%r];e.attr({"class":"resizer "+n}),e.css({cursor:n})}),this}},{key:"createResizer",value:function(){var e=this,t=(0,p["default"])("rect",e.options.resizerAttr);return e.resizers.push(t),e.vel.append(t),e}},{key:"hideRotater",value:function(){return this.rotaterVel.hide(),this}},{key:"showRotater",value:function(){return this.rotaterVel.show(),this}},{key:"showResizers",value:function(){return c.forEach(this.resizers,function(e){e.show()}),this}},{key:"hideResizers",value:function(e){return this.cacheResizerBBox(),c.forEach(this.resizers,function(t){t.node!==e&&t.hide()}),this}},{key:"resetEvents",value:function(e){return this.isRotating=!1,this.isResizing=!1,this.eventTarget=null,e&&e.target&&(this.eventTarget=e.target,this.isRotating=e.target===this.rotaterVel.node,this.isResizing=c.hasClass(e.target,"resizer"),this.oldEventPosition={x:e.x,y:e.y}),this.isRotating?this.hideResizers():this.showResizers(),this.isResizing?(this.hideRotater(),this.hideResizers(e.target)):this.showRotater(),this}},{key:"bindEvents",value:function(){var e=this.elem;this.resetEvents();var t=this.onPointerDown.bind(this),n=this.onPointerMove.bind(this),i=this.onPointerUp.bind(this);return f["default"].IS_TOUCH?(c.addEventListener(e,"touchstart",t),c.addEventListener(k,"touchmove",n),c.addEventListener(k,"touchend",i)):(c.addEventListener(e,"mousedown",t),c.addEventListener(k,"mousemove",n),c.addEventListener(k,"mouseup",i)),this}},{key:"onPointerDown",value:function(e){return e.stopPropagation(),this.resetEvents(e),this}},{key:"onPointerMove",value:function(e){var t=this;if(t.isRotating){e.stopPropagation();var n=t.position.x+t.size.width/2-e.x,i=t.position.y+t.size.height/2-e.y,r=0!==n?180*Math.atan(i/n)/Math.PI+90:0>i?180:0;n>0&&(r-=180),t.rotate(r)}return t.isResizing&&!function(){e.stopPropagation();var n=t.oldEventPosition,i={x:e.x,y:e.y},r=t.eventTarget,o=0,a=!1,s=!1;c.some(t.resizers,function(e,t){return e.node===r?(o=t,!0):!1});var l=(o-4+8)%8;o%2!==0&&(1!==o&&5!==o||(a=!0),3!==o&&7!==o||(s=!0),o-=1,l-=1);var u=t.resizers[l].cachedBBox.getCenter(),h=t.resizers[o].getBBox().getCenter(),f=0,d=0;a?(f=0,d=0):s?(f=0,d=0):(f=i.x-n.x,d=i.y-n.y);var p=y["default"].fromVerticesAndRotation(u,{x:h.x+f,y:h.y+d},t.rotation);t.moveTo({x:p.x,y:p.y}).setSize({height:p.height,width:p.width}).drawBounds().drawResizers().rotate(t.rotation),t.oldEventPosition=i}(),t}},{key:"onPointerUp",value:function(e){var t=this;if(t.isResizing||t.isRotating){e.stopPropagation();var n=t.model;n.beginUpdate(),t.isRotating&&n.setGeometry(t.cell,{rotation:{angle:t.rotation}}),t.isResizing&&n.setGeometry(t.cell,{position:{x:t.position.x,y:t.position.y},rotation:{angle:t.rotation},size:{width:t.size.width,height:t.size.height}}),n.endUpdate(),t.redraw(),t.resetEvents()}return t}},{key:"destroy",value:function(){this.boundsVel.remove(),this.rotaterVel.remove(),c.forEach(this.resizers,function(e){e.remove()}),this.vel.remove(),c.destroy(this)}}]),t}(m["default"]);t["default"]=x},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(41),u=i(l),c=function(e){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.paper=e,i.model=e.model,i.init(n),i.on("controller:initalized"),i}return a(t,e),s(t,[{key:"init",value:function(){return this}},{key:"destroy",value:function(){}}]),t}(u["default"]);t["default"]=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=r(u),h=n(24),f=i(h),d=n(18),p=i(d),v=n(44),y=i(v),g=n(40),m=i(g),b=function(e){function t(){return o(this,t),a(this,Object.getPrototypeOf(t).apply(this,arguments))}return s(t,e),l(t,[{key:"init",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,n=this.getPaper(),i=this.getModel();return this.name=e.name||"connection",this.sourceCellView=null,this.targetCellView=null,this.sourcePort=null,this.targetPort=null,this.connecting=!1,this.previewingLink=null,n.on("cell:mouseOver",function(e,n){t.sourceCellView!==n&&(t.connecting?t.setTargetCellView(n):t.setSourceCellView(n))}),n.on("cell:mouseOut",function(e,n,i){t.connecting?t.targetCellView===n&&t._isOut(n,i.toElement)&&t.setTargetCellView(null):t.sourceCellView===n&&t._isOut(n,i.toElement)&&t.setSourceCellView(null)}),c.addEventListener(n.decoratePane,"mouseout",".port-decorator.out",function(e){t.connecting||c.hasClass(e.toElement,"port-decorator-layer")||t.setSourceCellView(null)}),c.addEventListener(n.decoratePane,"mousedown",".port-decorator.out",function(e){t.connecting=!0;var n=e.delegateTarget;t.sourcePort=n.cellView.findPortByElem(n.portBody),t._drawInPortDecorators()}),c.addEventListener(n.container,"mousemove",function(e){t.connecting&&(t.previewingLink?i.setTerminal(t.previewingLink,n.toLocalPoint({x:e.x,y:e.y}),!1):(t.previewingLink=new y["default"]({sourceMarker:"block",targetMarker:"block"}),i.addLink(t.previewingLink,{node:t.sourceCellView.cell,port:t.sourcePort},n.toLocalPoint({x:e.x,y:e.y}))))}),n.on("cell:pointerUp",function(){t.connecting=!1,t.setSourceCellView(null),t._clearInPortDecorators()}),n.on("blank:pointerUp",function(){t.connecting=!1,t.setSourceCellView(null),t._clearInPortDecorators()}),this}},{key:"_isOut",value:function(e,t){return!c.containsElement(e.elem,t)&&!c.hasClass(t,"port-decorator-layer")}},{key:"setSourceCellView",value:function(e){var t=this,n=this.getPaper();return this.sourceCellView&&c.forEach(n.decoratePane.querySelectorAll(".port-decorator.out"),function(e){(0,f["default"])(e).remove()}),t.sourceCellView=e,e&&t._drawPortDecorators(e,"out"),this}},{key:"_drawInPortDecorators",value:function(){var e=this;return e}},{key:"_clearInPortDecorators",value:function(){var e=this,t=e.paper;return c.forEach(t.decoratePane.querySelectorAll(".port-decorator.in"),function(e){(0,f["default"])(e).remove()}),e}},{key:"_drawPortDecorators",value:function(e,t){var n=['<g class="port-decorator ${className}">','<circle class="back port-decorator-layer" r="8" cx="${x}" cy="${y}"></circle>','<circle class="front port-decorator-layer" r="3" cx="${x}" cy="${y}"></circle>',"</g>"].join(""),i=e.elem.querySelectorAll(".pane-ports."+t+" .pane-port .port-body"),r=this.getPaper(),o=r.decoratePane;c.forEach(i,function(i){var r=p["default"].fromRect((0,f["default"])(i).getBBox(!1)),a=r.getCenter(),s=(0,f["default"])(c.format(n,c.extend({className:t},a)));o.appendChild(s.node),s.node.cellView=e,s.node.portBody=i})}},{key:"setTargetCellView",value:function(){var e=this;return e}}]),t}(m["default"]);t["default"]=b},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t,n){var i=["M",e.x,e.y];return a.forEach(n,function(e){i.push(e.x,e.y)}),i.push(t.x,t.y),
i.join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(3),a=i(o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n){var i=e.cache,r=t?i.renderedSourceMarker:i.renderedTargetMarker,o=t?i.sourceMarkerVel:i.targetMarkerVel;if(r&&o){var a=t?i.sourcePointOnTerminal||i.staticSourcePoint:i.targetPointOnTerminal||i.staticTargetPoint;a&&(o.translateAndAutoOrient(a,n,e.getPane()),e.updateConnectionPointOnMarker(t))}}function a(e,t){var n=e.cache;return t?n.sourcePointOnMarker||n.sourcePointOnTerminal||n.staticSourcePoint:n.targetPointOnMarker||n.targetPointOnTerminal||n.staticTargetPoint}function s(e,t,n){var i=this,r=void 0,s=void 0,l=void 0;if(n&&n.length){var c=[e].concat(n).concat([t]),f=u.getCurveControlPoints(c),d=f[0].length;s=h["default"].fromPoint(f[0][0]),l=h["default"].fromPoint(f[1][d-1]),o(i,!0,s),o(i,!1,l),c[0]=a(i,!0),c[c.length-1]=a(i,!1),r=["M",c[0].x,c[0].y];for(var p=0;d>p;p++)r.push("C",f[0][p].x,f[0][p].y,f[1][p].x,f[1][p].y,c[p+1].x,c[p+1].y)}else{var v=(e.y+t.y)/2;r=["M",e.x,e.y,"C",e.x,v,t.x,v,t.x,t.y]}return r.join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=s;var l=n(69),u=r(l),c=n(19),h=i(c)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3],r=i.radius||10,o=void 0,a=void 0,l=["M",e.x,e.y];return s.forEach(n,function(i,s){var c=n[s-1]||e,h=n[s+1]||t,f=u["default"].fromPoint(i);o=a||f.distance(c)/2,a=f.distance(h)/2;var d=u["default"].fromPoint(i).move(c,-Math.min(r,o)).smooth(),p=u["default"].fromPoint(i).move(h,-Math.min(r,a)).smooth();l.push(d.x,d.y,"S",i.x,i.y,p.x,p.y,"L")}),l.push(t.x,t.y),l.join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=n(3),s=r(a),l=n(19),u=i(l)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.size||7,i=[],r=.75*n,o=n/2;i.push("M",0,n/2),i.push("L",n,0),i.push("L",r,o),i.push("L",n,n),i.push("Z"),e.attr("d",i.join(" "));var s=t.connectorStrokeWidth;return s>1&&(r+=s/2*(n-r)/o),{rad:Math.atan2(n/2,n),point:new a["default"](r,o)}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(19),a=i(o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||5,i=t.ry||n/2,r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),r.push("L",2*n,i),r.push("Z"),e.attr("d",r.join(" ")),{rad:Math.atan2(i,n),point:new a["default"](2*n-1,i)}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(19),a=i(o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.width||5,i=t.height||n*Math.tan(.2*Math.PI),r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),r.push("Z"),e.attr({d:r.join(" ")}),{rad:Math.atan2(i,n),point:new a["default"](n,i)}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(19),a=i(o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||7,i=t.ry||n/2,r=[];return r.push("M",n,0),r.push("L",0,i),r.push("L",n,2*i),e.attr("d",r.join(" ")),{rad:Math.atan2(i,n),point:new a["default"](0,i)}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(19),a=i(o)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(e){var n=t.rx||3.5,i=t.ry||n,r=(0,a["default"])("ellipse");return r.attr({cx:n,cy:i,rx:n,ry:i}),{vel:r,rad:0,point:new l["default"](2*n,i)}}return null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var o=n(24),a=i(o),s=n(19),l=i(s)}])});